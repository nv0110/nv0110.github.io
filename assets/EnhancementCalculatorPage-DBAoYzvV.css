:root{--bg-primary: #181622;--bg-secondary: #23203a;--bg-tertiary: #2d2540;--bg-quaternary: #1e1b2e;--bg-hover: #3a335a;--text-primary: #e6e0ff;--text-secondary: #cebbe4;--text-muted: #b39ddb;--accent-primary: #a259f7;--accent-secondary: #805ad5;--accent-primary-hover: #c084fc;--accent-secondary-hover: #9f7aea;--accent-success: #50AD7E;--accent-error: #e53e3e;--border-primary: rgba(162, 89, 247, .2);--border-secondary: rgba(162, 89, 247, .1)}.enhancement-calculator-page{min-height:100vh;width:100%;background:linear-gradient(135deg,#181622,#23203a);color:var(--text-primary);padding:0;margin:0;--dropdown-bg: #1f2937;--dropdown-text: #f9fafb;--dropdown-border: #374151}body:has(.enhancement-calculator-page){overflow-y:auto!important}.enhancement-calculator-page-wrapper{position:relative;width:100%;min-height:100vh;background:linear-gradient(135deg,#181622,#23203a)}.enhancement-calculator-page-wrapper .enhancement-calculator-page{position:relative;min-height:100vh;width:100%;padding:0;background:transparent}.enhancement-calculator-page *[role=listbox],.enhancement-calculator-page *[role=option],.enhancement-calculator-page select,.enhancement-calculator-page select option{background-color:var(--dropdown-bg)!important;background:var(--dropdown-bg)!important;color:var(--dropdown-text)!important;border-color:var(--dropdown-border)!important}.enhancement-calculator-main{max-width:1200px;margin:0 auto;padding:2rem 1rem;min-height:0;height:auto}.enhancement-header{text-align:center;margin-bottom:3rem}.enhancement-title{font-size:2.5rem;font-weight:700;color:var(--accent-primary);margin-bottom:.5rem;background:linear-gradient(135deg,var(--accent-primary),var(--accent-secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.enhancement-subtitle{font-size:1.1rem;color:var(--text-secondary);opacity:.8}.enhancement-container{display:grid;grid-template-columns:1fr 1fr;gap:2rem;align-items:start;min-height:0}.enhancement-inputs{background:var(--bg-secondary);border:1px solid var(--border-primary);border-radius:1rem;padding:2rem;height:-moz-fit-content;height:fit-content}.enhancement-section{margin-bottom:2rem}.enhancement-section:last-child{margin-bottom:0}.section-title{font-size:1.3rem;font-weight:600;color:var(--text-primary);margin-bottom:1rem;display:flex;align-items:center;gap:.5rem}.section-title:before{content:"";width:4px;height:20px;background:var(--accent-primary);border-radius:2px}.quick-select-group{margin-bottom:1.5rem}.quick-select-label{display:block;font-size:.9rem;color:var(--text-secondary);margin-bottom:.75rem;font-weight:500}.quick-select-buttons{display:flex;flex-wrap:wrap;gap:.5rem}.quick-select-btn{background:var(--bg-tertiary);border:1px solid var(--border-secondary);color:var(--text-secondary);padding:.5rem 1rem;border-radius:.5rem;font-size:.9rem;font-weight:500;cursor:pointer;transition:all .2s ease;white-space:nowrap}.quick-select-btn:hover{background:var(--bg-hover);border-color:var(--accent-primary);color:var(--text-primary);transform:translateY(-1px)}.quick-select-btn.active{background:var(--accent-primary);border-color:var(--accent-primary);color:#fff;box-shadow:0 2px 8px #8b5cf64d}.input-group{margin-bottom:1rem;width:100%;box-sizing:border-box}.input-group:last-child{margin-bottom:0}.input-group label{display:block;font-size:.9rem;color:var(--text-secondary);margin-bottom:.5rem;font-weight:500}.level-input,.star-select,.mvp-select,.event-select{width:100%;background:var(--bg-primary);border:1px solid var(--border-secondary);color:var(--text-primary);padding:.75rem 1rem;border-radius:.5rem;font-size:1rem;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;font-weight:500;transition:border-color .2s ease;box-sizing:border-box}.level-input{max-width:100%;min-width:0;flex-shrink:1}.enhancement-section .input-group .level-input{width:100%!important;max-width:100%!important;box-sizing:border-box!important}.star-select,.mvp-select,.event-select{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--bg-primary)!important;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23a1a1aa' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right .75rem center;background-size:1rem;padding-right:2.5rem;color:var(--text-primary)!important}select.star-select,select.mvp-select,select.event-select{color-scheme:dark;background-color:var(--bg-primary)!important}.star-select option,.mvp-select option,.event-select option{background-color:var(--bg-primary)!important;color:var(--text-primary)!important;padding:.5rem}select.star-select::-ms-expand,select.mvp-select::-ms-expand,select.event-select::-ms-expand{display:none}@media screen and (-webkit-min-device-pixel-ratio:0){.star-select,.mvp-select,.event-select{background-color:var(--bg-primary)!important}}@-moz-document url-prefix(){.star-select,.mvp-select,.event-select,.star-select option,.mvp-select option,.event-select option{background-color:var(--bg-primary)!important;color:var(--text-primary)!important}}.enhancement-inputs select,.enhancement-inputs select option{background-color:var(--bg-primary)!important;color:var(--text-primary)!important}.level-input:focus,.star-select:focus,.mvp-select:focus,.event-select:focus{outline:none;border-color:var(--accent-primary);box-shadow:0 0 0 3px #8b5cf61a}.star-range-inputs{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.toggle-group{display:flex;align-items:center}.toggle-label{display:flex;align-items:center;gap:.75rem;cursor:pointer;font-size:.95rem;color:var(--text-primary)}.toggle-checkbox{display:none}.toggle-slider{position:relative;width:50px;height:26px;background:var(--bg-tertiary);border:1px solid var(--border-secondary);border-radius:13px;transition:all .3s ease}.toggle-slider:before{content:"";position:absolute;top:2px;left:2px;width:20px;height:20px;background:var(--text-secondary);border-radius:50%;transition:all .3s ease}.toggle-checkbox:checked+.toggle-slider{background:var(--accent-primary);border-color:var(--accent-primary)}.toggle-checkbox:checked+.toggle-slider:before{transform:translate(24px);background:#fff}.enhancement-results{background:var(--bg-secondary);border:1px solid var(--border-primary);border-radius:1rem;padding:2rem;min-height:400px;max-height:800px;overflow-y:auto;display:flex;flex-direction:column;justify-content:flex-start;align-items:center}.calculating-indicator{display:flex;flex-direction:column;align-items:center;gap:1rem;color:var(--text-secondary)}.spinner{width:40px;height:40px;border:3px solid var(--bg-tertiary);border-top:3px solid var(--accent-primary);border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes breathingGradient{0%{background-position:0% 50%;opacity:.92}50%{background-position:100% 50%;opacity:.88}to{background-position:0% 50%;opacity:.92}}@keyframes breathingOverlay{0%{opacity:.02;transform:translate(0)}50%{opacity:.04;transform:translate(2px)}to{opacity:.02;transform:translate(0)}}.enhancement-calculator-page .breakdown-header,.enhancement-calculator-page .stat-card.primary{background:linear-gradient(135deg,#1a0d2e,#2d1b4e,#3c2463,#2d1b4e);background-size:300% 300%;animation:breathingGradient 8s ease-in-out infinite;position:relative;overflow:hidden}.enhancement-calculator-page .breakdown-header:before,.enhancement-calculator-page .stat-card.primary:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(45deg,rgba(255,255,255,.02),transparent,rgba(255,255,255,.01));animation:breathingOverlay 8s ease-in-out infinite;pointer-events:none}.results-content{width:100%;text-align:center}.total-cost-section{margin-bottom:2rem;padding-bottom:2rem;border-bottom:1px solid var(--border-secondary)}.results-title{font-size:1.3rem;color:var(--text-primary);margin-bottom:1rem;font-weight:600}.total-cost{margin-bottom:1rem}.cost-amount{font-size:2.5rem;font-weight:700;color:var(--accent-primary);display:block;line-height:1}.cost-unit{font-size:1rem;color:var(--text-secondary);margin-left:.5rem}.cost-formatted{display:block;font-size:1.1rem;color:var(--text-secondary);margin-top:.5rem;opacity:.8}.cost-summary{font-size:1rem;color:var(--text-secondary);display:flex;align-items:center;justify-content:center;gap:.5rem;flex-wrap:wrap}.event-badge{background:var(--accent-success);color:#fff;padding:.25rem .5rem;border-radius:.25rem;font-size:.8rem;font-weight:600}.event-badge.guaranteed{background:#10b981}.zero-badge{background:var(--accent-secondary);color:#fff;padding:.25rem .5rem;border-radius:.25rem;font-size:.8rem;font-weight:600}.effective-level{color:var(--text-secondary);font-size:.9rem;opacity:.7}.safeguard-cost-info{margin-top:1rem;padding:.75rem;background:var(--bg-tertiary);border-radius:.5rem;border:1px solid var(--border-secondary)}.safeguard-label{color:var(--text-secondary);font-size:.9rem;margin-right:.5rem}.safeguard-amount{color:var(--accent-primary);font-weight:600}.safeguard-info{margin-top:1rem;padding:.75rem;background:#8b5cf61a;border:1px solid rgba(139,92,246,.2);border-radius:.5rem}.starcatch-info{margin-top:1rem;padding:.75rem;background:#ffc1071a;border:1px solid rgba(255,193,7,.2);border-radius:.5rem}.info-text{color:var(--text-secondary);font-size:.85rem;line-height:1.4;margin:0}.event-info{margin-top:1rem;padding:.75rem;background:#10b9811a;border:1px solid rgba(16,185,129,.2);border-radius:.5rem}.event-info .info-text{display:flex;align-items:center;gap:.5rem;margin:0}.toggle-label.disabled{opacity:.5;cursor:not-allowed}.toggle-label.disabled .toggle-checkbox:disabled+.toggle-slider{background:var(--bg-tertiary);border-color:var(--border-secondary)}.disabled-reason{color:var(--text-secondary);font-size:.8rem;opacity:.7}.breakdown-section{text-align:left}.breakdown-title{font-size:1.1rem;color:var(--text-primary);margin-bottom:1rem;font-weight:600}.breakdown-table{background:var(--bg-primary);border:1px solid var(--border-secondary);border-radius:.5rem;overflow:hidden}.breakdown-header{display:grid;grid-template-columns:1.2fr 1fr 1fr 1.5fr;background:var(--bg-tertiary);border-bottom:1px solid var(--border-secondary);padding:.75rem 1rem;font-weight:600;color:var(--text-primary);font-size:.9rem;gap:.5rem}.breakdown-row{display:grid;grid-template-columns:1.2fr 1fr 1fr 1.5fr;padding:.75rem 1rem;border-bottom:1px solid var(--border-secondary);transition:background-color .2s ease;gap:.5rem;align-items:center}.breakdown-row:last-child{border-bottom:none}.breakdown-row:hover{background:var(--bg-hover)}.upgrade-range{color:var(--text-primary);font-weight:500;display:flex;align-items:center;gap:.5rem}.safeguard-indicator{font-size:.8rem;opacity:.8}.guaranteed-indicator{font-size:.8rem;color:#10b981;font-weight:700}.base-cost{color:var(--text-secondary);text-align:right;font-family:Courier New,monospace;font-size:.9rem}.upgrade-cost{color:var(--text-primary);text-align:right;font-family:Courier New,monospace;font-weight:600}.discounts{text-align:center}.discount-list{display:flex;flex-wrap:wrap;gap:.25rem;justify-content:center}.discount-tag{background:var(--accent-primary);color:#fff;padding:.125rem .375rem;border-radius:.25rem;font-size:.7rem;font-weight:500;white-space:nowrap}.no-discount{color:var(--text-secondary);opacity:.5;font-size:.9rem}.error-message,.no-results{display:flex;align-items:center;gap:.5rem;color:var(--text-secondary);font-size:1rem}.error-message{color:var(--accent-error)}.error-icon{font-size:1.2rem}@media (max-width: 1024px){.enhancement-container{grid-template-columns:1fr;gap:1.5rem}.enhancement-calculator-page{padding:1.5rem 1rem}.enhancement-title{font-size:2rem}}@media (max-width: 768px){.enhancement-calculator-page{padding:1rem .5rem}.enhancement-inputs,.enhancement-results{padding:1.5rem}.enhancement-title{font-size:1.8rem}.cost-amount{font-size:2rem}.star-range-inputs{grid-template-columns:1fr;gap:.75rem}.quick-select-buttons{justify-content:center}.cost-summary{flex-direction:column;gap:.25rem}.breakdown-header,.breakdown-row{grid-template-columns:1fr;gap:.5rem;text-align:center}.breakdown-header{display:none}.breakdown-row{border:1px solid var(--border-secondary);border-radius:.5rem;margin-bottom:.5rem;padding:1rem;background:var(--bg-primary)}.breakdown-row:last-child{margin-bottom:0}.upgrade-range:before{content:"Upgrade: ";font-weight:400;color:var(--text-secondary)}.base-cost:before{content:"Base: ";font-weight:400;color:var(--text-secondary)}.upgrade-cost:before{content:"Final: ";font-weight:400;color:var(--text-secondary)}}@media (max-width: 480px){.enhancement-header{margin-bottom:2rem}.enhancement-title{font-size:1.6rem}.enhancement-subtitle{font-size:1rem}.quick-select-btn{font-size:.8rem;padding:.4rem .8rem}.cost-amount{font-size:1.8rem}.breakdown-header,.breakdown-row{font-size:.85rem;padding:.6rem .8rem}}.simulation-header{text-align:center;margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid var(--border-secondary)}.simulation-info{display:flex;align-items:center;justify-content:center;gap:1rem;margin-top:.5rem;font-size:.9rem;color:var(--text-secondary)}.simulation-count{font-weight:600;color:var(--accent-primary)}.statistics-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.5rem;margin-bottom:2rem}.stat-card{background:var(--bg-secondary);border:1px solid var(--border-secondary);border-radius:.75rem;padding:1.5rem;text-align:center;transition:transform .2s ease,box-shadow .2s ease}.stat-card:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.stat-card.primary{background:linear-gradient(135deg,#8b5cf61a,#8b5cf60d);border-color:var(--accent-primary)}.stat-card h4{margin:0 0 .5rem;font-size:.9rem;font-weight:600;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.5px}.stat-value-container{position:relative;display:inline-block}.stat-value{font-size:1.8rem;font-weight:700;color:var(--text-primary);margin-bottom:.25rem;cursor:help;transition:color .2s ease}.stat-value:hover{color:var(--accent-primary)}.stat-tooltip{position:absolute;bottom:calc(100% + .75rem);left:50%;transform:translate(-50%);background:var(--bg-secondary);color:var(--text-primary);padding:.75rem 1rem;border-radius:.5rem;border:1px solid var(--border-primary);font-size:.85rem;font-weight:600;white-space:nowrap;opacity:0;visibility:hidden;transition:opacity .3s ease,visibility .3s ease;z-index:1000;box-shadow:0 6px 20px #00000040}.stat-tooltip:after{content:"";position:absolute;top:100%;left:50%;transform:translate(-50%);border:6px solid transparent;border-top-color:var(--bg-secondary)}.stat-tooltip:before{content:"";position:absolute;top:100%;left:50%;transform:translate(-50%);border:7px solid transparent;border-top-color:var(--border-primary);z-index:-1}.stat-value-container:hover .stat-tooltip{opacity:1;visibility:visible}.stat-unit{font-size:.8rem;color:var(--text-secondary);font-weight:500}.stat-formatted{font-size:.85rem;color:var(--accent-primary);font-weight:600;margin-top:.25rem}.risk-analysis{background:var(--bg-secondary);border:1px solid var(--border-secondary);border-radius:.75rem;padding:1.5rem;margin-bottom:2rem}.risk-analysis h4{margin:0 0 1rem;color:var(--text-primary);font-size:1.1rem}.range-stats{display:grid;gap:.75rem}.range-item{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:var(--bg-quaternary);border:1px solid rgba(162,89,247,.12);border-radius:.5rem;box-shadow:0 1px 4px #00000040}.range-item.worst-case{background:#ef44441a;border-color:#ef44444d}.range-label{font-weight:600;color:var(--text-secondary)}.range-value{font-weight:700;color:var(--text-primary)}.outcome-analysis{background:var(--bg-secondary);border:1px solid var(--border-secondary);border-radius:.75rem;padding:1.5rem;margin-bottom:2rem}.outcome-analysis h4{margin:0 0 1rem;color:var(--text-primary);font-size:1.1rem}.outcome-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem}.outcome-item{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:var(--bg-quaternary);border:1px solid rgba(162,89,247,.12);border-radius:.5rem;box-shadow:0 1px 4px #00000040}.outcome-item.success{background:#22c55e1a;border-color:#22c55e4d}.outcome-item.decrease{background:#fbbf241a;border-color:#fbbf244d}.outcome-item.boom{background:#ef44441a;border-color:#ef44444d}.outcome-item.chance-time{background:#8b5cf61a;border-color:#8b5cf64d}.outcome-label{font-weight:600;color:var(--text-secondary)}.outcome-value{font-weight:700;color:var(--text-primary)}.simulation-summary{background:var(--bg-secondary);border:1px solid var(--border-secondary);border-radius:.75rem;padding:1.5rem}.simulation-summary h4{margin:0 0 1rem;color:var(--text-primary);font-size:1.1rem}.summary-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1rem}.summary-item{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:var(--bg-quaternary);border:1px solid rgba(162,89,247,.12);border-radius:.5rem;box-shadow:0 1px 4px #00000040}.summary-label{font-weight:600;color:var(--text-secondary)}.summary-value{font-weight:700;color:var(--text-primary)}.calculate-section{text-align:center;padding:1rem 0}.calculate-button{display:flex;align-items:center;justify-content:center;gap:.75rem;width:100%;max-width:400px;margin:0 auto 1rem;padding:1rem 2rem;background:linear-gradient(135deg,var(--accent-primary),#7c3aed);color:#fff;border:none;border-radius:.75rem;font-size:1.1rem;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 12px #8b5cf64d}.calculate-button:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px #8b5cf666;background:linear-gradient(135deg,#7c3aed,var(--accent-primary))}.calculate-button:active:not(:disabled){transform:translateY(0);box-shadow:0 2px 8px #8b5cf64d}.calculate-button:disabled{background:var(--bg-tertiary);color:var(--text-secondary);cursor:not-allowed;box-shadow:none;transform:none}.calculate-button.calculating{background:linear-gradient(135deg,#10b981,#059669);box-shadow:0 4px 12px #10b9814d}.calculate-button.rate-limited{background:linear-gradient(135deg,#f59e0b,#d97706);box-shadow:0 4px 12px #f59e0b4d;cursor:not-allowed}.button-spinner{width:20px;height:20px;border:2px solid rgba(255,255,255,.3);border-top:2px solid white;border-radius:50%;animation:spin 1s linear infinite}.rate-limit-spinner{border:2px solid rgba(255,255,255,.3);border-top:2px solid white;animation:spin 2s linear infinite}.calculate-info{max-width:500px;margin:0 auto}.calculate-info .info-text{color:var(--text-secondary);font-size:.9rem;margin-bottom:.5rem}.rate-limit-info{color:var(--text-secondary);font-size:.8rem;opacity:.7;margin:0}.rate-limit-warning{color:#f59e0b;font-size:.85rem;font-weight:500;margin:.5rem 0 0;padding:.5rem;background:#f59e0b1a;border:1px solid rgba(245,158,11,.3);border-radius:.5rem;animation:fadeInOut .3s ease-in-out}@keyframes fadeInOut{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 768px){.statistics-grid{grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem}.stat-card{padding:1rem}.stat-value{font-size:1.5rem}.outcome-stats,.summary-grid{grid-template-columns:1fr}.calculate-button{font-size:1rem;padding:.875rem 1.5rem;max-width:100%}}@media (max-width: 480px){.statistics-grid{grid-template-columns:1fr}.stat-value{font-size:1.3rem}}.mode-toggle{display:flex;justify-content:center;gap:.5rem;margin-top:1.5rem;padding:.5rem;background:var(--bg-secondary);border-radius:.75rem;border:1px solid var(--border-primary)}.mode-button{padding:.75rem 1.5rem;background:transparent;border:none;border-radius:.5rem;color:var(--text-secondary);font-weight:500;cursor:pointer;transition:all .2s ease}.mode-button:hover{background:var(--bg-hover);color:var(--text-primary)}.mode-button.active{background:var(--accent-primary);color:#fff;box-shadow:0 2px 8px #8b5cf64d}.planner-container{max-width:1400px;margin:0 auto;padding-right:.5rem;min-height:0;height:auto}.global-settings-panel{background:var(--bg-secondary);border:1px solid var(--border-primary);border-radius:1rem;padding:1.5rem;margin-bottom:2rem}.global-settings-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;align-items:end}.global-settings-panel .setting-group{display:flex;flex-direction:column;gap:.5rem}.global-settings-panel .setting-group label{font-size:.9rem;color:var(--text-secondary);font-weight:600;text-transform:uppercase;letter-spacing:.5px;margin-bottom:.25rem}.global-settings-panel .setting-select{background:linear-gradient(135deg,var(--bg-primary),var(--bg-tertiary));border:2px solid var(--border-secondary);color:var(--text-primary);padding:.875rem 3rem .875rem 1rem;border-radius:.75rem;font-size:1rem;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 2px 8px #0000001a;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%238b5cf6' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right 1rem center;background-size:1.2rem;color-scheme:dark}.global-settings-panel .setting-select:hover{border-color:var(--accent-primary);box-shadow:0 4px 12px #8b5cf633;transform:translateY(-1px);background:linear-gradient(135deg,var(--bg-hover),var(--bg-primary))}.global-settings-panel .setting-select:focus{outline:none;border-color:var(--accent-primary);box-shadow:0 0 0 3px #8b5cf61a,0 4px 12px #8b5cf633;transform:translateY(-1px)}.global-settings-panel .setting-select:active{transform:translateY(0);box-shadow:0 2px 6px #8b5cf633}.global-settings-panel .setting-select option{background-color:var(--bg-secondary)!important;color:var(--text-primary)!important;padding:.75rem;font-weight:500;border:none}.global-settings-panel .setting-select option:checked{background-color:var(--accent-primary)!important;color:#fff!important}.global-settings-panel .setting-select option:hover{background-color:var(--bg-hover)!important}@supports (-webkit-appearance: none){.global-settings-panel .setting-select{background-color:var(--bg-primary)!important;color:var(--text-primary)!important}.global-settings-panel .setting-select option{background-color:var(--bg-secondary)!important;color:var(--text-primary)!important}}@-moz-document url-prefix(){.global-settings-panel .setting-select{background-color:var(--bg-primary)!important;color:var(--text-primary)!important}.global-settings-panel .setting-select option{background-color:var(--bg-secondary)!important;color:var(--text-primary)!important}}@media (prefers-color-scheme: dark){.global-settings-panel .setting-select{background-color:var(--bg-primary)!important;color:var(--text-primary)!important}.global-settings-panel .setting-select option{background-color:var(--bg-secondary)!important;color:var(--text-primary)!important}}.calculate-all-button{display:flex;align-items:center;justify-content:center;gap:.5rem;background:linear-gradient(135deg,var(--accent-primary),#7c3aed);color:#fff;border:none;padding:.75rem 1.5rem;border-radius:.75rem;font-size:1rem;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 12px #8b5cf64d;white-space:nowrap}.calculate-all-button:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px #8b5cf666;background:linear-gradient(135deg,#7c3aed,var(--accent-primary))}.calculate-all-button:active:not(:disabled){transform:translateY(0);box-shadow:0 2px 8px #8b5cf64d}.calculate-all-button:disabled{background:var(--bg-tertiary);color:var(--text-secondary);cursor:not-allowed;box-shadow:none;transform:none}.planner-header{display:grid;grid-template-columns:1fr auto;gap:2rem;margin-bottom:2rem;align-items:start}.add-character-section{background:var(--bg-secondary);border:1px solid var(--border-primary);border-radius:1rem;padding:1.5rem;display:flex;flex-direction:column;min-height:7.5rem}.add-character-section .section-title{margin-bottom:1rem;margin-top:0;flex-shrink:0}.add-character-form{display:flex;gap:1rem;margin-top:auto;flex-shrink:0}.character-name-input{flex:1;background:var(--bg-primary);border:1px solid var(--border-secondary);color:var(--text-primary);padding:.75rem 1rem;border-radius:.5rem;font-size:1rem;transition:border-color .2s ease;height:2.75rem;box-sizing:border-box}.character-name-input:focus{outline:none;border-color:var(--accent-primary);box-shadow:0 0 0 3px #8b5cf61a}.add-character-button{background:var(--accent-primary);color:#fff;border:none;padding:.75rem 1.5rem;border-radius:.5rem;font-weight:600;cursor:pointer;transition:all .2s ease;white-space:nowrap;height:2.75rem;box-sizing:border-box}.add-character-button:hover:not(:disabled){background:var(--accent-primary-hover);transform:translateY(-1px)}.add-character-button:disabled{background:var(--bg-tertiary);color:var(--text-secondary);cursor:not-allowed;transform:none}.overall-total{background:var(--bg-secondary);border:1px solid var(--border-primary);border-radius:1rem;padding:1.5rem;text-align:center;min-width:15.625rem;display:flex;flex-direction:column;min-height:7.5rem}.overall-total .section-title{margin-bottom:1rem;font-size:1.3rem;font-weight:600;color:var(--text-primary);text-align:center;margin-top:0;display:flex;align-items:center;justify-content:center;flex-shrink:0}.overall-total .section-title:before{content:"";width:.25rem;height:1.25rem;background:var(--accent-primary);border-radius:.125rem;margin-right:.5rem}.total-cost-display{display:flex;flex-direction:column;align-items:center;gap:.25rem;flex:1;justify-content:center}.total-amount{font-size:1.75rem;font-weight:700;color:var(--accent-primary);line-height:1}.total-unit{font-size:.875rem;color:var(--text-secondary);font-weight:500}.cost-type-indicator{font-size:.65rem;font-weight:600;color:var(--text-secondary);background:#8b5cf614;border:1px solid rgba(139,92,246,.15);padding:.15rem .4rem;border-radius:.25rem;margin-left:.4rem;display:inline-flex;align-items:center;text-transform:uppercase;letter-spacing:.3px;transition:all .2s ease;vertical-align:middle}.cost-type-indicator:hover{background:#8b5cf61f;border-color:#8b5cf640;color:var(--accent-primary);transform:translateY(-.5px)}.characters-list{display:flex;flex-direction:column;gap:1.5rem;min-height:0;height:auto}.no-characters{background:var(--bg-secondary);border:1px solid var(--border-primary);border-radius:1rem;padding:3rem;text-align:center;color:var(--text-secondary);font-size:1.1rem}.character-card{background:var(--bg-secondary);border:1px solid var(--border-primary);border-radius:1rem;overflow:visible;transition:box-shadow .2s ease}.character-card:hover{box-shadow:0 4px 12px #0000001a}.character-header{display:grid;grid-template-columns:1fr auto auto;align-items:center;gap:1rem;padding:1.5rem;border-bottom:1px solid var(--border-secondary)}.character-info{display:flex;flex-direction:column;gap:.5rem}.character-name-row{display:flex;align-items:center;gap:1rem}.character-name{font-size:1.3rem;font-weight:600;color:var(--text-primary);margin:0}.character-stats{display:flex;gap:1rem;font-size:.85rem;color:var(--text-secondary);align-items:center}.character-total-badge{background:linear-gradient(135deg,var(--accent-primary),var(--accent-secondary));color:#fff;padding:.375rem .75rem;border-radius:1rem;font-size:.9rem;font-weight:600;white-space:nowrap;box-shadow:0 2px 8px #8b5cf64d;align-self:center}.item-count{padding:.25rem .5rem;background:var(--bg-tertiary);border-radius:.25rem;display:inline-flex;align-items:center}.calculated-items{padding:.25rem .5rem;background:#22c55e1a;border:1px solid rgba(34,197,94,.2);border-radius:.25rem;color:var(--accent-success);font-weight:500;display:inline-flex;align-items:center}.character-actions{display:flex;gap:.5rem}.expand-button,.remove-character-button{background:var(--bg-tertiary);border:1px solid var(--border-secondary);color:var(--text-secondary);padding:.5rem;border-radius:.5rem;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;width:40px;height:40px}.expand-button:hover{background:var(--bg-hover);color:var(--text-primary)}.remove-character-button:hover{background:var(--accent-error);color:#fff;border-color:var(--accent-error)}.character-content{padding:1.5rem}.items-section{width:100%}.items-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:1rem}.items-header h5{margin:0;font-size:1.1rem;color:var(--text-primary)}.add-item-button{background:var(--accent-secondary);color:#fff;border:none;padding:.5rem 1rem;border-radius:.5rem;font-size:.9rem;cursor:pointer;transition:all .2s ease}.add-item-button:hover{background:var(--accent-secondary-hover);transform:translateY(-1px)}.no-items{padding:2rem;text-align:center;color:var(--text-secondary);background:var(--bg-tertiary);border-radius:.5rem}.items-list{display:flex;flex-direction:column;gap:1rem}.item-card{background:var(--bg-quaternary);border:1px solid rgba(162,89,247,.15);border-radius:.75rem;overflow:visible;box-shadow:0 2px 8px #0000004d}.item-header{display:grid;grid-template-columns:1fr auto;align-items:center;gap:1rem;padding:1rem;border-bottom:1px solid var(--border-secondary);overflow:visible;min-height:50px}.item-info{display:flex;flex-direction:column;gap:.5rem;min-width:0;overflow:visible}.item-cost-badge{background:transparent;border:none;border-radius:.5rem;font-size:.85rem;font-weight:600;white-space:nowrap;min-width:90px;height:36px;display:flex;align-items:center;justify-content:center;gap:0;position:relative}.meso-part{background:linear-gradient(135deg,#22c55e26,#22c55e14);border:1px solid rgba(34,197,94,.4);color:#22c55e;padding:.25rem .5rem;display:flex;align-items:center;justify-content:center;border-radius:.5rem 0 0 .5rem;border-right:none;box-shadow:0 0 8px #22c55e33;text-shadow:0 0 4px rgba(34,197,94,.3);cursor:help;transition:all .2s ease;position:relative;height:100%;box-sizing:border-box}.meso-part:hover{background:linear-gradient(135deg,#22c55e40,#22c55e26);box-shadow:0 0 12px #22c55e66}.boom-part{background:linear-gradient(135deg,#ef444426,#ef444414);border:1px solid rgba(239,68,68,.4);color:#ef4444;padding:.25rem .5rem;display:flex;align-items:center;justify-content:center;border-radius:0 .5rem .5rem 0;border-left:none;box-shadow:0 0 8px #ef444433;text-shadow:0 0 4px rgba(239,68,68,.3);cursor:help;transition:all .2s ease;position:relative;height:100%;box-sizing:border-box}.boom-part:hover{background:linear-gradient(135deg,#ef444440,#ef444426);box-shadow:0 0 12px #ef444466}.item-cost-pending-badge{background:var(--bg-tertiary);border:none;color:var(--text-secondary);padding:.25rem .5rem;border-radius:.5rem;font-size:.85rem;font-style:italic;opacity:.7;white-space:nowrap;min-width:90px;height:36px;text-align:center;display:flex;align-items:center;justify-content:center;box-sizing:border-box}.item-actions{display:flex;gap:.5rem}.expand-item-button,.remove-item-button{background:var(--bg-secondary);border:none;color:var(--text-secondary);padding:0;border-radius:.5rem;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;width:36px;height:36px;font-size:.9rem;flex-shrink:0;box-sizing:border-box}.expand-item-button:hover{background:var(--bg-hover);color:var(--text-primary)}.remove-item-button:hover{background:var(--accent-error);color:#fff}.item-content{padding:1.5rem;display:flex;flex-direction:column;gap:1.5rem;min-height:0;height:auto}.item-settings{display:grid;gap:1rem}.setting-group{display:flex;flex-direction:column;gap:.5rem}.setting-group label{font-size:.9rem;color:var(--text-secondary);font-weight:500}.item-settings .setting-input,.item-settings .setting-select{background:var(--bg-secondary)!important;border:1px solid var(--border-secondary)!important;color:var(--text-primary)!important;padding:.5rem .75rem;border-radius:.5rem;font-size:.9rem;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;font-weight:500;transition:border-color .2s ease}.item-settings .setting-input:focus,.item-settings .setting-select:focus{outline:none!important;border-color:var(--accent-primary)!important;box-shadow:0 0 0 3px #8b5cf61a!important}.item-settings .setting-select{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--bg-secondary)!important;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23a1a1aa' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right .75rem center;background-size:1rem;padding-right:2.5rem;color-scheme:dark}.item-settings .setting-select option{background-color:var(--bg-secondary)!important;color:var(--text-primary)!important}@supports (-webkit-appearance: none){.item-settings .setting-select,.item-settings .setting-select:focus,.item-settings .setting-select:active{background-color:var(--bg-secondary)!important;color:var(--text-primary)!important}}@-moz-document url-prefix(){.item-settings .setting-select,.item-settings .setting-select option{background-color:var(--bg-secondary)!important;color:var(--text-primary)!important}}.toggles-section{margin-top:1rem}.toggle-buttons-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:.75rem}.toggle-button{display:flex;align-items:center;gap:.5rem;padding:.75rem 1rem;background:var(--bg-secondary);border:2px solid var(--border-secondary);border-radius:.75rem;color:var(--text-secondary);font-size:.85rem;font-weight:500;cursor:pointer;transition:all .2s ease;text-align:left;width:100%}.toggle-button:hover:not(:disabled){background:var(--bg-hover);border-color:var(--accent-primary);color:var(--text-primary);transform:translateY(-1px)}.toggle-button.active{background:linear-gradient(135deg,#8b5cf61a,#8b5cf60d);border-color:var(--accent-primary);color:var(--accent-primary);box-shadow:0 2px 8px #8b5cf633}.toggle-button.disabled{opacity:.5;cursor:not-allowed;background:var(--bg-tertiary);border-color:var(--border-secondary);color:var(--text-secondary)}.toggle-button:disabled{opacity:.5;cursor:not-allowed;transform:none}.toggle-icon{font-size:1rem;opacity:.8}.toggle-button.active .toggle-icon{opacity:1}.toggle-text{flex:1}.calculate-section{margin-top:.5rem}.item-calculate-button{background:var(--accent-primary);color:#fff;border:none;padding:.75rem 1.5rem;border-radius:.5rem;font-weight:600;cursor:pointer;transition:all .2s ease;width:100%}.item-calculate-button:hover:not(:disabled){background:var(--accent-primary-hover);transform:translateY(-1px)}.item-calculate-button:disabled{background:var(--bg-tertiary);color:var(--text-secondary);cursor:not-allowed;transform:none}.button-warning{margin-top:.5rem;text-align:center}.button-warning small{color:var(--text-secondary);font-size:.8rem}.item-results{background:var(--bg-secondary);border:1px solid var(--border-secondary);border-radius:.5rem;padding:1rem}.results-summary{display:grid;gap:.75rem}.result-item{display:flex;justify-content:space-between;align-items:center;padding:.5rem;background:var(--bg-quaternary);border:1px solid rgba(162,89,247,.08);border-radius:.375rem;box-shadow:0 1px 3px #0003}.result-label{font-size:.85rem;color:var(--text-secondary);font-weight:500}.result-value{font-weight:600;color:var(--text-primary);font-size:.9rem}.result-error{padding:.75rem;background:#ef44441a;border:1px solid rgba(239,68,68,.3);border-radius:.5rem;color:var(--accent-error);font-size:.9rem;text-align:center}@media (max-width: 1024px){.planner-container{margin:0;padding:0 1rem}.planner-header{grid-template-columns:1fr;gap:1.5rem}.overall-total{min-width:auto}.item-content{gap:1.25rem}.global-settings-grid{grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:.875rem}.global-settings-panel .setting-select{padding:.75rem 2.75rem .75rem .875rem;font-size:.95rem;background-size:1rem}}@media (max-width: 768px){.planner-container{padding:0 .5rem}.add-character-form{flex-direction:column;gap:.75rem}.character-header{grid-template-columns:1fr;gap:1rem;text-align:center}.character-info{order:1}.character-total-badge{font-size:.8rem;padding:.25rem .5rem;order:2;justify-self:center}.character-actions{order:3;justify-self:center}.character-stats{justify-content:center}.item-header{flex-direction:column;gap:1rem;align-items:flex-start;position:relative}.item-actions{position:absolute;top:.75rem;right:.75rem}.item-calculate-button{font-size:.9rem;padding:.625rem 1.25rem}.global-settings-grid{grid-template-columns:1fr;gap:1rem}.global-settings-panel .setting-select{padding:.875rem 3rem .875rem 1rem;font-size:1rem;background-size:1.1rem}.global-settings-panel .setting-group label{font-size:.85rem;letter-spacing:.25px}}@media (max-width: 480px){.planner-container{padding:0}.add-character-section,.overall-total,.character-card{margin:0 .5rem;border-radius:.75rem}.total-amount{font-size:1.5rem}.character-stats{flex-direction:column;gap:.5rem}}.enhancement-inputs select,.enhancement-inputs select:focus,.enhancement-inputs select:active{background-color:var(--bg-primary)!important;color:var(--text-primary)!important;border:1px solid var(--border-secondary)!important}.enhancement-inputs select option{background-color:var(--bg-primary)!important;color:var(--text-primary)!important}@supports (-webkit-appearance: none){.enhancement-inputs select,.enhancement-inputs select option{background-color:var(--bg-primary)!important;color:var(--text-primary)!important}}@-moz-document url-prefix(){.enhancement-inputs select,.enhancement-inputs select option{background-color:var(--bg-primary)!important;color:var(--text-primary)!important}}@supports (-ms-ime-align: auto){.enhancement-inputs select,.enhancement-inputs select option{background-color:var(--bg-primary)!important;color:var(--text-primary)!important}}.enhancement-inputs{--select-bg: var(--bg-primary);--select-color: var(--text-primary)}.enhancement-inputs select,.enhancement-inputs select option{background:var(--select-bg)!important;color:var(--select-color)!important}.enhancement-inputs select{color-scheme:dark!important}.enhancement-calculator-page{--dropdown-bg: var(--bg-secondary);--dropdown-text: var(--text-primary);--dropdown-border: var(--border-primary)}.enhancement-calculator-page .enhancement-inputs select,.enhancement-calculator-page .item-settings select,.enhancement-calculator-page select{background-color:var(--dropdown-bg)!important;background:var(--dropdown-bg)!important;color:var(--dropdown-text)!important;border-color:var(--dropdown-border)!important;color-scheme:dark!important;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif!important;font-weight:500!important}.enhancement-calculator-page select option,.enhancement-calculator-page .enhancement-inputs select option,.enhancement-calculator-page .item-settings select option{background-color:var(--dropdown-bg)!important;background:var(--dropdown-bg)!important;color:var(--dropdown-text)!important}.enhancement-calculator-page select,.enhancement-calculator-page select:focus,.enhancement-calculator-page select:active,.enhancement-calculator-page select:hover{background-color:var(--bg-secondary)!important;background:var(--bg-secondary)!important;color:var(--text-primary)!important;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif!important;font-weight:500!important}.enhancement-calculator-page select option,.enhancement-calculator-page select option:checked,.enhancement-calculator-page select option:hover{background-color:var(--bg-secondary)!important;background:var(--bg-secondary)!important;color:var(--text-primary)!important;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif!important;font-weight:500!important}@supports (-webkit-appearance: none){.enhancement-calculator-page select{-webkit-appearance:none!important;background-color:var(--bg-secondary)!important;color:var(--text-primary)!important;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif!important;font-weight:500!important}.enhancement-calculator-page select option{background-color:var(--bg-secondary)!important;color:var(--text-primary)!important;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif!important}}@-moz-document url-prefix(){.enhancement-calculator-page select{background-color:var(--bg-secondary)!important;color:var(--text-primary)!important;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif!important;font-weight:500!important}.enhancement-calculator-page select option{background-color:var(--bg-secondary)!important;color:var(--text-primary)!important;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif!important}}@media (prefers-color-scheme: dark){.enhancement-calculator-page select{background-color:var(--bg-secondary)!important;color:var(--text-primary)!important;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif!important;font-weight:500!important}.enhancement-calculator-page select option{background-color:var(--bg-secondary)!important;color:var(--text-primary)!important;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif!important}}.item-error-inline{margin-top:8px;padding:6px 10px;background:#ef44441a;border:1px solid rgba(239,68,68,.2);border-radius:4px;color:var(--accent-error);font-size:11px;font-weight:500}.item-header-row-inline{display:flex;align-items:center;justify-content:center;gap:16px;flex-wrap:wrap;width:100%;overflow:visible}.item-name-input-container{flex:0 0 auto;min-width:140px}.item-name-input{background:var(--bg-primary);border:none;color:var(--text-primary);padding:0 8px;border-radius:6px;font-size:13px;font-weight:500;width:130px;height:36px;transition:all .2s ease;box-sizing:border-box}.item-name-input:focus{outline:none;border-color:var(--accent-primary);box-shadow:0 0 0 2px #a259f71a}.item-name-input::-moz-placeholder{color:var(--text-muted);opacity:.7}.item-name-input::placeholder{color:var(--text-muted);opacity:.7}.summary-control-inline{display:flex;align-items:center;gap:6px}.summary-control-inline label{font-size:13px;font-weight:500;color:var(--text-secondary);min-width:24px}.level-input-inline{width:65px;height:36px;padding:0 8px;background:var(--bg-primary);border:none;border-radius:6px;color:var(--text-primary);font-size:13px;text-align:center;font-weight:500;-moz-appearance:textfield;box-sizing:border-box}.level-input-inline::-webkit-outer-spin-button,.level-input-inline::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.level-input-inline:focus{outline:none;border-color:var(--accent-primary);box-shadow:0 0 0 2px #8b5cf61a}.star-range-inline{display:flex;align-items:center;gap:8px}.star-select-inline{width:60px;height:36px;padding:0 8px;background:var(--bg-primary);border:none;border-radius:6px;color:var(--text-primary);font-size:13px;text-align:center;font-weight:500;box-sizing:border-box}.star-select-inline:focus{outline:none;border-color:var(--accent-primary);box-shadow:0 0 0 2px #8b5cf61a}.star-arrow{color:var(--text-secondary);font-size:14px;font-weight:700;margin:0 2px}.toggle-controls-inline{display:flex;gap:10px}.toggle-btn-inline{background:var(--bg-secondary);border:none;border-radius:6px;padding:6px 12px;cursor:pointer;font-size:13px;color:var(--text-secondary);transition:all .2s ease;height:36px;display:flex;align-items:center;justify-content:center;gap:6px;font-weight:500;white-space:nowrap;box-sizing:border-box}.toggle-btn-inline .toggle-icon{font-size:14px}.toggle-btn-inline .toggle-text{font-size:13px;font-weight:500}.toggle-btn-inline:hover:not(.disabled){border-color:var(--accent-primary);background:#8b5cf60d}.toggle-btn-inline.active{background:var(--accent-primary);border-color:var(--accent-primary);color:#fff;box-shadow:0 2px 8px #8b5cf64d}.toggle-btn-inline.disabled{opacity:.5;cursor:not-allowed;background:var(--bg-tertiary)}.calculate-item-button-inline{background:var(--accent-primary);border:none;border-radius:6px;padding:6px 12px;color:#fff;cursor:pointer;font-size:13px;font-weight:600;transition:all .2s ease;height:36px;min-width:40px;display:flex;align-items:center;justify-content:center;box-sizing:border-box}.calculate-item-button-inline:hover:not(:disabled){background:var(--accent-primary-hover);transform:translateY(-1px);box-shadow:0 4px 8px #8b5cf64d}.calculate-item-button-inline:disabled{opacity:.5;cursor:not-allowed;transform:none;box-shadow:none}@media (max-width: 768px){.item-header-row-inline{flex-wrap:wrap;gap:8px;justify-content:flex-start}.item-name-input-container{flex:1 1 100%;margin-bottom:6px}.summary-control-inline,.star-range-inline,.toggle-controls-inline,.calculate-item-button-inline{flex-shrink:0}.toggle-controls-inline{gap:6px}.meso-part,.boom-part{font-size:.75rem;padding:.25rem .5rem}}.cost-tooltip{position:absolute;bottom:100%;left:50%;transform:translate(-50%);margin-bottom:8px;padding:.5rem .75rem;background:var(--bg-primary);border:1px solid var(--border-secondary);border-radius:.5rem;color:var(--text-primary);font-size:.75rem;font-weight:500;white-space:nowrap;box-shadow:0 4px 12px #00000026;opacity:0;visibility:hidden;transition:all .2s ease;z-index:9999;pointer-events:none}.cost-tooltip:after{content:"";position:absolute;top:100%;left:50%;transform:translate(-50%);border:4px solid transparent;border-top-color:var(--bg-primary)}.meso-part:hover .cost-tooltip,.boom-part:hover .cost-tooltip{opacity:1;visibility:visible;transform:translate(-50%) translateY(-2px)}.meso-tooltip{background:linear-gradient(135deg,#22c55ef2,#22c55ee6);border-color:#22c55e99;color:#fff;text-shadow:0 1px 2px rgba(0,0,0,.3);box-shadow:0 4px 12px #22c55e4d}.meso-tooltip:after{border-top-color:#22c55ef2}.boom-tooltip{background:linear-gradient(135deg,#ef4444f2,#ef4444e6);border-color:#ef444499;color:#fff;text-shadow:0 1px 2px rgba(0,0,0,.3);box-shadow:0 4px 12px #ef44444d}.boom-tooltip:after{border-top-color:#ef4444f2}.level-cap-info{font-size:.85rem;color:var(--accent-primary);font-weight:500;opacity:.9}.level-cap-hint{font-size:.75rem;color:var(--accent-primary);font-weight:500;opacity:.8;margin-left:.25rem}.formula-floating-button{position:fixed;top:120px;right:30px;width:45px;height:45px;background:linear-gradient(135deg,var(--accent-primary),var(--accent-secondary));color:#fff;border:none;border-radius:50%;font-size:1.4rem;font-weight:700;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 12px #a259f74d;z-index:1000;display:flex;align-items:center;justify-content:center;border:2px solid var(--border-primary)}.formula-floating-button:hover{transform:translateY(-2px) scale(1.05);box-shadow:0 8px 20px #a259f766;background:linear-gradient(135deg,var(--accent-primary-hover),var(--accent-secondary-hover))}.formula-floating-button:active{transform:translateY(0) scale(1)}@media (max-width: 768px){.formula-floating-button{top:100px;right:20px;width:40px;height:40px;font-size:1.2rem}}.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:#000000b3;display:flex;justify-content:center;align-items:center;z-index:10000;padding:2rem}.formula-modal{background:var(--bg-secondary);border:1px solid var(--border-primary);border-radius:16px;box-shadow:0 25px 50px #00000080;max-width:1000px;width:100%;max-height:90vh;overflow:hidden;display:flex;flex-direction:column}.formula-modal-header{background:linear-gradient(135deg,#1a0d2e,#2d1b4e,#3c2463,#2d1b4e);background-size:300% 300%;animation:breathingGradient 8s ease-in-out infinite;color:var(--text-primary);padding:1.5rem 2rem;display:flex;justify-content:space-between;align-items:center;border-radius:16px 16px 0 0;position:relative;overflow:hidden}.formula-modal-header:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(45deg,rgba(255,255,255,.02),transparent,rgba(255,255,255,.01));animation:breathingOverlay 8s ease-in-out infinite;pointer-events:none}.formula-modal-header h2{margin:0;font-size:1.5rem;font-weight:600;position:relative;z-index:2;text-shadow:0 1px 3px rgba(0,0,0,.3)}.close-button{background:none;border:none;color:var(--text-primary);font-size:2rem;cursor:pointer;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:8px;transition:all .2s ease;position:relative;z-index:2;text-shadow:0 1px 3px rgba(0,0,0,.5)}.close-button:hover{background:#fff3;transform:scale(1.1);box-shadow:0 0 10px #ffffff4d}.formula-modal-content{overflow-y:auto;padding:2rem;flex:1;background:var(--bg-secondary)}.formula-section{margin-bottom:2rem;border:1px solid var(--border-primary);border-radius:12px;overflow:hidden;background:var(--bg-tertiary)}.formula-section h3{background:linear-gradient(135deg,#1a0d2e,#2d1b4e,#3c2463,#2d1b4e);background-size:300% 300%;animation:breathingGradient 8s ease-in-out infinite;color:var(--text-primary);margin:0;padding:1rem 1.5rem;font-size:1.2rem;font-weight:600;border-bottom:1px solid var(--border-primary);position:relative;overflow:hidden;text-shadow:0 1px 3px rgba(0,0,0,.5)}.formula-section h3:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(45deg,rgba(255,255,255,.02),transparent,rgba(255,255,255,.01));animation:breathingOverlay 8s ease-in-out infinite;pointer-events:none}.formula-box{padding:1.5rem;background:var(--bg-quaternary)}.formula-title{font-size:1.1rem;font-weight:600;color:var(--text-primary);margin-bottom:1rem}.formula-math{background:linear-gradient(135deg,#1a0d2e,#2d1b4e,#3c2463);color:var(--text-primary);padding:1rem 1.5rem;border-radius:8px;font-family:Monaco,Menlo,Ubuntu Mono,monospace;font-size:.95rem;line-height:1.6;margin-bottom:1rem;overflow-x:auto;white-space:nowrap;border:1px solid var(--border-secondary);text-shadow:0 1px 2px rgba(0,0,0,.5)}.formula-details{color:var(--text-secondary);line-height:1.6}.formula-details p{margin:0 0 .75rem}.formula-details ul{margin:.5rem 0 0;padding-left:1.5rem}.formula-details li{margin-bottom:.5rem}.formula-details code{background:var(--bg-tertiary);color:var(--accent-primary);padding:.2rem .4rem;border-radius:4px;font-family:Monaco,Menlo,Ubuntu Mono,monospace;font-size:.9em;border:1px solid var(--border-secondary)}.formula-table{background:var(--bg-tertiary);padding:1.5rem;border-radius:8px;margin-top:1rem;border:1px solid var(--border-secondary)}.formula-table h4{color:var(--text-primary);margin:0 0 1rem;font-size:1rem;font-weight:600}.formula-table table{width:100%;border-collapse:collapse;font-size:.9rem}.formula-table th{background:linear-gradient(135deg,#1a0d2e,#2d1b4e,#3c2463,#2d1b4e);background-size:300% 300%;animation:breathingGradient 8s ease-in-out infinite;color:var(--text-primary);padding:.75rem;text-align:left;font-weight:600;border:1px solid var(--border-primary);position:relative;overflow:hidden;text-shadow:0 1px 3px rgba(0,0,0,.5)}.formula-table th:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(45deg,rgba(255,255,255,.02),transparent,rgba(255,255,255,.01));animation:breathingOverlay 8s ease-in-out infinite;pointer-events:none}.formula-table td{padding:.75rem;border:1px solid var(--border-secondary);color:var(--text-secondary)}.formula-table tbody tr:nth-child(2n){background:var(--bg-quaternary)}.formula-table tbody tr:hover{background:var(--bg-hover)}@media (max-width: 768px){.header-top{flex-direction:column;gap:1rem;align-items:center;text-align:center}.formula-reference-button{align-self:stretch}.formula-modal{margin:1rem;max-height:calc(100vh - 2rem)}.formula-modal-content{padding:1rem}.formula-table table{font-size:.8rem}.formula-table th,.formula-table td{padding:.5rem}}@media (max-width: 480px){.formula-reference-button{font-size:.9rem;padding:.6rem 1rem}.formula-modal-header{padding:1rem}.formula-modal-header h2{font-size:1.2rem}.formula-math{font-size:.85rem;padding:.875rem 1.25rem}}.spares-container{display:flex;align-items:center;gap:8px;margin-left:8px;padding:0 12px;background:var(--bg-tertiary);border-radius:8px;border:none;height:36px;box-sizing:border-box}.spares-input{display:flex;align-items:center;gap:6px}.spares-input label{font-size:12px;font-weight:500;color:var(--text-secondary);white-space:nowrap}.spares-input-field{width:60px;height:26px;padding:0 6px;border:none;border-radius:4px;background:var(--bg-primary);color:var(--text-primary);font-size:12px;text-align:center;box-sizing:border-box;-moz-appearance:textfield}.spares-input-field::-webkit-outer-spin-button,.spares-input-field::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.spares-input-field:focus{outline:none;border-color:var(--accent-primary);box-shadow:0 0 0 2px #8b5cf61a}.spares-result{display:flex;align-items:center}.success-chance{background:linear-gradient(135deg,#22c55e26,#22c55e14);border:1px solid rgba(34,197,94,.4);color:#22c55e;padding:.25rem .5rem;border-radius:4px;font-size:12px;font-weight:600;cursor:help;position:relative;white-space:nowrap;display:flex;align-items:center;gap:4px;min-width:52px;justify-content:center}.spares-tooltip{position:absolute;bottom:calc(100% + 8px);left:50%;transform:translate(-50%);background:#000000e6;color:#fff;padding:8px 12px;border-radius:6px;font-size:12px;font-weight:400;white-space:nowrap;box-shadow:0 4px 12px #0006;border:1px solid rgba(255,255,255,.2);opacity:0;visibility:hidden;transition:opacity .2s,visibility .2s;pointer-events:none;z-index:1000;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px)}.spares-tooltip:after{content:"";position:absolute;top:100%;left:50%;transform:translate(-50%);border:6px solid transparent;border-top-color:#000000e6}.success-chance:hover .spares-tooltip{opacity:1;visibility:visible}.spares-pending{font-size:11px;color:var(--text-secondary);font-style:italic}@media (max-width: 768px){.spares-container{flex-direction:column;align-items:flex-start;gap:8px}.spares-input-field{width:70px}}.success-chance-placeholder{background:transparent;border:1px solid transparent;color:transparent;padding:.25rem .5rem;border-radius:4px;font-size:12px;font-weight:600;white-space:nowrap}
