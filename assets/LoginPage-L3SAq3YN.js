import{j as t}from"./vendor-ui-aK89YfOw.js";import{u as W,a as Y,r as a}from"./vendor-router-Cg8TMqY4.js";import{u as z,l as E}from"./index-sN8zbtG7.js";import"./vendor-react-eWEExxYH.js";import"./vendor-supabase-B7S7y5aO.js";function P(){const{isLoggedIn:d,loginInput:r,setLoginInput:u,setLoginError:p,isCreating:n,createCooldown:o,showPassword:i,setShowPassword:h,handleCreateAccount:x,handleLogin:b}=z(),w=W();Y();const[c,g]=a.useState(!1),[m,T]=a.useState(""),[l,f]=a.useState(6),[y,j]=a.useState(!1),[C,L]=a.useState(!1),[s,v]=a.useState(!1),k=async()=>{(await b()).success&&(setTimeout(()=>{const A=new CustomEvent("authDataRefresh",{detail:{userCode:m,action:"create"}});window.dispatchEvent(A)},100),setTimeout(()=>{w("/",{replace:!0})},200)),g(!1)},M=()=>{g(!1),f(6)};if(a.useEffect(()=>{let e;return c&&l>0?e=setTimeout(()=>f(l-1),1e3):c&&l===0&&k(),()=>clearTimeout(e)},[c,l,m,d]),a.useEffect(()=>{if(C){const e=setTimeout(()=>L(!1),2e3);return()=>clearTimeout(e)}},[C]),d)return null;const N=async()=>{const e=await x();e.success&&e.code&&(T(e.code),u(e.code),g(!0),f(6))},S=async()=>{if(!s){v(!0),p("");try{(await b()).success&&setTimeout(()=>{w("/",{replace:!0})},200)}catch(e){console.error("Login wrapper error:",e)}finally{v(!1)}}},I=e=>{e.key==="Enter"&&r.trim()&&!s&&S()};return t.jsxs("div",{style:{padding:"2rem 0",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",width:"100%"},children:[t.jsx("h1",{style:{fontWeight:700,fontSize:"2.2rem",marginBottom:"1.5rem"},children:"Maplestory Boss Crystal Calculator"}),t.jsxs("div",{style:{background:"#2d2540",borderRadius:10,padding:"2rem",boxShadow:"0 2px 8px rgba(40, 20, 60, 0.18)",minWidth:320,display:"flex",flexDirection:"column",gap:16,alignItems:"center"},children:[t.jsx("button",{onClick:N,disabled:n||o>0,style:{background:n||o>0?"#6b46c1":"#a259f7",color:"#fff",border:"none",borderRadius:6,padding:"0.7rem 1.5rem",fontWeight:700,fontSize:"1.1rem",marginBottom:8,opacity:n||o>0?.6:1,cursor:n||o>0?"not-allowed":"pointer",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:n||o>0?"none":"0 2px 8px rgba(162, 89, 247, 0.3)",transform:"translateY(0)",width:"100%"},onMouseOver:e=>{n||o>0||(e.currentTarget.style.background="#b470ff",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 16px rgba(162, 89, 247, 0.4)")},onMouseOut:e=>{n||o>0||(e.currentTarget.style.background="#a259f7",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 8px rgba(162, 89, 247, 0.3)")},onMouseDown:e=>{n||o>0||(e.currentTarget.style.transform="translateY(1px)",e.currentTarget.style.boxShadow="0 1px 4px rgba(162, 89, 247, 0.2)")},onMouseUp:e=>{n||o>0||(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 16px rgba(162, 89, 247, 0.4)")},children:n?"Creating Account...":o>0?`Creating Account (${o})`:"Create Account"}),t.jsxs("div",{style:{width:"100%",textAlign:"center",color:"#b39ddb",fontSize:"1.2rem",fontWeight:700,margin:"16px 0",display:"flex",alignItems:"center",gap:12},children:[t.jsx("span",{style:{flex:1,height:1,background:"#3a335a"}}),t.jsx("span",{style:{fontSize:"1.2em",fontWeight:700},children:"or"}),t.jsx("span",{style:{flex:1,height:1,background:"#3a335a"}})]}),t.jsxs("div",{style:{position:"relative",width:"100%",marginBottom:8},children:[t.jsx("input",{type:i?"text":"password",value:r,onChange:e=>u(e.target.value.toUpperCase()),onKeyDown:I,placeholder:"Enter your code",onFocus:()=>j(!0),onBlur:()=>j(!1),style:{background:"#3a335a",color:"#e6e0ff",border:y?"2px solid #a259f7":"1.5px solid #2d2540",borderRadius:6,padding:"0.5rem 1rem",fontSize:"1.1rem",width:"100%",boxSizing:"border-box",outline:"none",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:y?"0 0 0 3px rgba(162, 89, 247, 0.1), 0 0 20px rgba(162, 89, 247, 0.1)":"none",paddingRight:"3rem"}}),t.jsx("button",{type:"button",onClick:()=>h(!i),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"transparent",border:"none",color:"#b39ddb",cursor:"pointer",padding:"0.3rem",display:"flex",alignItems:"center",justifyContent:"center"},title:i?"Hide code":"Show code",children:i?t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"}),t.jsx("circle",{cx:"12",cy:"12",r:"3"})]}):t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24"}),t.jsx("path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"}),t.jsx("path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"}),t.jsx("line",{x1:"2",x2:"22",y1:"2",y2:"22"})]})})]}),t.jsxs("button",{onClick:S,disabled:!r.trim()||s,style:{background:!r.trim()||s?"#4a4570":"#6b46c1",color:"#fff",border:"none",borderRadius:6,padding:"0.7rem 1.5rem",fontWeight:700,fontSize:"1.1rem",cursor:!r.trim()||s?"not-allowed":"pointer",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:!r.trim()||s?"none":"0 2px 8px rgba(107, 70, 193, 0.3)",transform:"translateY(0)",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},onMouseOver:e=>{!r.trim()||s||(e.currentTarget.style.background="#7c5dc7",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 16px rgba(107, 70, 193, 0.4)")},onMouseOut:e=>{!r.trim()||s||(e.currentTarget.style.background="#6b46c1",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 8px rgba(107, 70, 193, 0.3)")},onMouseDown:e=>{!r.trim()||s||(e.currentTarget.style.transform="translateY(1px)",e.currentTarget.style.boxShadow="0 1px 4px rgba(107, 70, 193, 0.2)")},onMouseUp:e=>{!r.trim()||s||(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 16px rgba(107, 70, 193, 0.4)")},children:[s&&t.jsx("div",{style:{width:"16px",height:"16px",border:"2px solid #fff",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}),s?"Logging in...":"Login"]})]}),c&&t.jsx(R,{show:c,userCode:m,countdown:l,onLoginNow:k,onClose:M})]})}function R({show:d,userCode:r,countdown:u,onLoginNow:p,onClose:n}){const[o,i]=a.useState(!1),h=async()=>{try{await navigator.clipboard.writeText(r),i(!0),setTimeout(()=>i(!1),2e3)}catch(x){E.error("Failed to copy to clipboard:",x)}};return d?t.jsx("div",{className:"modal-backdrop",children:t.jsxs("div",{className:"modal-content account-created-modal",children:[t.jsx("div",{className:"account-created-icon",children:t.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),t.jsx("h2",{className:"account-created-title",children:"Account Created Successfully!"}),t.jsx("p",{className:"account-created-subtitle",children:"Your unique login code is:"}),t.jsxs("div",{className:"account-created-code-container",children:[t.jsx("span",{className:"account-created-code",children:r}),t.jsx("button",{onClick:h,className:"account-created-copy-btn",title:"Copy Code",children:t.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),t.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]}),t.jsx("div",{className:"account-created-warning",children:t.jsxs("p",{children:[t.jsx("strong",{children:"⚠️ Important:"})," Please save this code immediately. It's the only way to access your account. If you lose it, your data cannot be recovered."]})}),t.jsx("div",{className:"account-created-countdown",children:t.jsxs("p",{children:["Logging you in automatically in: ",t.jsx("strong",{children:u}),"s"]})}),t.jsxs("div",{className:"modal-button-container",children:[t.jsx("button",{onClick:p,className:"modal-btn modal-btn-primary",children:"Login Now"}),t.jsx("button",{onClick:n,className:"modal-btn-cancel",children:"Close"})]}),o&&t.jsx("div",{className:"account-created-toast",children:"Code Copied!"})]})}):null}export{P as default};
