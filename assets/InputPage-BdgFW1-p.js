const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DataBackup-DCaK8fIJ.js","assets/vendor-ui-CuB_UNaH.js","assets/vendor-router-JN-2l_OL.js","assets/vendor-react-DrD-X_hS.js","assets/pitched-data-service-CcBFTTM6.js","assets/vendor-supabase-BFiW0B7-.js","assets/weekUtils-k0JY5ujR.js","assets/index-DF_U5-Pv.js","assets/index-DB_f044c.css","assets/supabaseClient-D8oTKsok.js"])))=>i.map(i=>d[i]);
import{_}from"./vendor-supabase-BFiW0B7-.js";import{j as e}from"./vendor-ui-CuB_UNaH.js";import{r as w}from"./vendor-router-JN-2l_OL.js";import{L as te,g as I,u as fe,a as ye,V as je,b as ke}from"./index-DF_U5-Pv.js";import{T as L,u as we,N as ve}from"./Navbar-BPTSueBQ.js";import{C as Se}from"./CustomCheckbox-PR03PWHK.js";import"./vendor-react-DrD-X_hS.js";import"./weekUtils-k0JY5ujR.js";function Te(){const[o,h]=w.useState(()=>{const p=localStorage.getItem("boss-presets");return p?JSON.parse(p):[]}),[x,i]=w.useState(""),[u,t]=w.useState(""),[m,f]=w.useState(!1),[a,k]=w.useState({}),d=p=>{h(p),localStorage.setItem("boss-presets",JSON.stringify(p))};return{presets:o,newPresetName:x,setNewPresetName:i,presetError:u,setPresetError:t,presetCreationMode:m,setPresetCreationMode:f,presetBosses:a,setPresetBosses:k,createPreset:(p,g)=>{if(!x.trim()){t("Please enter a preset name");return}if(o.some(s=>s.name.toLowerCase()===x.toLowerCase())){t("A preset with this name already exists");return}let j=[];if(m){if(Object.keys(a).length===0){t("Please select at least one boss");return}j=Object.entries(a).map(([s,v])=>({name:s,difficulty:v,partySize:1,price:0}))}else{if(p===null||!g[p]){t("Please select a character first");return}const s=g[p];if(!s.bosses||s.bosses.length===0){t("Selected character has no bosses configured");return}j=[...s.bosses]}const r={id:Date.now(),name:x.trim(),bosses:j,createdAt:new Date().toISOString()};d([...o,r]),i(""),t(""),k({}),f(!1)},applyPreset:(p,g,j,r)=>{if(g===null||!j[g]){t("Please select a character first"),setTimeout(()=>t(""),3e3);return}let s=p.bosses.map(C=>({...C}));const B=180-j.reduce((C,N,R)=>R===g?C:C+(N.bosses?N.bosses.length:0),0);s.length>B?(s.sort((C,N)=>{const R=C.price||0;return(N.price||0)-R}),s=s.slice(0,B),t(`Preset trimmed to stay within 180 crystal limit. Added ${B} highest-value bosses.`),setTimeout(()=>t(""),5e3)):t(""),r(g,s)},deletePreset:p=>{const g=o.filter(j=>j.id!==p);d(g)},handlePresetBossSelect:(p,g)=>{if(a[p])if(a[p]===g){const j={...a};delete j[p],k(j)}else k({...a,[p]:g});else k({...a,[p]:g});t("")}}}function Ce(){const[o,h]=w.useState({}),[x,i]=w.useState("");return{quickSelectBosses:o,setQuickSelectBosses:h,quickSelectError:x,setQuickSelectError:i,handleQuickSelectBoss:(f,a)=>{const k=Object.keys(o).length;if(o[f])if(o[f]===a){const d={...o};delete d[f],h(d)}else h({...o,[f]:a});else{if(k>=14){i("Maximum 14 bosses can be selected"),setTimeout(()=>i(""),3e3);return}h({...o,[f]:a})}i("")},applyQuickSelection:(f,a,k)=>{if(f===null||!a[f]){i("Please select a character first"),setTimeout(()=>i(""),3e3);return}let d=Object.entries(o).map(([c,S])=>({name:c,difficulty:S,partySize:1}));const n=180-a.reduce((c,S,p)=>p===f?c:c+(S.bosses?S.bosses.length:0),0);if(d.length>n){try{const c=require("../data/bossData"),S=c.bossData;d=d.map(p=>({...p,price:c.getBossPrice(S.find(g=>g.name===p.name),p.difficulty)||0})),d.sort((p,g)=>(g.price||0)-(p.price||0))}catch(c){console.error("Error loading boss data for price sorting:",c)}d=d.slice(0,n),i(`Selection trimmed to stay within 180 crystal limit. Added ${n} ${n===1?"boss":"bosses"}.`),setTimeout(()=>i(""),5e3)}k(f,d),h({}),d.length||i("")},resetQuickSelection:()=>{h({}),i("")}}}function Ne({onExport:o,onImport:h,onShowPresets:x,onShowQuickSelect:i,fileInputRef:u}){return e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"10px",marginBottom:"0.5rem",flexWrap:"wrap"},children:[e.jsx(L,{text:"Export all character data as a backup file",children:e.jsxs("button",{onClick:o,style:{background:"#805ad5",color:"#fff",border:"none",borderRadius:"6px",padding:"0.5rem 1.2rem",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",transform:"translateY(0)"},onMouseOver:t=>{t.currentTarget.style.background="#9f7aea",t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 16px rgba(128, 90, 213, 0.4)"},onMouseOut:t=>{t.currentTarget.style.background="#805ad5",t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="none"},children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"Backup Data"]})}),e.jsx(L,{text:"Import character data from a backup file",children:e.jsxs("button",{onClick:()=>{var t;return(t=u.current)==null?void 0:t.click()},style:{background:"#a259f7",color:"#fff",border:"none",borderRadius:"6px",padding:"0.5rem 1.2rem",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",transform:"translateY(0)"},onMouseOver:t=>{t.currentTarget.style.background="#b470ff",t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 16px rgba(162, 89, 247, 0.4)"},onMouseOut:t=>{t.currentTarget.style.background="#a259f7",t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="none"},children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),"Restore Backup"]})}),e.jsx(L,{text:"Create and manage boss configuration presets",children:e.jsxs("button",{onClick:x,style:{background:"#38a169",color:"#fff",border:"none",borderRadius:"6px",padding:"0.5rem 1.2rem",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",transform:"translateY(0)"},onMouseOver:t=>{t.currentTarget.style.background="#48bb78",t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 16px rgba(56, 161, 105, 0.4)"},onMouseOut:t=>{t.currentTarget.style.background="#38a169",t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="none"},children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),e.jsx("path",{d:"M20.4 14.5L16 10 4 20"})]}),"Presets"]})}),e.jsx(L,{text:"Quick select up to 14 bosses sorted by highest price",children:e.jsxs("button",{onClick:i,style:{background:"#f56565",color:"#fff",border:"none",borderRadius:"6px",padding:"0.5rem 1.2rem",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",transform:"translateY(0)"},onMouseOver:t=>{t.currentTarget.style.background="#fc8181",t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 16px rgba(245, 101, 101, 0.4)"},onMouseOut:t=>{t.currentTarget.style.background="#f56565",t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="none"},children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M9 11H1l6-6 6 6"}),e.jsx("path",{d:"M9 17l3-3 3 3"}),e.jsx("path",{d:"M22 18.5V2l-5 5-5-5v16.5"})]}),"Quick Select"]})}),e.jsx("input",{type:"file",ref:u,onChange:h,accept:".json",style:{display:"none"}})]})}function Pe({name:o,onSave:h}){const[x,i]=w.useState(!1),[u,t]=w.useState(o),[m,f]=w.useState(!1);return x?e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",marginLeft:0,marginRight:4},children:[e.jsx("input",{value:u,onChange:a=>t(a.target.value),style:{fontSize:"0.95em",borderRadius:8,border:m?"1px solid #a259f7":"1px solid #4a4370",padding:"4px 8px",marginRight:4,minWidth:80,maxWidth:120,background:"#3a335a",color:"#e6e0ff",boxShadow:m?"0 0 0 2px rgba(162, 89, 247, 0.3), 0 0 10px rgba(255, 255, 255, 0.15)":"none",transition:"all 0.25s ease",outline:"none"},autoFocus:!0,onFocus:()=>f(!0),onBlur:()=>f(!1),onKeyDown:a=>{a.key==="Enter"&&(h(u),i(!1)),a.key==="Escape"&&(i(!1),t(o))}}),e.jsx("button",{style:{background:"#a259f7",color:"#fff",border:"none",borderRadius:8,padding:"4px 8px",marginRight:4,cursor:"pointer",fontSize:"0.95em",boxShadow:"0 2px 6px rgba(162, 89, 247, 0.3)",transition:"all 0.2s ease"},onClick:()=>{h(u),i(!1)},title:"Save",onMouseOver:a=>{a.currentTarget.style.background="#b47aff",a.currentTarget.style.transform="translateY(-1px)"},onMouseOut:a=>{a.currentTarget.style.background="#a259f7",a.currentTarget.style.transform="translateY(0)"},children:"✔"}),e.jsx("button",{style:{background:"transparent",color:"#a259f7",border:"1px solid #a259f7",borderRadius:8,padding:"4px 8px",cursor:"pointer",fontSize:"0.95em",transition:"all 0.2s ease"},onClick:()=>{i(!1),t(o)},title:"Cancel",onMouseOver:a=>{a.currentTarget.style.background="rgba(162, 89, 247, 0.1)"},onMouseOut:a=>{a.currentTarget.style.background="transparent"},children:"✖"})]}):e.jsx("button",{className:"character-name-edit-btn",title:"Edit character name",onClick:()=>i(!0),style:{background:"transparent",border:"none",color:"rgb(167 142 196)",cursor:"pointer",padding:"4px",borderRadius:4},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32px",height:"32px",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M20.548 3.452a1.542 1.542 0 0 1 0 2.182l-7.636 7.636-3.273 1.091 1.091-3.273 7.636-7.636a1.542 1.542 0 0 1 2.182 0zM4 21h15a1 1 0 0 0 1-1v-8a1 1 0 0 0-2 0v7H5V6h7a1 1 0 0 0 0-2H4a1 1 0 0 0-1 1v15a1 1 0 0 0 1 1z"})})})}function Me({characterBossSelections:o,newCharName:h,setNewCharName:x,selectedCharIdx:i,cloneError:u,onCharacterChange:t,onAddCharacter:m,onUpdateCharacterName:f,onCloneCharacter:a,onRemoveCharacter:k,showCrystalCapError:d}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"character-creation-container",children:[e.jsx("input",{type:"text",value:h,onChange:l=>x(l.target.value),placeholder:"Character name",className:"character-name-input",onKeyDown:l=>l.key==="Enter"&&m()}),e.jsx("button",{onClick:m,disabled:!h.trim()||o.length>=te.CHARACTER_CAP,className:"add-character-button",children:"Add Character"})]}),o.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"character-management-row",children:[u&&e.jsx("div",{className:"clone-error-message",children:u}),i!==null&&o[i]&&e.jsx(Pe,{name:o[i].name,onSave:l=>f(i,l)}),e.jsxs("select",{value:i??"",onChange:t,className:"character-select-dropdown",children:[e.jsx("option",{value:"",children:"Select a Character"}),o.map((l,n)=>e.jsx("option",{value:n,children:l.name},n))]}),i!==null&&e.jsxs(e.Fragment,{children:[e.jsx(L,{text:"Clone this character (max 180 crystals)",children:e.jsx("button",{className:"boton-elegante clone",onClick:()=>a(i),children:"Clone"})}),e.jsx(L,{text:"Delete this character",children:e.jsx("button",{className:"boton-elegante delete",onClick:()=>k(i),children:"Delete"})})]})]}),i!==null&&o[i]&&e.jsx("div",{className:"crystals-counter-container",children:d?e.jsx("div",{className:"crystals-cap-error-text",children:"Cannot exceed 180 crystal limit"}):(()=>{const l=o.reduce((n,c)=>n+(c.bosses?c.bosses.length:0),0);return l===180?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"crystals-counter-main crystals-counter-max",children:e.jsx("span",{className:"crystals-counter-number-max",children:"180"})}),e.jsx("div",{className:"crystals-counter-label",children:"Total Crystals"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"crystals-counter-main",children:[e.jsx("span",{className:"crystals-counter-number",children:l}),e.jsx("span",{className:"crystals-counter-total",children:" / 180"})]}),e.jsx("div",{className:"crystals-counter-label",children:"Total Crystals"})]})})()})]})]})}function ze({selectedCharIdx:o,characterBossSelections:h,sortedBossData:x,getBossDifficulties:i,getAvailablePartySizes:u,onToggleBoss:t,onUpdatePartySize:m}){var f;return o===null||!h[o]?e.jsx("div",{className:"input-boss-empty-state",children:"Select a character to manage their bosses."}):e.jsx("div",{className:"input-boss-container",children:e.jsxs("div",{className:"input-boss-wrapper",children:[e.jsx("div",{className:"input-boss-header-container",children:e.jsx("table",{className:"input-boss-table input-boss-header",children:e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"input-boss-col-boss",children:"Boss"}),e.jsx("th",{className:"input-boss-col-difficulty",children:"Difficulty"}),e.jsx("th",{className:"input-boss-col-mesos",children:"Mesos"}),e.jsx("th",{className:"input-boss-col-controls",children:((f=h[o])==null?void 0:f.name)||"Selected Character"})]})})})}),e.jsx("div",{className:"input-boss-body-container",children:e.jsx("table",{className:"input-boss-table input-boss-body",children:e.jsx("tbody",{children:x.map((a,k)=>{var n;const d=i(a),l=(n=h[o])==null?void 0:n.bosses.find(c=>c.name===a.name);return e.jsxs("tr",{className:"input-boss-row",onClick:c=>{!c.target.closest("select")&&!c.target.closest(".checkbox-wrapper")&&!c.target.closest("input")&&(l?t(o,a.name,""):t(o,a.name,d[0]))},children:[e.jsxs("td",{className:"input-boss-cell-boss",children:[a.image&&e.jsx("img",{src:a.image,alt:a.name,loading:"lazy",className:"input-boss-img"}),e.jsx("span",{className:"input-boss-name",children:a.name})]}),e.jsx("td",{className:"input-boss-cell-difficulty",children:e.jsx("span",{className:"input-boss-difficulty-text",children:l?l.difficulty:""})}),e.jsx("td",{className:"input-boss-cell-mesos",children:e.jsx("span",{className:"input-boss-mesos-amount",children:l?Math.floor(I(a,l.difficulty)/(l.partySize||1)).toLocaleString():""})}),e.jsx("td",{className:"input-boss-cell-controls",children:e.jsxs("div",{className:"input-boss-controls",children:[e.jsx(Se,{checked:!!l,onChange:()=>{l?t(o,a.name,""):t(o,a.name,d[0])}}),l&&e.jsxs(e.Fragment,{children:[e.jsx("select",{className:"input-boss-difficulty-select",value:l.difficulty,onChange:c=>{t(o,a.name,c.target.value)},children:d.map(c=>e.jsx("option",{value:c,children:c},c))}),e.jsx("select",{className:"input-boss-party-select",value:l.partySize||1,onChange:c=>{m(o,a.name,l.difficulty,parseInt(c.target.value))},children:u(a.name,l.difficulty).map(c=>e.jsx("option",{value:c,children:c},c))})]})]})})]},k)})})})})]})})}function Be({show:o,onClose:h,presets:x,newPresetName:i,setNewPresetName:u,presetError:t,presetCreationMode:m,setPresetCreationMode:f,presetBosses:a,getSortedBossesByPrice:k,getBossDifficulties:d,formatPrice:l,handlePresetBossSelect:n,createPreset:c,applyPreset:S,deletePreset:p,selectedCharIdx:g,characterBossSelections:j}){return o?e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(40,32,74,0.95)",zIndex:4e3,display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(8px)"},onClick:h,children:e.jsxs("div",{className:"modal-fade",style:{background:"linear-gradient(145deg, #1a1730, #2d2540)",borderRadius:16,padding:"2.5rem",maxWidth:700,width:"90%",maxHeight:"90vh",overflowY:"auto",color:"#e6e0ff",boxShadow:"0 20px 60px rgba(0,0,0,0.4), 0 8px 32px rgba(162, 89, 247, 0.15)",position:"relative",border:"1px solid rgba(162, 89, 247, 0.2)"},onClick:r=>r.stopPropagation(),children:[e.jsx("button",{onClick:h,style:{position:"absolute",top:16,right:16,background:"transparent",color:"#fff",border:"none",fontSize:"1.5rem",cursor:"pointer",outline:"none",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",borderRadius:8},title:"Close",onMouseOver:r=>{r.currentTarget.style.background="rgba(255, 255, 255, 0.1)",r.currentTarget.style.color="#ff6b6b"},onMouseOut:r=>{r.currentTarget.style.background="transparent",r.currentTarget.style.color="#fff"},children:"×"}),e.jsx("div",{style:{width:80,height:80,background:"linear-gradient(135deg, #a259f7, #805ad5)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 24px",boxShadow:"0 8px 32px rgba(162, 89, 247, 0.4)"},children:e.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z",stroke:"#fff",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("h2",{style:{color:"#a259f7",fontWeight:700,marginBottom:8,fontSize:"1.8rem",textAlign:"center"},children:"Boss Presets"}),e.jsx("p",{style:{textAlign:"center",marginBottom:32,color:"#b39ddb",fontSize:"1rem"},children:"Create and manage your boss configuration presets"}),e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(162, 89, 247, 0.15), rgba(128, 90, 213, 0.1))",border:"2px solid rgba(162, 89, 247, 0.3)",borderRadius:16,padding:"24px",marginBottom:32},children:[e.jsx("h3",{style:{color:"#d6b4ff",marginBottom:20,fontSize:"1.3rem",fontWeight:700,textAlign:"center"},children:"Create New Preset"}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:20,background:"linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.05))",borderRadius:12,padding:6,border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("button",{onClick:()=>f(!1),style:{flex:1,background:m?"transparent":"linear-gradient(135deg, #a259f7, #805ad5)",color:m?"#d6b4ff":"#fff",border:"none",borderRadius:8,padding:"12px 16px",fontWeight:600,fontSize:"0.95rem",cursor:"pointer",transition:"all 0.2s ease",boxShadow:m?"none":"0 4px 16px rgba(162, 89, 247, 0.3)"},onMouseOver:r=>{m&&(r.currentTarget.style.background="rgba(162, 89, 247, 0.1)")},onMouseOut:r=>{m&&(r.currentTarget.style.background="transparent")},children:"From Current Character"}),e.jsx("button",{onClick:()=>f(!0),style:{flex:1,background:m?"linear-gradient(135deg, #a259f7, #805ad5)":"transparent",color:m?"#fff":"#d6b4ff",border:"none",borderRadius:8,padding:"12px 16px",fontWeight:600,fontSize:"0.95rem",cursor:"pointer",transition:"all 0.2s ease",boxShadow:m?"0 4px 16px rgba(162, 89, 247, 0.3)":"none"},onMouseOver:r=>{m||(r.currentTarget.style.background="rgba(162, 89, 247, 0.1)")},onMouseOut:r=>{m||(r.currentTarget.style.background="transparent")},children:"Manual Selection"})]}),m&&e.jsxs("div",{style:{marginBottom:20},children:[e.jsxs("div",{style:{marginBottom:16,textAlign:"center",padding:"12px",background:"linear-gradient(135deg, rgba(162, 89, 247, 0.1), rgba(128, 90, 213, 0.05))",borderRadius:8,border:"1px solid rgba(162, 89, 247, 0.2)"},children:[e.jsxs("div",{style:{fontSize:"1.2rem",fontWeight:700,color:"#a259f7",marginBottom:4},children:[Object.keys(a).length," bosses selected"]}),e.jsx("div",{style:{fontSize:"0.85rem",color:"#c4b5d4"},children:"Click on boss difficulties to add them to your preset"})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12,maxHeight:"250px",overflowY:"auto",padding:"8px"},children:k().map(r=>{const s=!!a[r.name],v=a[r.name],B=d(r);return e.jsxs("div",{style:{background:s?"linear-gradient(135deg, rgba(162, 89, 247, 0.2), rgba(128, 90, 213, 0.15))":"linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02))",borderRadius:10,padding:"12px",border:s?"2px solid rgba(162, 89, 247, 0.5)":"1px solid rgba(255, 255, 255, 0.1)",transition:"all 0.2s ease",boxShadow:s?"0 4px 16px rgba(162, 89, 247, 0.2)":"0 2px 8px rgba(0, 0, 0, 0.1)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:8,marginBottom:12},children:[r.image&&e.jsx("img",{src:r.image,alt:r.name,style:{width:32,height:32,objectFit:"contain",borderRadius:4,background:"#fff1"}}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontWeight:600,fontSize:"1rem",color:"#e6e0ff"},children:r.name}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"#b39ddb"},children:["Max: ",l(r.maxPrice)]})]})]}),e.jsx("div",{style:{display:"flex",gap:6,justifyContent:"center",flexWrap:"wrap"},children:B.map(C=>{const N=v===C,R=I(r,C);return e.jsxs("button",{onClick:()=>n(r.name,C),style:{background:N?"linear-gradient(135deg, #a259f7, #805ad5)":"linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.05))",color:N?"#fff":"#e6e0ff",border:N?"2px solid #a259f7":"2px solid rgba(255, 255, 255, 0.15)",borderRadius:6,padding:"8px 12px",cursor:"pointer",fontSize:"0.8rem",fontWeight:600,transition:"all 0.2s ease",minWidth:"80px",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"2px",boxShadow:N?"0 4px 16px rgba(162, 89, 247, 0.3)":"0 2px 8px rgba(0, 0, 0, 0.1)"},onMouseOver:P=>{N||(P.currentTarget.style.background="linear-gradient(135deg, rgba(162, 89, 247, 0.15), rgba(128, 90, 213, 0.1))",P.currentTarget.style.borderColor="rgba(162, 89, 247, 0.4)",P.currentTarget.style.transform="translateY(-1px)",P.currentTarget.style.boxShadow="0 4px 16px rgba(162, 89, 247, 0.2)")},onMouseOut:P=>{N||(P.currentTarget.style.background="linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.05))",P.currentTarget.style.borderColor="rgba(255, 255, 255, 0.15)",P.currentTarget.style.transform="translateY(0)",P.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.1)")},children:[e.jsx("div",{style:{fontSize:"0.85rem",fontWeight:700},children:C}),e.jsx("div",{style:{fontSize:"0.7rem",opacity:.9},children:l(R)})]},C)})})]},r.name)})})]}),e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("label",{style:{display:"block",marginBottom:8,color:"#d6b4ff",fontWeight:600,fontSize:"1rem"},children:"Preset Name"}),e.jsx("input",{type:"text",value:i,onChange:r=>u(r.target.value),placeholder:"Enter preset name...",style:{width:"100%",padding:"12px 16px",background:"linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.05))",border:"2px solid rgba(162, 89, 247, 0.3)",borderRadius:8,color:"#e6e0ff",fontSize:"1rem",outline:"none",transition:"all 0.25s ease",boxSizing:"border-box"},onFocus:r=>{r.currentTarget.style.borderColor="#a259f7",r.currentTarget.style.boxShadow="0 0 0 3px rgba(162, 89, 247, 0.15), 0 0 20px rgba(162, 89, 247, 0.1)"},onBlur:r=>{r.currentTarget.style.borderColor="rgba(162, 89, 247, 0.3)",r.currentTarget.style.boxShadow="none"}})]}),t&&e.jsx("div",{style:{color:"#ff6b6b",fontSize:"0.9rem",background:"rgba(255, 107, 107, 0.1)",border:"1px solid rgba(255, 107, 107, 0.3)",borderRadius:6,padding:"8px 12px",marginBottom:16,textAlign:"center"},children:t}),e.jsxs("button",{onClick:c,style:{width:"100%",background:"linear-gradient(135deg, #a259f7, #805ad5)",color:"#fff",border:"none",borderRadius:10,padding:"14px 20px",fontWeight:700,fontSize:"1.1rem",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 4px 16px rgba(162, 89, 247, 0.3)"},onMouseOver:r=>{r.currentTarget.style.background="linear-gradient(135deg, #b470ff, #9f7aea)",r.currentTarget.style.transform="translateY(-2px)",r.currentTarget.style.boxShadow="0 6px 20px rgba(162, 89, 247, 0.4)"},onMouseOut:r=>{r.currentTarget.style.background="linear-gradient(135deg, #a259f7, #805ad5)",r.currentTarget.style.transform="translateY(0)",r.currentTarget.style.boxShadow="0 4px 16px rgba(162, 89, 247, 0.3)"},children:[e.jsx("svg",{width:"20",height:"20",style:{marginRight:8,verticalAlign:"middle"},viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M12 4v16m8-8H4",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})}),"Create Preset"]})]}),e.jsxs("div",{children:[e.jsxs("h3",{style:{color:"#d6b4ff",marginBottom:20,fontSize:"1.3rem",fontWeight:700,textAlign:"center"},children:["Saved Presets (",x.length,")"]}),x.length===0?e.jsx("div",{style:{textAlign:"center",color:"#9d8bbc",fontSize:"1rem",padding:"40px 20px",background:"linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02))",borderRadius:12,border:"1px solid rgba(255, 255, 255, 0.1)"},children:"No presets saved yet. Create your first preset above!"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:x.map(r=>e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(162, 89, 247, 0.1), rgba(128, 90, 213, 0.05))",borderRadius:12,padding:"18px",border:"1px solid rgba(162, 89, 247, 0.2)",transition:"all 0.2s ease",boxShadow:"0 4px 16px rgba(162, 89, 247, 0.1)"},onMouseOver:s=>{s.currentTarget.style.background="linear-gradient(135deg, rgba(162, 89, 247, 0.15), rgba(128, 90, 213, 0.08))",s.currentTarget.style.borderColor="rgba(162, 89, 247, 0.3)",s.currentTarget.style.transform="translateY(-1px)",s.currentTarget.style.boxShadow="0 6px 20px rgba(162, 89, 247, 0.15)"},onMouseOut:s=>{s.currentTarget.style.background="linear-gradient(135deg, rgba(162, 89, 247, 0.1), rgba(128, 90, 213, 0.05))",s.currentTarget.style.borderColor="rgba(162, 89, 247, 0.2)",s.currentTarget.style.transform="translateY(0)",s.currentTarget.style.boxShadow="0 4px 16px rgba(162, 89, 247, 0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("h4",{style:{margin:0,color:"#e6e0ff",fontSize:"1.2rem",fontWeight:700},children:r.name}),e.jsx("button",{onClick:()=>p(r.id),style:{background:"linear-gradient(135deg, #ff6b6b, #ff5252)",color:"#fff",border:"none",borderRadius:6,width:32,height:32,cursor:"pointer",fontSize:"1.2rem",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(255, 107, 107, 0.3)"},title:"Delete preset",onMouseOver:s=>{s.currentTarget.style.background="linear-gradient(135deg, #ff8a80, #ff6b6b)",s.currentTarget.style.transform="scale(1.1)",s.currentTarget.style.boxShadow="0 4px 12px rgba(255, 107, 107, 0.4)"},onMouseOut:s=>{s.currentTarget.style.background="linear-gradient(135deg, #ff6b6b, #ff5252)",s.currentTarget.style.transform="scale(1)",s.currentTarget.style.boxShadow="0 2px 8px rgba(255, 107, 107, 0.3)"},children:"×"})]}),e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:e.jsxs("div",{style:{color:"#b39ddb",fontSize:"0.9rem"},children:[r.bosses.length," bosses • Created ",new Date(r.createdAt).toLocaleDateString()]})}),e.jsxs("button",{onClick:()=>S(r),disabled:g===null,style:{width:"100%",background:g===null?"linear-gradient(135deg, #555, #444)":"linear-gradient(135deg, #805ad5, #6b46c1)",color:"#fff",border:"none",borderRadius:8,padding:"12px 16px",fontWeight:600,fontSize:"1rem",cursor:g===null?"not-allowed":"pointer",opacity:g===null?.5:1,transition:"all 0.2s ease",boxShadow:g!==null?"0 4px 16px rgba(128, 90, 213, 0.3)":"none"},onMouseOver:s=>{g!==null&&(s.currentTarget.style.background="linear-gradient(135deg, #9f7aea, #805ad5)",s.currentTarget.style.transform="translateY(-1px)",s.currentTarget.style.boxShadow="0 6px 20px rgba(128, 90, 213, 0.4)")},onMouseOut:s=>{g!==null&&(s.currentTarget.style.background="linear-gradient(135deg, #805ad5, #6b46c1)",s.currentTarget.style.transform="translateY(0)",s.currentTarget.style.boxShadow="0 4px 16px rgba(128, 90, 213, 0.3)")},children:["Apply to ",g!==null&&j[g]?j[g].name:"Character"]})]},r.id))})]})]})}):null}function Oe({show:o,onClose:h,quickSelectBosses:x,quickSelectError:i,getSortedBossesByPrice:u,getBossDifficulties:t,formatPrice:m,handleQuickSelectBoss:f,applyQuickSelection:a,resetQuickSelection:k,selectedCharIdx:d,characterBossSelections:l}){return o?e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(40,32,74,0.95)",zIndex:4e3,display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(8px)"},onClick:h,children:e.jsxs("div",{className:"modal-fade",style:{background:"linear-gradient(145deg, #1a1730, #2d2540)",borderRadius:16,padding:"2rem",maxWidth:600,width:"90%",maxHeight:"90vh",overflowY:"auto",color:"#e6e0ff",boxShadow:"0 20px 60px rgba(0,0,0,0.4), 0 8px 32px rgba(162, 89, 247, 0.15)",position:"relative",border:"1px solid rgba(162, 89, 247, 0.2)"},onClick:n=>n.stopPropagation(),children:[e.jsx("button",{onClick:h,style:{position:"absolute",top:16,right:16,background:"transparent",color:"#fff",border:"none",fontSize:"1.5rem",cursor:"pointer",outline:"none",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",borderRadius:8},title:"Close",onMouseOver:n=>{n.currentTarget.style.background="rgba(255, 255, 255, 0.1)",n.currentTarget.style.color="#ff6b6b"},onMouseOut:n=>{n.currentTarget.style.background="transparent",n.currentTarget.style.color="#fff"},children:"×"}),e.jsx("div",{style:{width:80,height:80,background:"linear-gradient(135deg, #00d4aa, #01b4cc)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 24px",boxShadow:"0 8px 32px rgba(0, 212, 170, 0.3)"},children:e.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 12l2 2 4-4M21 12a9 9 0 11-18 0 9 9 0 0118 0z",stroke:"#fff",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("h2",{style:{color:"#00d4aa",fontWeight:700,marginBottom:8,fontSize:"1.8rem",textAlign:"center"},children:"Quick Boss Selection"}),e.jsx("p",{style:{textAlign:"center",marginBottom:24,color:"#b39ddb",fontSize:"1rem"},children:"Select up to 14 bosses sorted by highest price"}),e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(0, 212, 170, 0.15), rgba(1, 180, 204, 0.1))",border:"2px solid rgba(0, 212, 170, 0.3)",borderRadius:12,padding:"16px",marginBottom:24,textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"2rem",fontWeight:700,color:"#00d4aa",marginBottom:4},children:[Object.keys(x).length," / 14"]}),e.jsx("div",{style:{fontSize:"0.9rem",color:"#c4b5d4"},children:"Bosses Selected"})]}),i&&e.jsx("div",{style:{color:"#ff6b6b",fontSize:"0.9rem",background:"rgba(255, 107, 107, 0.1)",border:"1px solid rgba(255, 107, 107, 0.3)",borderRadius:6,padding:"8px 12px",marginBottom:16,textAlign:"center"},children:i}),e.jsx("div",{style:{marginBottom:24},children:e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:16,maxHeight:"400px",overflowY:"auto",padding:"8px"},children:u().map((n,c)=>{const S=!!x[n.name],p=x[n.name],g=t(n);return e.jsxs("div",{style:{background:S?"linear-gradient(135deg, rgba(0, 212, 170, 0.15), rgba(1, 180, 204, 0.1))":"linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02))",borderRadius:12,padding:"16px",border:S?"2px solid rgba(0, 212, 170, 0.4)":"1px solid rgba(255, 255, 255, 0.1)",transition:"all 0.2s ease",boxShadow:S?"0 4px 16px rgba(0, 212, 170, 0.2)":"0 2px 8px rgba(0, 0, 0, 0.1)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:12,marginBottom:16},children:[e.jsxs("div",{style:{fontSize:"0.9rem",fontWeight:700,color:"#00d4aa",minWidth:"28px",textAlign:"center"},children:["#",c+1]}),n.image&&e.jsx("img",{src:n.image,alt:n.name,style:{width:40,height:40,objectFit:"contain",borderRadius:6,background:"#fff1"}}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontWeight:600,fontSize:"1.1rem",color:"#e6e0ff"},children:n.name}),e.jsxs("div",{style:{fontSize:"0.85rem",color:"#b39ddb"},children:["Max: ",m(n.maxPrice)]})]})]}),e.jsx("div",{style:{display:"flex",gap:8,justifyContent:"center",flexWrap:"wrap"},children:g.map(j=>{const r=p===j,s=I(n,j);return e.jsxs("button",{onClick:()=>f(n.name,j),style:{background:r?"linear-gradient(135deg, #00d4aa, #01b4cc)":"linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.05))",color:r?"#fff":"#e6e0ff",border:r?"2px solid #00d4aa":"2px solid rgba(255, 255, 255, 0.15)",borderRadius:8,padding:"12px 20px",cursor:"pointer",fontSize:"0.95rem",fontWeight:600,transition:"all 0.2s ease",minWidth:"120px",minHeight:"50px",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"4px",boxShadow:r?"0 4px 16px rgba(0, 212, 170, 0.3)":"0 2px 8px rgba(0, 0, 0, 0.1)"},onMouseOver:v=>{r||(v.currentTarget.style.background="linear-gradient(135deg, rgba(0, 212, 170, 0.15), rgba(1, 180, 204, 0.1))",v.currentTarget.style.borderColor="rgba(0, 212, 170, 0.4)",v.currentTarget.style.transform="translateY(-1px)",v.currentTarget.style.boxShadow="0 4px 16px rgba(0, 212, 170, 0.2)")},onMouseOut:v=>{r||(v.currentTarget.style.background="linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.05))",v.currentTarget.style.borderColor="rgba(255, 255, 255, 0.15)",v.currentTarget.style.transform="translateY(0)",v.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.1)")},children:[e.jsx("div",{style:{fontSize:"1rem",fontWeight:700},children:j}),e.jsx("div",{style:{fontSize:"0.8rem",opacity:.9},children:m(s)})]},j)})})]},n.name)})})}),e.jsxs("div",{style:{display:"flex",gap:16,justifyContent:"center"},children:[e.jsx("button",{onClick:k,style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05))",color:"#e6e0ff",border:"2px solid rgba(255, 255, 255, 0.2)",borderRadius:12,padding:"0.8rem 2rem",fontWeight:700,fontSize:"1.1rem",cursor:"pointer",transition:"all 0.2s ease",minWidth:140},onMouseOver:n=>{n.currentTarget.style.background="linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.08))",n.currentTarget.style.borderColor="rgba(255, 255, 255, 0.3)",n.currentTarget.style.transform="translateY(-1px)"},onMouseOut:n=>{n.currentTarget.style.background="linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05))",n.currentTarget.style.borderColor="rgba(255, 255, 255, 0.2)",n.currentTarget.style.transform="translateY(0)"},children:"Clear All"}),e.jsxs("button",{onClick:a,disabled:Object.keys(x).length===0||d===null,style:{background:Object.keys(x).length===0||d===null?"linear-gradient(135deg, #555, #444)":"linear-gradient(135deg, #00d4aa, #01b4cc)",color:"#fff",border:"none",borderRadius:12,padding:"0.8rem 2rem",fontWeight:700,fontSize:"1.1rem",cursor:Object.keys(x).length===0||d===null?"not-allowed":"pointer",opacity:Object.keys(x).length===0||d===null?.5:1,minWidth:140,transition:"all 0.2s ease",boxShadow:Object.keys(x).length>0&&d!==null?"0 4px 16px rgba(0, 212, 170, 0.3)":"none"},onMouseOver:n=>{Object.keys(x).length>0&&d!==null&&(n.currentTarget.style.background="linear-gradient(135deg, #00e6c0, #01c8de)",n.currentTarget.style.transform="translateY(-1px)",n.currentTarget.style.boxShadow="0 6px 20px rgba(0, 212, 170, 0.4)")},onMouseOut:n=>{Object.keys(x).length>0&&d!==null&&(n.currentTarget.style.background="linear-gradient(135deg, #00d4aa, #01b4cc)",n.currentTarget.style.transform="translateY(0)",n.currentTarget.style.boxShadow="0 4px 16px rgba(0, 212, 170, 0.3)")},children:["Apply to ",d!==null&&l[d]?l[d].name:"Character"]})]}),d===null&&e.jsx("div",{style:{textAlign:"center",marginTop:12,fontSize:"0.85rem",color:"#9d8bbc"},children:"Please select a character first to apply the boss selection"})]})}):null}w.lazy(()=>_(()=>import("./DataBackup-DCaK8fIJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])));function _e(){const{navigate:o}=we(),{userCode:h,isLoggedIn:x,handleDeleteAccount:i}=fe(),{characterBossSelections:u,setCharacterBossSelections:t,newCharName:m,setNewCharName:f,selectedCharIdx:a,error:k,cloneError:d,setCloneError:l,showUndo:n,undoData:c,fileInputRef:S,importError:p,setImportError:g,importSuccess:j,setImportSuccess:r,sortedBossData:s,getAvailablePartySizes:v,getBossDifficulties:B,handleCharacterChange:C,addCharacter:N,removeCharacter:R,handleUndo:P,toggleBoss:re,updateCharacterName:ae,updatePartySize:ne,batchSetBosses:H,showCrystalCapError:se}=ye(),[oe,U]=w.useState(!1),[ie,Q]=w.useState(!1),[G,V]=w.useState(""),[F,q]=w.useState(!1),[le,$]=w.useState(!1),[ce,J]=w.useState(!1),T=Te(),D=Ce();w.useEffect(()=>{x||o("/login",{replace:!0})},[x,o]);const de=async()=>{try{const{exportUserData:y}=await _(async()=>{const{exportUserData:M}=await import("./pitched-data-service-CcBFTTM6.js");return{exportUserData:M}},__vite__mapDeps([4,5,3,6,7,1,2,8])),b=await y(h);if(b.success){const M=JSON.stringify(b.data,null,2),A=new Blob([M],{type:"application/json"}),O=URL.createObjectURL(A),W=document.createElement("a");W.href=O,W.download=`maplestory-boss-calc-backup-${new Date().toISOString().split("T")[0]}.json`,W.click(),URL.revokeObjectURL(O),r(!0),setTimeout(()=>r(!1),3e3)}else throw new Error(b.error)}catch(y){console.error("Export error:",y),g("Failed to export data. Please try again."),setTimeout(()=>g(""),5e3)}},ge=async y=>{const b=y.target.files[0];if(!b)return;const M=new FileReader;M.onload=async A=>{try{const O=JSON.parse(A.target.result),{importUserData:W}=await _(async()=>{const{importUserData:z}=await import("./pitched-data-service-CcBFTTM6.js");return{importUserData:z}},__vite__mapDeps([4,5,3,6,7,1,2,8])),Y=await W(h,O);if(!Y.success)throw new Error(Y.error);r(!0),setTimeout(()=>{r(!1),window.location.reload()},2e3)}catch(O){console.error("Import error:",O),g(O.message||"Invalid data file. Please check the format and try again."),setTimeout(()=>g(""),5e3)}},M.readAsText(b)},ue=async y=>{if(u.length>=te.CHARACTER_CAP){l("Cannot clone: Maximum character limit reached"),setTimeout(()=>l(""),3e3);return}const b=u[y];if(!b){console.error("🔄 CLONE: Character to clone not found at index:",y);return}const M=u.reduce((z,E)=>z+(E.bosses?E.bosses.length:0),0),A=b.bosses?b.bosses.length:0;if(M+A>180){l("Cannot clone: Would exceed 180 crystal limit"),setTimeout(()=>l(""),3e3);return}const O=u.length>0?Math.max(...u.map(z=>z.index||0))+1:0,W={...b,name:`${b.name} (Copy)`,index:O,bosses:[...b.bosses||[]]},Y=[...u,W];t(Y);try{const{supabase:z}=await _(async()=>{const{supabase:me}=await import("./supabaseClient-D8oTKsok.js");return{supabase:me}},__vite__mapDeps([9,5,3])),{data:E,error:K}=await z.from("user_data").select("data").eq("id",h).single();if(K&&K.code!=="PGRST116")throw K;const be={...(E==null?void 0:E.data)||{},characterBossSelections:Y,lastUpdated:new Date().toISOString()},{error:ee}=await z.from("user_data").update({data:be}).eq("id",h);if(ee)throw ee;console.log("✅ CLONE: Character successfully cloned and saved to database")}catch(z){console.error("❌ CLONE: Error saving cloned character to database:",z),l("Failed to save cloned character to database"),setTimeout(()=>l(""),3e3),t(u)}},pe=async()=>{q(!0),V("");try{const y=await i();y.success?(Q(!1),o("/login",{replace:!0})):V(y.error)}catch(y){V("Failed to delete account. Try again."),console.error("Delete error:",y)}finally{q(!1)}},X=()=>ke.map(b=>{const M=Math.max(...b.difficulties.map(A=>A.price));return{...b,maxPrice:M}}).sort((b,M)=>M.maxPrice-b.maxPrice),Z=y=>{if(y>=1e9){const b=y/1e9;return b>=10?`${Math.round(b)}B`:`${b.toFixed(1)}B`}else if(y>=1e6){const b=y/1e6;return b>=10?`${Math.round(b)}M`:`${b.toFixed(1)}M`}else if(y>=1e3){const b=y/1e3;return b>=10?`${Math.round(b)}K`:`${b.toFixed(1)}K`}else return y.toString()},xe=()=>{$(!1),T.setNewPresetName(""),T.setPresetError(""),T.setPresetCreationMode(!1),T.setPresetBosses({})},he=()=>{J(!1),D.setQuickSelectBosses({}),D.setQuickSelectError("")};return e.jsxs("div",{className:"page-container",children:[e.jsx(ve,{currentPage:"calculator",onShowHelp:()=>U(!0),onShowDeleteConfirm:()=>Q(!0)}),e.jsxs("div",{className:"page-header-container fade-in",children:[e.jsx("h1",{className:"page-title-main",children:"Character and Boss Configuration"}),e.jsx("p",{className:"page-description",children:"Create characters, configure boss difficulties and party sizes for your weekly runs"}),e.jsx(Ne,{onExport:de,onImport:ge,onShowPresets:()=>$(!0),onShowQuickSelect:()=>J(!0),fileInputRef:S})]}),p&&e.jsx("div",{className:"error-message-container",children:p}),j&&e.jsx("div",{className:"success-message-container",children:"Data backup operation successful!"}),e.jsx(je,{children:e.jsxs("div",{className:"table-container premium-content-container input-page-container fade-in",children:[e.jsx(Me,{characterBossSelections:u,newCharName:m,setNewCharName:f,selectedCharIdx:a,cloneError:d,onCharacterChange:C,onAddCharacter:N,onUpdateCharacterName:ae,onCloneCharacter:ue,onRemoveCharacter:R,showCrystalCapError:se}),u.length===0?e.jsxs("div",{className:"empty-state-message",children:[e.jsx("span",{role:"img","aria-label":"sparkles",children:"✨"})," Welcome! Add your first character to get started."]}):e.jsx(ze,{selectedCharIdx:a,characterBossSelections:u,sortedBossData:s,getBossDifficulties:B,getAvailablePartySizes:v,onToggleBoss:re,onUpdatePartySize:ne})]})}),n&&c&&e.jsxs("div",{className:"undo-snackbar",children:["Character deleted.",e.jsx("button",{onClick:P,className:"undo-btn",children:"Undo"})]}),oe&&e.jsx("div",{className:"modal-backdrop",onClick:()=>U(!1),children:e.jsxs("div",{className:"modal-fade modal-content",onClick:y=>y.stopPropagation(),children:[e.jsx("button",{onClick:()=>U(!1),className:"modal-close-btn",title:"Close",children:"×"}),e.jsx("h2",{className:"modal-title",children:"Help & FAQ"}),e.jsxs("div",{className:"modal-section-content",style:{marginBottom:24},children:[e.jsx("h3",{className:"modal-section-title",children:"Getting Started"}),e.jsx("p",{children:"1. Create an account or log in with your existing code"}),e.jsx("p",{children:"2. Add characters using the input field at the top"}),e.jsx("p",{children:"3. Select a character and choose their bosses & difficulties"}),e.jsx("p",{children:"4. Head to Weekly Tracker to mark completions and track pitched items!"})]}),e.jsxs("div",{className:"modal-section-content",style:{marginBottom:24},children:[e.jsx("h3",{className:"modal-section-title",children:"Boss Selection"}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Smart presets:"})," Use Quick Select or save custom presets for easy setup"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Party sizes:"})," Adjust party size for each boss to calculate split mesos"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Clone characters:"})," Copy a character's entire boss setup instantly"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Difficulty matters:"})," Higher difficulties = more mesos and pitched items"]})]}),e.jsxs("div",{className:"modal-section-content",style:{marginBottom:24},children:[e.jsx("h3",{className:"modal-section-title",children:"Data Management"}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Auto-save:"})," All changes are automatically saved to the cloud"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Export/Import:"})," Backup your data or transfer between devices"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Smart cleanup:"})," Changing boss selections automatically cleans up old tracking data"]})]}),e.jsxs("div",{className:"modal-section-content",children:[e.jsx("h3",{className:"modal-section-title",children:"Quick Tips"}),e.jsx("p",{children:"• Click anywhere on a boss row to toggle selection"}),e.jsx("p",{children:"• Use presets to quickly set up multiple characters with similar boss lists"}),e.jsx("p",{children:"• Your account code is your login - keep it safe!"}),e.jsx("p",{children:"• Check out the Boss Table page to see which bosses give the most mesos"})]})]})}),ie&&e.jsx("div",{className:"modal-backdrop modal-backdrop-critical",onClick:()=>Q(!1),children:e.jsxs("div",{className:"modal-fade modal-content-critical",onClick:y=>y.stopPropagation(),children:[e.jsx("div",{className:"critical-modal-icon",children:e.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z",stroke:"#fff",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("h2",{className:"critical-modal-title",children:"Delete Account"}),e.jsx("div",{className:"critical-modal-warning",children:e.jsxs("p",{children:[e.jsx("strong",{children:"This will permanently delete your account and all associated data."}),e.jsx("br",{}),"This action cannot be undone."]})}),e.jsxs("div",{className:"modal-button-container",children:[e.jsx("button",{onClick:()=>Q(!1),disabled:F,className:"modal-btn-cancel",children:"Cancel"}),e.jsxs("button",{onClick:pe,disabled:F,className:"modal-btn-critical",children:[F&&e.jsx("div",{className:"loading-spinner"}),F?"Deleting...":"Delete Forever"]})]}),G&&e.jsx("div",{className:"modal-error-message",children:G})]})}),e.jsx(Be,{show:le,onClose:xe,presets:T.presets,newPresetName:T.newPresetName,setNewPresetName:T.setNewPresetName,presetError:T.presetError,presetCreationMode:T.presetCreationMode,setPresetCreationMode:T.setPresetCreationMode,presetBosses:T.presetBosses,getSortedBossesByPrice:X,getBossDifficulties:B,formatPrice:Z,handlePresetBossSelect:T.handlePresetBossSelect,createPreset:()=>T.createPreset(a,u,H),applyPreset:y=>{T.applyPreset(y,a,u,H),$(!1)},deletePreset:T.deletePreset,selectedCharIdx:a,characterBossSelections:u}),e.jsx(Oe,{show:ce,onClose:he,quickSelectBosses:D.quickSelectBosses,quickSelectError:D.quickSelectError,getSortedBossesByPrice:X,getBossDifficulties:B,formatPrice:Z,handleQuickSelectBoss:D.handleQuickSelectBoss,applyQuickSelection:()=>{D.applyQuickSelection(a,u,H),J(!1)},resetQuickSelection:D.resetQuickSelection,selectedCharIdx:a,characterBossSelections:u}),e.jsx("style",{jsx:!0,children:`
        @keyframes modalFadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        @keyframes modalSlideIn {
          from {
            opacity: 0;
            transform: scale(0.8) translateY(20px);
          }
          to {
            opacity: 1;
            transform: scale(1) translateY(0);
          }
        }

        .crystal-cap-error-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100vw;
          height: 100vh;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 3000;
          pointer-events: none;
        }
        .crystal-cap-error-message {
          background: rgba(40, 32, 74, 0.97);
          color: #fff;
          font-size: 1.25rem;
          font-weight: 600;
          border-radius: 16px;
          box-shadow: 0 4px 32px rgba(128,90,213,0.18);
          padding: 1.5rem 2.5rem;
          border: 1.5px solid #a259f7;
          text-align: center;
          animation: modalFadeIn 0.3s cubic-bezier(.4,2,.6,1);
          letter-spacing: 0.5px;
        }
      `})]})}export{_e as default};
