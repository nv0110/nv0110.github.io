const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/bossRegistryService-DdojBl0l.js","assets/vendor-supabase-B7S7y5aO.js","assets/vendor-react-eWEExxYH.js","assets/index-Burs8Qkg.js","assets/vendor-ui-aK89YfOw.js","assets/vendor-router-Cg8TMqY4.js","assets/index-Dihw36uI.css"])))=>i.map(i=>d[i]);
import{_ as w}from"./vendor-supabase-B7S7y5aO.js";import{j as s}from"./vendor-ui-aK89YfOw.js";import{r}from"./vendor-router-Cg8TMqY4.js";import{a as y,u as S,l,N as T,V as A,H as P,B as C,D as E}from"./index-Burs8Qkg.js";import"./vendor-react-eWEExxYH.js";function V(){y();const{isLoggedIn:o,handleDeleteAccount:p}=S(),[g,f]=r.useState(!1),[h,t]=r.useState(!1),[m,c]=r.useState(""),[x,u]=r.useState(!1),[j,i]=r.useState([]),[D,n]=r.useState(!0);if(r.useEffect(()=>{if(!o){l.debug("BossTablePage: Skipping boss data load - user not logged in"),n(!1),i([]);return}let e=!0,a=new AbortController;return(async()=>{if(!o||a.signal.aborted){l.debug("BossTablePage: Aborting boss data load - auth state invalid");return}try{if(n(!0),!o||a.signal.aborted){l.debug("BossTablePage: Aborting before service import");return}const{getBossDataForFrontend:d}=await w(async()=>{const{getBossDataForFrontend:B}=await import("./bossRegistryService-DdojBl0l.js");return{getBossDataForFrontend:B}},__vite__mapDeps([0,1,2,3,4,5,6]));if(!o||a.signal.aborted||!e){l.debug("BossTablePage: Aborting before API call");return}const b=await d();if(!o||a.signal.aborted||!e){l.debug("BossTablePage: Aborting before processing result");return}b.success?i(b.data):(console.error("Failed to load boss data:",b.error),i([]))}catch(d){!a.signal.aborted&&o&&e&&(console.error("Error loading boss data:",d),i([]))}finally{e&&o&&!a.signal.aborted&&n(!1)}})(),()=>{e=!1,a.abort()}},[o]),!o)return null;const N=async()=>{u(!0),c("");try{const e=await p();e.success?t(!1):c(e.error)}catch(e){c("Failed to delete account. Try again."),console.error("Delete error:",e)}finally{u(!1)}},v=j.flatMap(e=>e.difficulties.map(a=>({boss:e,difficulty:a.difficulty,price:a.price}))).sort((e,a)=>a.price-e.price);return s.jsxs("div",{className:"boss-price-page",children:[s.jsx(T,{currentPage:"bosstable",onShowHelp:()=>f(!0),onShowDeleteConfirm:()=>t(!0)}),s.jsx(A,{children:s.jsxs("div",{className:"boss-price-main fade-in",children:[s.jsx("div",{className:"boss-price-header",children:s.jsx("h2",{className:"boss-price-title",children:"Boss Crystal Price Table"})}),s.jsx("div",{className:"boss-price-container",children:s.jsxs("div",{className:"boss-price-grid",children:[s.jsxs("div",{className:"boss-price-header-row",children:[s.jsx("div",{className:"boss-price-header-cell boss-col",children:"Boss"}),s.jsx("div",{className:"boss-price-header-cell difficulty-col",children:"Difficulty"}),s.jsx("div",{className:"boss-price-header-cell price-col",children:"Mesos"})]}),D?s.jsx("div",{className:"boss-price-loading",children:"Loading boss data..."}):v.map((e,a)=>s.jsxs("div",{className:`boss-price-row ${a%2===0?"even":"odd"}`,children:[s.jsx("div",{className:"boss-price-cell boss-col",children:s.jsxs("div",{className:"boss-price-info",children:[e.boss.image&&s.jsx("img",{src:e.boss.image,alt:e.boss.name,className:"boss-price-image"}),s.jsx("span",{className:"boss-price-name",children:e.boss.name})]})}),s.jsx("div",{className:"boss-price-cell difficulty-col",children:s.jsx("span",{className:"boss-price-difficulty",children:e.difficulty})}),s.jsx("div",{className:"boss-price-cell price-col",children:s.jsx("span",{className:"boss-price-mesos",children:e.price.toLocaleString()})})]},`${e.boss.name}-${e.difficulty}`))]})})]})}),s.jsx(P,{showHelp:g,onClose:()=>f(!1),children:s.jsx(C,{})}),s.jsx(E,{showDeleteConfirm:h,onClose:()=>t(!1),onConfirm:N,showDeleteLoading:x,deleteError:m})]})}export{V as default};
