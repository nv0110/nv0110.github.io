const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DataBackup-C9GJmutq.js","assets/vendor-ui-aK89YfOw.js","assets/vendor-router-Cg8TMqY4.js","assets/vendor-react-eWEExxYH.js","assets/utilityService-BJZ4H6vw.js","assets/vendor-supabase-B7S7y5aO.js","assets/index-H-SBb4Tt.js","assets/index-BW-6mlRk.css"])))=>i.map(i=>d[i]);
import{_ as ce}from"./vendor-supabase-B7S7y5aO.js";import{j as e}from"./vendor-ui-aK89YfOw.js";import{r as x}from"./vendor-router-Cg8TMqY4.js";import{l as H,L as J,a as ne,u as le,b as oe,N as de,V as he}from"./index-H-SBb4Tt.js";import{getBossPrice as se}from"./bossRegistryService-DazprdXz.js";import{C as ue}from"./CustomCheckbox-C2-rm8qf.js";import"./vendor-react-eWEExxYH.js";function me(){const[a,r]=x.useState({}),[l,P]=x.useState({}),[A,o]=x.useState("");return{quickSelectBosses:a,setQuickSelectBosses:r,lastQuickSelectBosses:l,quickSelectError:A,setQuickSelectError:o,handleQuickSelectBoss:(n,j,h=1)=>{const p=Object.keys(a).length;if(a[n])if(a[n].difficulty===j){const g={...a};delete g[n],r(g)}else r({...a,[n]:{difficulty:j,partySize:a[n].partySize||h}});else{if(p>=14){o("Maximum 14 bosses can be selected"),setTimeout(()=>o(""),3e3);return}r({...a,[n]:{difficulty:j,partySize:h}})}o("")},updateQuickSelectPartySize:(n,j)=>{a[n]&&r({...a,[n]:{...a[n],partySize:j}})},reuseLastQuickSelect:()=>{if(Object.keys(l).length===0){o("No previous quick select settings to reuse"),setTimeout(()=>o(""),3e3);return}H.info("QuickSelect: Reusing last quick select settings",{bossCount:Object.keys(l).length,bosses:Object.keys(l)}),r({...l}),o("")},applyQuickSelection:(n,j,h)=>{if(n===null||!j[n]){o("Please select a character first"),setTimeout(()=>o(""),3e3);return}Object.keys(a).length>0&&(P({...a}),H.info("QuickSelect: Storing selection for reuse",{bossCount:Object.keys(a).length}));let p=Object.entries(a).map(([b,f])=>({name:b,difficulty:f.difficulty,partySize:f.partySize||1}));const N=180-j.reduce((b,f,C)=>C===n?b:b+(f.bosses?f.bosses.length:0),0);if(p.length>N){try{const b=require("../data/bossData"),f=b.bossData;p=p.map(C=>({...C,price:b.getBossPrice(f.find(T=>T.name===C.name),C.difficulty)||0})),p.sort((C,T)=>(T.price||0)-(C.price||0))}catch(b){H.error("Error loading boss data for price sorting:",b)}p=p.slice(0,N),o(`Selection trimmed to stay within 180 crystal limit. Added ${N} ${N===1?"boss":"bosses"}.`),setTimeout(()=>o(""),5e3)}h(n,p),r({}),p.length||o("")},resetQuickSelection:()=>{r({}),o("")}}}function pe({show:a,onClose:r,quickSelectBosses:l,quickSelectError:P,getSortedBossesByPrice:A,getBossDifficulties:o,formatPrice:d,handleQuickSelectBoss:v,updateQuickSelectPartySize:L,applyQuickSelection:$,resetQuickSelection:Q,reuseLastQuickSelect:n,lastQuickSelectBosses:j,selectedCharIdx:h,characterBossSelections:p}){var O;const[g,N]=x.useState({show:!1,boss:null,difficulty:null}),[b,f]=x.useState(!1),[C,T]=x.useState(0),E=Object.keys(l).length;if(x.useEffect(()=>{E===14&&C<14?f(!0):E<14&&f(!1),T(E)},[E,C]),x.useEffect(()=>{a?(f(E===14),T(E)):f(!1)},[a,E]),!a)return null;const V=()=>{$(),f(!1)},_=()=>{f(!1)},W=s=>{s.target.classList.contains("quick-select-instant-apply")&&f(!1)},c=(s,y)=>{R(s)===y?v(s,null):v(s,y)},u=(s,y)=>{if(y.target.closest(".quick-select-difficulty-option")||y.target.closest(".quick-select-party-indicator"))return;const B=s.name,K=R(B),S=o(s).sort((F,D)=>{const I=se(s,F);return se(s,D)-I});if(!K)v(B,S[0]);else{const F=S.indexOf(K);F===-1?v(B,S[0]):F===S.length-1?v(B,null):v(B,S[F+1])}},t=(s,y)=>{N({show:!0,boss:s,difficulty:y})},i=s=>{const{boss:y}=g;L(y.name,s)},m=()=>{N({show:!1,boss:null,difficulty:null})},q=()=>{N({show:!1,boss:null,difficulty:null})},M=s=>[1,2,3,4,5,6],z=s=>{var y;return((y=l[s])==null?void 0:y.partySize)||1},R=s=>{var y;return(y=l[s])==null?void 0:y.difficulty};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"quick-select-overlay",onClick:r,children:e.jsxs("div",{className:"quick-select-modal",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{onClick:r,className:"quick-select-close-btn",title:"Close",children:"×"}),e.jsxs("div",{className:"quick-select-header",children:[e.jsx("h1",{className:"quick-select-title",children:"Quick Boss Selection"}),e.jsx("p",{className:"quick-select-subtitle",children:"Select up to 14 bosses • Click cards to cycle difficulties • Click party size to adjust"})]}),e.jsxs("div",{className:"quick-select-progress",style:{"--progress-width":`${E/14*100}%`},children:[e.jsx("div",{className:"quick-select-progress-bar"}),e.jsxs("div",{className:"quick-select-progress-content",children:[e.jsx("div",{className:`quick-select-count ${E===14?"complete":"partial"}`,children:E}),e.jsx("div",{className:"quick-select-total",children:"/ 14"})]}),e.jsx("div",{className:"quick-select-label",children:"Bosses Selected"})]}),P&&e.jsx("div",{className:"quick-select-error",children:P}),e.jsx("div",{className:"quick-select-grid",children:A().map((s,y)=>{const B=!!l[s.name],K=R(s.name),Z=o(s),S=z(s.name),F=Z.sort((D,I)=>{const G=se(s,D);return se(s,I)-G});return e.jsxs("div",{className:`quick-select-boss-card ${B?"selected":"unselected"}`,onClick:D=>u(s,D),style:{cursor:"pointer"},title:B?"Click to cycle through difficulties or unselect":"Click to select with highest difficulty",children:[B&&e.jsx("div",{className:"quick-select-party-indicator",onClick:D=>{D.stopPropagation(),t(s,K)},title:`Party Size: ${S}`,children:S}),e.jsxs("div",{className:"quick-select-boss-info",children:[s.image&&e.jsx("div",{className:"quick-select-boss-image",children:e.jsx("img",{src:s.image,alt:s.name})}),e.jsxs("div",{className:"quick-select-boss-details",children:[e.jsx("div",{className:"quick-select-boss-name",children:s.name}),e.jsxs("div",{className:"quick-select-boss-price",children:["Max: ",d(s.maxPrice)]})]})]}),e.jsxs("div",{className:"quick-select-difficulties",children:[e.jsx("div",{className:"quick-select-difficulty-label",children:"Choose Difficulty"}),e.jsx("div",{className:"quick-select-difficulty-inline",children:F.map((D,I)=>{const G=K===D;se(s,D);const X=I===0;return e.jsx("button",{onClick:te=>{te.stopPropagation(),c(s.name,D)},className:`quick-select-difficulty-option ${G?"selected":""} ${X?"most-expensive":""}`,children:e.jsx("span",{className:"difficulty-text",children:D})},D)})})]})]},s.name)})}),e.jsxs("div",{className:"quick-select-actions",children:[e.jsx("button",{onClick:Q,className:"quick-select-action-btn quick-select-clear-btn",children:"Clear All"}),e.jsxs("button",{onClick:n,disabled:Object.keys(j).length===0,className:`quick-select-action-btn quick-select-reuse-btn ${Object.keys(j).length===0?"disabled":"enabled"}`,title:"Reuse last quick select settings",children:[e.jsxs("svg",{className:"quick-select-reuse-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 12a9 9 0 11-6.219-8.56"}),e.jsx("path",{d:"M15 4.5l.5-.5L16 3h-4v4l1-1"}),e.jsx("path",{d:"M12 8v4l3 3"})]}),"Reuse Last"]}),e.jsxs("button",{onClick:$,disabled:E===0||h===null,className:`quick-select-action-btn quick-select-apply-btn ${E===0||h===null?"disabled":"enabled"}`,children:["Apply to ",h!==null&&p[h]?p[h].name:"Character"]})]}),h===null&&e.jsx("div",{className:"quick-select-helper",children:"Please select a character first to apply the boss selection"}),b&&h!==null&&e.jsx("div",{className:`quick-select-instant-apply ${b?"show":""}`,onClick:W,children:e.jsxs("div",{className:"quick-select-instant-apply-content",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"quick-select-instant-apply-icon",children:"🎉"}),e.jsx("div",{className:"quick-select-instant-apply-title",children:"Perfect Selection!"}),e.jsx("div",{className:"quick-select-instant-apply-subtitle",children:"You've selected 14 bosses - ready to apply?"}),e.jsxs("div",{className:"quick-select-instant-apply-actions",children:[e.jsx("button",{onClick:V,className:"quick-select-instant-apply-btn primary",children:"Apply Now"}),e.jsx("button",{onClick:_,className:"quick-select-instant-apply-btn secondary",children:"Keep Selecting"})]})]})})]})}),g.show&&e.jsx("div",{className:"party-size-modal-overlay",onClick:q,children:e.jsxs("div",{className:"party-size-modal",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"party-size-modal-title",children:"Party Size"}),e.jsxs("div",{className:"party-size-modal-subtitle",children:["Select party size for ",(O=g.boss)==null?void 0:O.name]}),e.jsx("div",{className:"party-size-options",children:M(g.boss).map(s=>{var y;return e.jsx("button",{onClick:()=>i(s),className:`party-size-option ${z((y=g.boss)==null?void 0:y.name)===s?"selected":""}`,children:s},s)})}),e.jsxs("div",{className:"party-size-modal-actions",children:[e.jsx("button",{onClick:m,className:"party-size-modal-btn primary",children:"Confirm"}),e.jsx("button",{onClick:q,className:"party-size-modal-btn secondary",children:"Cancel"})]})]})})]})}function fe(){return e.jsx("div",{className:"page-loader",children:e.jsx("div",{className:"loading-spinner"})})}function xe({characterBossSelections:a,selectedCharIdx:r,onCharacterChange:l,onRemoveCharacter:P,onCopyCharacter:A,onEditCharacterName:o}){const[d,v]=x.useState(!1),[L,$]=x.useState(!1),[Q,n]=x.useState(!1),[j,h]=x.useState(""),p=x.useRef(null),g=x.useRef(null);x.useEffect(()=>{const t=i=>{p.current&&!p.current.contains(i.target)&&v(!1)};if(d)return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[d]),x.useEffect(()=>{const t=i=>{i.key==="Escape"&&v(!1)};if(d)return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[d]);const N=t=>{l({target:{value:t}}),v(!1)},b=(t,i)=>{var m;t.stopPropagation(),H.info("Deleting character:",(m=a[i])==null?void 0:m.name),P(i)},f=async()=>{if(!(L||!a[r])){$(!0);try{const t=a[r].name,i=a.map(z=>z.name);let m=1,q=`${t}-${m}`;for(;i.includes(q);)m++,q=`${t}-${m}`;const M=await A(r,q);M.success||H.error("Failed to copy character:",M.error)}catch(t){H.error("Error copying character:",t)}finally{$(!1)}}},C=()=>{a[r]&&(h(a[r].name),n(!0))},T=async()=>{if(!j.trim()||!a[r]){n(!1);return}if(j.trim()===a[r].name){n(!1);return}try{const t=await o(r,j.trim());t&&!t.success&&H.error("Failed to edit character name:",t.error)}catch(t){H.error("Error editing character name:",t)}finally{n(!1)}},E=()=>{n(!1),h("")},V=t=>{t.key==="Enter"?T():t.key==="Escape"&&E()};x.useEffect(()=>{Q&&g.current&&(g.current.focus(),g.current.select())},[Q]);const _=a[r],W=_?_.name:"Select Character...",c=_&&!L,u=_&&!Q&&o;return e.jsxs("div",{className:"character-dropdown-with-copy",children:[e.jsx("div",{className:"character-dropdown-container",children:Q?e.jsx("div",{className:"character-edit-input-container",children:e.jsx("input",{ref:g,type:"text",value:j,onChange:t=>h(t.target.value),onKeyDown:V,onBlur:T,className:"character-edit-input",placeholder:"Character name..."})}):e.jsxs("button",{type:"button",className:"character-dropdown-trigger",onClick:()=>v(!0),"aria-expanded":d,"aria-haspopup":"dialog",children:[e.jsx("span",{className:"character-dropdown-text",children:W}),e.jsx("svg",{className:"character-dropdown-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})}),d&&e.jsx("div",{className:"character-modal-backdrop",children:e.jsxs("div",{className:"character-modal-content",ref:p,children:[e.jsxs("div",{className:"character-modal-header",children:[e.jsx("h3",{children:"Select Character"}),e.jsx("button",{type:"button",className:"character-modal-close",onClick:()=>v(!1),"aria-label":"Close",children:"×"})]}),e.jsxs("div",{className:"character-modal-body",children:[e.jsx("div",{className:"character-modal-option placeholder",onClick:()=>N(""),children:e.jsx("span",{className:"character-modal-name",children:"Select Character..."})}),a.map((t,i)=>{var m;return e.jsxs("div",{className:`character-modal-option ${r===i?"selected":""}`,onClick:()=>N(i),children:[e.jsxs("div",{className:"character-modal-info",children:[e.jsx("span",{className:"character-modal-name",children:t.name}),e.jsxs("span",{className:"character-modal-bosses",children:[((m=t.bosses)==null?void 0:m.length)||0," bosses configured"]})]}),e.jsx("div",{className:"character-modal-actions",children:e.jsx("button",{type:"button",className:"character-modal-btn delete",onClick:q=>b(q,i),title:"Delete character",children:"🗑️"})})]},t.name+i)}),a.length===0&&e.jsxs("div",{className:"character-modal-empty",children:[e.jsx("p",{children:"No characters created yet."}),e.jsx("p",{children:"Use the character creator to add your first character!"})]})]})]})}),e.jsxs("div",{className:"character-action-buttons",children:[e.jsx("button",{type:"button",className:`character-edit-btn ${u?"enabled":"disabled"}`,onClick:C,disabled:!u,title:u?`Edit ${_.name}`:"Select a character to edit",children:e.jsxs("svg",{className:"character-edit-icon",width:"16",height:"16",viewBox:"0 0 494.936 494.936",fill:"currentColor",children:[e.jsx("path",{d:`M389.844,182.85c-6.743,0-12.21,5.467-12.21,12.21v222.968c0,23.562-19.174,42.735-42.736,42.735H67.157
              c-23.562,0-42.736-19.174-42.736-42.735V150.285c0-23.562,19.174-42.735,42.736-42.735h267.741c6.743,0,12.21-5.467,12.21-12.21
              s-5.467-12.21-12.21-12.21H67.157C30.126,83.13,0,113.255,0,150.285v267.743c0,37.029,30.126,67.155,67.157,67.155h267.741
              c37.03,0,67.156-30.126,67.156-67.155V195.061C402.054,188.318,396.587,182.85,389.844,182.85z`}),e.jsx("path",{d:`M483.876,20.791c-14.72-14.72-38.669-14.714-53.377,0L221.352,229.944c-0.28,0.28-3.434,3.559-4.251,5.396l-28.963,65.069
              c-2.057,4.619-1.056,10.027,2.521,13.6c2.337,2.336,5.461,3.576,8.639,3.576c1.675,0,3.362-0.346,4.96-1.057l65.07-28.963
              c1.83-0.815,5.114-3.97,5.396-4.25L483.876,74.169c7.131-7.131,11.06-16.61,11.06-26.692
              C494.936,37.396,491.007,27.915,483.876,20.791z M466.61,56.897L257.457,266.05c-0.035,0.036-0.055,0.078-0.089,0.107
              l-33.989,15.131L238.51,247.3c0.03-0.036,0.071-0.055,0.107-0.09L447.765,38.058c5.038-5.039,13.819-5.033,18.846,0.005
              c2.518,2.51,3.905,5.855,3.905,9.414C470.516,51.036,469.127,54.38,466.61,56.897z`})]})}),e.jsx("button",{type:"button",className:`character-copy-btn ${c?"enabled":"disabled"}`,onClick:f,disabled:!c,title:c?`Copy ${_.name}`:"Select a character to copy",children:L?e.jsx("div",{className:"character-copy-spinner",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"40",strokeDashoffset:"20",className:"copy-spinner-circle"})})}):e.jsx("svg",{className:"character-copy-icon",width:"16",height:"16",viewBox:"0 0 352.804 352.804",fill:"currentColor",children:e.jsx("path",{d:`M318.54,57.282h-47.652V15c0-8.284-6.716-15-15-15H34.264c-8.284,0-15,6.716-15,15v265.522c0,8.284,6.716,15,15,15h47.651
            v42.281c0,8.284,6.716,15,15,15H318.54c8.284,0,15-6.716,15-15V72.282C333.54,63.998,326.824,57.282,318.54,57.282z
             M49.264,265.522V30h191.623v27.282H96.916c-8.284,0-15,6.716-15,15v193.24H49.264z M303.54,322.804H111.916V87.282H303.54V322.804
            z`})})})]})]})}function je({newCharName:a,setNewCharName:r,onAddCharacter:l,characterBossSelections:P,showCrystalCapError:A,cloneError:o}){const d=P.length>=J.CHARACTER_CAP,v=L=>{L.preventDefault(),a.trim()&&!d&&l()};return e.jsx("div",{className:"character-creator",children:e.jsxs("form",{className:"character-creator-form",onSubmit:v,children:[e.jsxs("div",{className:"character-creator-input-group",children:[e.jsx("input",{type:"text",value:a,onChange:L=>r(L.target.value),placeholder:"New character name...",className:"character-creator-input",disabled:d}),e.jsx("button",{type:"submit",disabled:!a.trim()||d,className:"character-creator-button",children:"Add Character"})]}),d&&e.jsxs("div",{className:"character-creator-warning",children:["Maximum ",J.CHARACTER_CAP," characters allowed"]}),o&&e.jsx("div",{className:"character-creator-error",children:o}),A&&e.jsx("div",{className:"character-creator-error",children:"Crystal cap exceeded! Cannot add more bosses."})]})})}function ge({characterBossSelections:a}){const r=(a==null?void 0:a.reduce((A,o)=>{var d;return A+(((d=o.bosses)==null?void 0:d.length)||0)},0))||0,l=180,P=Math.min(r/l*100,100);return e.jsx("div",{className:"crystal-tracker",style:{"--progress-width":`${P}%`},children:e.jsxs("div",{className:"crystal-tracker-content",children:[e.jsxs("div",{className:"crystal-tracker-numbers",children:[e.jsx("span",{className:"crystal-current",children:r}),e.jsx("span",{className:"crystal-separator",children:"/"}),e.jsx("span",{className:"crystal-max",children:l})]}),e.jsx("div",{className:"crystal-tracker-label",children:"Crystals"}),e.jsx("div",{className:"crystal-progress-indicator",children:e.jsx("div",{className:"crystal-progress-fill",style:{height:`${P}%`}})})]})})}function ye({onClick:a,title:r="Quick Select Bosses"}){return e.jsxs("button",{className:"quick-select-btn",onClick:a,title:r,children:[e.jsxs("svg",{className:"quick-select-icon",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M9 12l2 2 4-4"})]}),"Quick Select"]})}function ke({characterBossSelections:a=[],selectedCharIdx:r=0,sortedBossData:l=[],toggleBoss:P=()=>{},updatePartySize:A=()=>{},onQuickSelectClick:o=()=>{},getBossDifficulties:d=()=>[],getAvailablePartySizes:v=()=>[1,2,3,4,5,6],formatPrice:L=$=>$.toLocaleString()}){const[$,Q]=x.useState({}),[n,j]=x.useState(""),h=a[r],p=(h==null?void 0:h.bosses)||[],g=p.length,N=g>=J.CHARACTER_BOSS_CAP,b=c=>p.some(u=>u.name===c),f=c=>p.find(u=>u.name===c),C=async(c,u)=>{if(u){if(g>=J.CHARACTER_BOSS_CAP){j(`Character can only have ${J.CHARACTER_BOSS_CAP} bosses maximum`),setTimeout(()=>j(""),3e3);return}const t=l.find(i=>i.name===c);if(t&&t.difficulties.length>0){const m=d(t).sort((q,M)=>{const z=t.difficulties.find(O=>O.difficulty===q),R=t.difficulties.find(O=>O.difficulty===M);return((R==null?void 0:R.price)||0)-((z==null?void 0:z.price)||0)})[0];await P(r,c,m)}}else await P(r,c,null)},T=async(c,u)=>{await P(r,c,u)},E=async(c,u)=>{const t=f(c),i=t==null?void 0:t.difficulty;i&&await A(r,c,i,parseInt(u))},V=c=>{Q(u=>({...u,[c]:!u[c]}))},_=(c,u)=>{const t=l.find(m=>m.name===c);if(!t)return 0;const i=t.difficulties.find(m=>m.difficulty===u);return(i==null?void 0:i.price)||0},W=(c,u,t=1)=>{const i=_(c,u),m=Math.ceil(i/t);return L(m)};return h?e.jsxs("div",{className:"boss-config-table-container",children:[e.jsxs("div",{className:"character-boss-count",children:[e.jsxs("span",{className:`boss-count ${N?"at-limit":""}`,children:[g,"/",J.CHARACTER_BOSS_CAP," bosses"]}),N&&e.jsx("span",{className:"limit-warning",children:"Character boss limit reached"})]}),n&&e.jsx("div",{className:"character-cap-error",children:n}),e.jsxs("div",{className:"boss-config-table-grid",children:[e.jsxs("div",{className:"boss-config-header",children:[e.jsx("div",{className:"header-boss",children:"Boss"}),e.jsx("div",{className:"header-difficulty",children:"Difficulty"}),e.jsx("div",{className:"header-mesos",children:"Mesos"}),e.jsx("div",{className:"header-config",children:e.jsx(ye,{onClick:o,selectedCharacter:h})})]}),l.map((c,u)=>{const t=b(c.name),i=f(c.name),m=(i==null?void 0:i.difficulty)||"",q=(i==null?void 0:i.partySize)||1,M=$[c.name],z=!t&&N,R=d(c),O=v(c.name,m);return e.jsxs("div",{className:`boss-config-row ${u%2===0?"even":"odd"} ${t?"selected":""} ${z?"disabled-due-to-limit":""}`,onClick:()=>!z&&C(c.name,!t),style:{cursor:z?"not-allowed":"pointer"},title:z?`Character boss limit reached (${J.CHARACTER_BOSS_CAP} max)`:"",children:[e.jsxs("div",{className:"boss-config-cell-boss",children:[e.jsxs("div",{className:"boss-config-info-section",children:[c.image&&e.jsx("img",{alt:c.name,className:"boss-config-image",src:c.image}),e.jsx("div",{className:"boss-config-details",children:e.jsx("span",{className:"boss-config-name",children:c.name})})]}),e.jsx("button",{className:"boss-config-expand-btn mobile-only",onClick:s=>{s.stopPropagation(),V(c.name)},"aria-label":M?"Collapse row":"Expand row",children:e.jsx("svg",{className:`expand-arrow ${M?"expanded":""}`,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:`boss-config-cell-difficulty ${M?"expanded":""}`,children:t?e.jsx("select",{value:m,onChange:s=>T(c.name,s.target.value),onClick:s=>s.stopPropagation(),className:"difficulty-dropdown",disabled:!t,children:R.map(s=>e.jsx("option",{value:s,children:s},s))}):e.jsx("span",{className:"difficulty-placeholder",children:"-"})}),e.jsx("div",{className:`boss-config-cell-mesos ${M?"expanded":""}`,children:t&&m?e.jsx("span",{className:"mesos-amount",children:W(c.name,m,q)}):e.jsx("span",{className:"mesos-placeholder",children:"-"})}),e.jsx("div",{className:`boss-config-cell-config ${M?"expanded":""}`,children:e.jsxs("div",{className:"config-controls",children:[e.jsx(ue,{checked:t,onChange:s=>{s.stopPropagation(),!z&&C(c.name,s.target.checked)},disabled:z}),t&&e.jsx("select",{value:q,onChange:s=>{s.stopPropagation(),E(c.name,s.target.value)},onClick:s=>s.stopPropagation(),className:"party-size-dropdown",title:`Party Size: ${q}`,children:O.map(s=>e.jsx("option",{value:s,children:s},s))})]})})]},c.name)})]})]}):e.jsx("div",{className:"boss-config-table-container",children:e.jsx("div",{className:"boss-config-empty",children:e.jsx("p",{children:"Please select a character to configure bosses."})})})}function ve({characterBossSelections:a=[],selectedCharIdx:r=0,newCharName:l="",handleCharacterChange:P=()=>{},addCharacter:A=()=>{},removeCharacter:o=()=>{},setNewCharName:d=()=>{},updateCharacterName:v=()=>{},sortedBossData:L=[],toggleBoss:$=()=>{},updatePartySize:Q=()=>{},onQuickSelectClick:n=()=>{},getBossDifficulties:j=()=>[],getAvailablePartySizes:h=()=>[1,2,3,4,5,6],formatPrice:p=C=>C.toLocaleString(),totalBossCount:g=0,cloneError:N="",showCrystalCapError:b=!1,onCopyCharacter:f=()=>{}}){const C=a[r];return e.jsxs("div",{className:"character-management-container",children:[e.jsxs("div",{className:"integrated-boss-config-container",children:[e.jsxs("div",{className:"character-controls-header",children:[e.jsxs("div",{className:"character-controls-section",children:[e.jsxs("div",{className:"character-selector-group",children:[e.jsx("div",{className:"character-dropdown-wrapper",children:e.jsx(xe,{characterBossSelections:a,selectedCharIdx:r,onCharacterChange:P,onRemoveCharacter:o,onCopyCharacter:f,onEditCharacterName:v})}),e.jsx("div",{className:"character-creator-wrapper",children:e.jsx(je,{newCharName:l,setNewCharName:d,onAddCharacter:A,characterBossSelections:a})})]}),e.jsx("div",{className:"crystal-tracker-wrapper",children:e.jsx(ge,{characterBossSelections:a})})]}),N&&e.jsx("div",{className:"character-management-error",children:N})]}),a.length===0?e.jsxs("div",{className:"no-characters-message",children:[e.jsx("div",{className:"no-characters-icon",children:e.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M16 7C16 9.20914 14.2091 11 12 11C9.79086 11 8 9.20914 8 7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7Z",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M12 14C8.13401 14 5 17.134 5 21H19C19 17.134 15.866 14 12 14Z",stroke:"currentColor",strokeWidth:"2"})]})}),e.jsx("h3",{children:"No Characters Yet"}),e.jsx("p",{children:"Create your first character to start configuring bosses and tracking your weekly progress."})]}):r===""||!C?e.jsxs("div",{className:"select-character-message",children:[e.jsx("div",{className:"select-character-icon",children:e.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("h3",{children:"Select a Character"}),e.jsx("p",{children:"Choose a character from the dropdown above to configure their boss selection."})]}):e.jsx(ke,{characterBossSelections:a,selectedCharIdx:r,sortedBossData:L,toggleBoss:$,updatePartySize:Q,onQuickSelectClick:n,getBossDifficulties:j,getAvailablePartySizes:h,formatPrice:p})]}),b&&e.jsx("div",{className:"crystal-cap-error-overlay",children:e.jsx("div",{className:"crystal-cap-error-message",children:"Crystal limit reached! Maximum 180 crystals allowed."})})]})}x.lazy(()=>ce(()=>import("./DataBackup-C9GJmutq.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])));function ze(){ne();const{userCode:a,handleDeleteAccount:r}=le(),{characterBossSelections:l,setCharacterBossSelections:P,newCharName:A,setNewCharName:o,selectedCharIdx:d,cloneError:v,setCloneError:L,showUndo:$,undoData:Q,fileInputRef:n,importError:j,setImportError:h,importSuccess:p,setImportSuccess:g,sortedBossData:N,getAvailablePartySizes:b,getBossDifficulties:f,handleCharacterChange:C,addCharacter:T,removeCharacter:E,handleUndo:V,toggleBoss:_,updateCharacterName:W,updatePartySize:c,batchSetBosses:u,showCrystalCapError:t,isLoading:i,copyCharacter:m}=oe(),[q,M]=x.useState(!1),[z,R]=x.useState(!1),[O,s]=x.useState(""),[y,B]=x.useState(!1),[K,Z]=x.useState(!1),S=me(),F=async()=>{try{const{exportUserData:k}=await ce(async()=>{const{exportUserData:U}=await import("./utilityService-BJZ4H6vw.js");return{exportUserData:U}},__vite__mapDeps([4,5,3,6,1,2,7])),w=await k(a);if(w.success){const U=JSON.stringify(w.data,null,2),ae=new Blob([U],{type:"application/json"}),Y=URL.createObjectURL(ae),ee=document.createElement("a");ee.href=Y,ee.download=`maplestory-boss-calc-backup-${new Date().toISOString().split("T")[0]}.json`,ee.click(),URL.revokeObjectURL(Y),g(!0),setTimeout(()=>g(!1),3e3)}else throw new Error(w.error)}catch(k){H.error("Export error:",k),h("Failed to export data. Please try again."),setTimeout(()=>h(""),5e3)}},D=async k=>{const w=k.target.files[0];if(!w)return;const U=new FileReader;U.onload=async ae=>{try{const Y=JSON.parse(ae.target.result),{importUserData:ee}=await ce(async()=>{const{importUserData:ie}=await import("./utilityService-BJZ4H6vw.js");return{importUserData:ie}},__vite__mapDeps([4,5,3,6,1,2,7])),re=await ee(a,Y);if(!re.success)throw new Error(re.error);g(!0),setTimeout(()=>{g(!1),window.location.reload()},2e3)}catch(Y){H.error("Import error:",Y),h(Y.message||"Invalid data file. Please check the format and try again."),setTimeout(()=>h(""),5e3)}},U.readAsText(w)},I=async()=>{B(!0),s("");try{const k=await r();k.success?R(!1):s(k.error)}catch(k){s("Failed to delete account. Try again."),H.error("Delete error:",k)}finally{B(!1)}},G=()=>N||[],X=k=>{if(k>=1e9){const w=k/1e9;return w>=10?`${Math.round(w)}B`:`${w.toFixed(1)}B`}else if(k>=1e6){const w=k/1e6;return w>=10?`${Math.round(w)}M`:`${w.toFixed(1)}M`}else if(k>=1e3){const w=k/1e3;return w>=10?`${Math.round(w)}K`:`${w.toFixed(1)}K`}else return k.toString()},te=()=>{Z(!1),S.setQuickSelectBosses({}),S.setQuickSelectError("")};return e.jsxs("div",{className:"page-container",children:[e.jsx(de,{currentPage:"calculator",onExport:F,onImport:D,fileInputRef:n}),e.jsxs("div",{className:"page-header-container fade-in",children:[e.jsx("h1",{className:"page-title-main",children:"Character and Boss Configuration"}),d!==""&&l[d]&&e.jsx("div",{className:"boss-config-description",children:e.jsxs("p",{children:["Configure bosses, difficulties, and party sizes for ",e.jsx("strong",{children:l[d].name})]})})]}),j&&e.jsx("div",{className:"error-message-container",children:j}),p&&e.jsx("div",{className:"success-message-container",children:"Data backup operation successful!"}),e.jsx(he,{children:i?e.jsx(fe,{}):e.jsx(ve,{characterBossSelections:l,selectedCharIdx:d,newCharName:A,handleCharacterChange:C,addCharacter:T,removeCharacter:E,setNewCharName:o,updateCharacterName:W,sortedBossData:N,toggleBoss:_,updatePartySize:c,onQuickSelectClick:()=>Z(!0),getBossDifficulties:f,getAvailablePartySizes:b,formatPrice:X,totalBossCount:l.reduce((k,w)=>{var U;return k+(((U=w.bosses)==null?void 0:U.length)||0)},0),cloneError:v,showCrystalCapError:t,onCopyCharacter:m})}),$&&Q&&e.jsxs("div",{className:"undo-snackbar",children:["Character deleted.",e.jsx("button",{onClick:V,className:"undo-btn",children:"Undo"})]}),q&&e.jsx("div",{className:"modal-backdrop",onClick:()=>M(!1),children:e.jsxs("div",{className:"modal-fade modal-content",onClick:k=>k.stopPropagation(),children:[e.jsx("button",{onClick:()=>M(!1),className:"modal-close-btn",title:"Close",children:"×"}),e.jsx("h2",{className:"modal-title",children:"Help & FAQ"}),e.jsxs("div",{className:"modal-section-content",style:{marginBottom:24},children:[e.jsx("h3",{className:"modal-section-title",children:"Getting Started"}),e.jsx("p",{children:"1. Create an account or log in with your existing code"}),e.jsx("p",{children:"2. Add characters using the input field at the top"}),e.jsx("p",{children:"3. Select a character and choose their bosses & difficulties"}),e.jsx("p",{children:"4. Head to Weekly Tracker to mark completions and track pitched items!"})]}),e.jsxs("div",{className:"modal-section-content",style:{marginBottom:24},children:[e.jsx("h3",{className:"modal-section-title",children:"Boss Selection"}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Quick Select:"})," Use Quick Select for easy boss setup"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Party sizes:"})," Adjust party size for each boss to calculate split mesos"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Clone characters:"})," Copy a character's entire boss setup instantly"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Difficulty matters:"})," Higher difficulties = more mesos and pitched items"]})]}),e.jsxs("div",{className:"modal-section-content",style:{marginBottom:24},children:[e.jsx("h3",{className:"modal-section-title",children:"Data Management"}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Auto-save:"})," All changes are automatically saved to the cloud"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Export/Import:"})," Backup your data or transfer between devices"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Smart cleanup:"})," Changing boss selections automatically cleans up old tracking data"]})]}),e.jsxs("div",{className:"modal-section-content",children:[e.jsx("h3",{className:"modal-section-title",children:"Quick Tips"}),e.jsx("p",{children:"• Click anywhere on a boss row to toggle selection"}),e.jsx("p",{children:"• Use Quick Select to efficiently set up your boss lists"}),e.jsx("p",{children:"• Your account code is your login - keep it safe!"}),e.jsx("p",{children:"• Check out the Boss Table page to see which bosses give the most mesos"})]})]})}),z&&e.jsx("div",{className:"modal-backdrop modal-backdrop-critical",onClick:()=>R(!1),children:e.jsxs("div",{className:"modal-fade modal-content-critical",onClick:k=>k.stopPropagation(),children:[e.jsx("div",{className:"critical-modal-icon",children:e.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z",stroke:"#fff",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("h2",{className:"critical-modal-title",children:"Delete Account"}),e.jsx("div",{className:"critical-modal-warning",children:e.jsxs("p",{children:[e.jsx("strong",{children:"This will permanently delete your account and all associated data."}),e.jsx("br",{}),"This action cannot be undone."]})}),e.jsxs("div",{className:"modal-button-container",children:[e.jsx("button",{onClick:()=>R(!1),disabled:y,className:"modal-btn-cancel",children:"Cancel"}),e.jsxs("button",{onClick:I,disabled:y,className:"modal-btn-critical",children:[y&&e.jsx("div",{className:"loading-spinner"}),y?"Deleting...":"Delete Forever"]})]}),O&&e.jsx("div",{className:"modal-error-message",children:O})]})}),e.jsx(pe,{show:K,onClose:te,quickSelectBosses:S.quickSelectBosses,quickSelectError:S.quickSelectError,getSortedBossesByPrice:G,getBossDifficulties:f,formatPrice:X,handleQuickSelectBoss:S.handleQuickSelectBoss,updateQuickSelectPartySize:S.updateQuickSelectPartySize,applyQuickSelection:()=>{S.applyQuickSelection(d,l,u),Z(!1)},resetQuickSelection:S.resetQuickSelection,reuseLastQuickSelect:S.reuseLastQuickSelect,lastQuickSelectBosses:S.lastQuickSelectBosses,selectedCharIdx:d,characterBossSelections:l}),e.jsx("input",{ref:n,type:"file",accept:".json",onChange:D,style:{display:"none"}}),e.jsx("style",{children:`
        @keyframes modalFadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        @keyframes modalSlideIn {
          from {
            opacity: 0;
            transform: scale(0.8) translateY(20px);
          }
          to {
            opacity: 1;
            transform: scale(1) translateY(0);
          }
        }

        .crystal-cap-error-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100vw;
          height: 100vh;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 3000;
          pointer-events: none;
          padding: 1rem;
          box-sizing: border-box;
        }
        
        .crystal-cap-error-message {
          background: rgba(40, 32, 74, 0.97);
          color: #fff;
          font-size: 1.25rem;
          font-weight: 600;
          border-radius: 16px;
          box-shadow: 0 4px 32px rgba(128,90,213,0.18);
          padding: 1.5rem 2.5rem;
          border: 1.5px solid #a259f7;
          text-align: center;
          animation: modalFadeIn 0.3s cubic-bezier(.4,2,.6,1);
          letter-spacing: 0.5px;
          max-width: 90vw;
          width: auto;
          min-width: 300px;
        }

        /* Responsive design for crystal cap error */
        @media (min-width: 2560px) {
          .crystal-cap-error-message {
            font-size: 1.5rem;
            padding: 2rem 3rem;
            border-radius: 20px;
            min-width: 400px;
          }
        }

        @media (min-width: 1920px) and (max-width: 2559px) {
          .crystal-cap-error-message {
            font-size: 1.35rem;
            padding: 1.75rem 2.75rem;
            border-radius: 18px;
            min-width: 350px;
          }
        }

        @media (max-width: 1365px) and (min-width: 769px) {
          .crystal-cap-error-message {
            font-size: 1.1rem;
            padding: 1.25rem 2rem;
            min-width: 280px;
          }
        }

        @media (max-width: 768px) {
          .crystal-cap-error-overlay {
            padding: 0.5rem;
          }
          
          .crystal-cap-error-message {
            font-size: 1rem;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            min-width: 260px;
            max-width: 95vw;
            line-height: 1.4;
          }
        }

        @media (max-width: 480px) {
          .crystal-cap-error-overlay {
            padding: 0.25rem;
          }
          
          .crystal-cap-error-message {
            font-size: 0.9rem;
            padding: 0.75rem 1.25rem;
            border-radius: 10px;
            min-width: 240px;
            max-width: 98vw;
            line-height: 1.3;
          }
        }
      `})]})}export{ze as default};
