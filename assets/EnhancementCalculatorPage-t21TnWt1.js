import{j as e}from"./vendor-ui-aK89YfOw.js";import{r as h}from"./vendor-router-Cg8TMqY4.js";import{l as p,u as ce,V as re}from"./index-H-SBb4Tt.js";import"./vendor-react-eWEExxYH.js";import"./vendor-supabase-B7S7y5aO.js";const ie={0:{success:95,maintain:5,decrease:0,destroy:0},1:{success:90,maintain:10,decrease:0,destroy:0},2:{success:85,maintain:15,decrease:0,destroy:0},3:{success:85,maintain:15,decrease:0,destroy:0},4:{success:80,maintain:20,decrease:0,destroy:0},5:{success:75,maintain:25,decrease:0,destroy:0},6:{success:70,maintain:30,decrease:0,destroy:0},7:{success:65,maintain:35,decrease:0,destroy:0},8:{success:60,maintain:40,decrease:0,destroy:0},9:{success:55,maintain:45,decrease:0,destroy:0},10:{success:50,maintain:50,decrease:0,destroy:0},11:{success:45,maintain:55,decrease:0,destroy:0},12:{success:40,maintain:60,decrease:0,destroy:0},13:{success:35,maintain:65,decrease:0,destroy:0},14:{success:30,maintain:70,decrease:0,destroy:0},15:{success:30,maintain:67.9,decrease:0,destroy:2.1},16:{success:30,maintain:0,decrease:67.9,destroy:2.1},17:{success:30,maintain:0,decrease:67.9,destroy:2.1},18:{success:30,maintain:0,decrease:67.2,destroy:2.8},19:{success:30,maintain:0,decrease:67.2,destroy:2.8},20:{success:30,maintain:63,decrease:0,destroy:7},21:{success:30,maintain:0,decrease:63,destroy:7},22:{success:3,maintain:0,decrease:77.6,destroy:19.4},23:{success:2,maintain:0,decrease:68.6,destroy:29.4},24:{success:1,maintain:0,decrease:59.4,destroy:39.6}};function A(s,t=2.7,o=1){return(x,i)=>{const u=o*Math.pow(i,3)*Math.pow(x+1,t)/s+10;return 100*Math.round(u)}}function oe(s){switch(s){case 11:return A(22e3);case 12:return A(15e3);case 13:return A(11e3);case 14:return A(7500);default:return s>=0&&s<=9?A(2500,1):s===10?A(4e4):(s>=15&&s<=24,A(2e4))}}function de(s,t){return oe(s)(s,t)}function ue(s){return s===2}function V(s,t,o,x={},i=1e4){try{if(p.info("Starting starforce simulation",{equipLevel:s,currentStar:t,targetStar:o,options:x,simulations:i}),!s||s<1||s>300)return{success:!1,error:"Invalid equipment level. Must be between 1-300."};if(t<0||t>25||o<0||o>25)return{success:!1,error:"Invalid star levels. Must be between 0-25."};if(t>=o)return{success:!1,error:"Target star must be higher than current star."};const{eventType:u="none",mvpLevel:l="none",hasPremium:r=!1,isZeroWeapon:b=!1,useSafeguard:g=!1,useStarCatch:m=!1}=x,C=[],M=performance.now();for(let E=0;E<i;E++){const L=he(s,t,o,{eventType:u,mvpLevel:l,hasPremium:r,isZeroWeapon:b,useSafeguard:g,useStarCatch:m});C.push(L)}const y=performance.now(),F=pe(C);return p.info("Starforce simulation completed",{simulations:i,duration:`${(y-M).toFixed(2)}ms`,averageCost:F.averageCost,averageAttempts:F.averageAttempts}),{success:!0,...F,equipLevel:s,currentStar:t,targetStar:o,options:{eventType:u,mvpLevel:l,hasPremium:r,isZeroWeapon:b,useSafeguard:g,useStarCatch:m},simulationCount:i,duration:y-M}}catch(u){return p.error("Error in starforce simulation",u),{success:!1,error:"Failed to simulate starforce enhancement. Please try again."}}}function he(s,t,o,x){let i=t,u=0,l=0,r=0,b=0,g=0,m=0;const C=fe(s,x.isZeroWeapon);for(;i<o;){l++;const M=ue(r),y=je(C,i,x,s,M);if(u+=y,M){i++,m++,r=0;continue}if((x.eventType==="51015"||x.eventType==="ssf")&&(i===5||i===10||i===15)){i++,m++,r=0;continue}const E=me(i,x),L=xe(E);if(L==="success"?(i++,m++,r=0):L==="decrease"?(i=Math.max(0,i-1),g++,r++):L==="maintain"?r=0:L==="destroy"&&(i=12,b++,r=0),l>1e4){p.warn("Simulation exceeded 10000 attempts, terminating");break}}return{totalCost:u,attempts:l,successes:m,decreases:g,booms:b,chanceTimeUsed:m>o-t}}function me(s,t){const o=ie[s];let x=o.success/100,i=o.maintain/100,u=o.decrease/100,l=o.destroy/100;if(t.useSafeguard&&s>=15&&s<=16&&(u>0?u+=l:i+=l,l=0),t.useStarCatch){x*=1.05;const b=1-x;if(u===0){const g=i+l;g>0&&(i=i*b/g,l=b-i)}else{const g=u+l;g>0&&(u=u*b/g,l=b-u)}}return{success:x*100,maintain:i*100,decrease:u*100,destroy:l*100}}function xe(s){const t=Math.random()*100;return t<s.success?"success":t<s.success+s.maintain?"maintain":t<s.success+s.maintain+s.decrease?"decrease":"destroy"}function je(s,t,o,x,i=!1){let u=0;const l=Ne(x,t);return l!==null?u=l:u=de(t,s),ve(u,o,t,i)}function ve(s,t,o,x=!1){let i=1;o<=16&&(t.mvpLevel==="silver"?i-=.03:t.mvpLevel==="gold"?i-=.05:t.mvpLevel==="diamond"&&(i-=.1)),(t.eventType==="30off"||t.eventType==="ssf")&&(i-=.3);const l=t.eventType==="51015"||t.eventType==="ssf";t.useSafeguard&&!x&&!(l&&o===15)&&o>=15&&o<=16&&(i+=1);const b=s*i;return Math.round(b)}function pe(s){const t=s.map(l=>l.totalCost).sort((l,r)=>l-r),o=s.map(l=>l.attempts).sort((l,r)=>l-r),x=s.reduce((l,r)=>l+r.successes,0),i=s.reduce((l,r)=>l+r.decreases,0),u=s.reduce((l,r)=>l+r.booms,0);return{averageCost:Math.round(t.reduce((l,r)=>l+r,0)/t.length),medianCost:t[Math.floor(t.length*.5)],percentile25Cost:t[Math.floor(t.length*.25)],percentile75Cost:t[Math.floor(t.length*.75)],percentile90Cost:t[Math.floor(t.length*.9)],percentile99Cost:t[Math.floor(t.length*.99)],minCost:t[0],maxCost:t[t.length-1],averageAttempts:Math.round(o.reduce((l,r)=>l+r,0)/o.length),medianAttempts:o[Math.floor(o.length*.5)],percentile90Attempts:o[Math.floor(o.length*.9)],minAttempts:o[0],maxAttempts:o[o.length-1],averageSuccesses:Math.round(x/s.length),averageDecreases:Math.round(i/s.length),averageBooms:u/s.length,chanceTimeUsageRate:Math.round(s.filter(l=>l.chanceTimeUsed).length/s.length*100),costDistribution:ge(t)}}function ge(s){const o=s[0],i=(s[s.length-1]-o)/20,u=[];for(let l=0;l<20;l++){const r=o+l*i,b=o+(l+1)*i,g=s.filter(m=>m>=r&&m<b).length;u.push({range:`${R(r)} - ${R(b)}`,count:g,percentage:Math.round(g/s.length*100)})}return u}function fe(s,t=!1){return t&&s>150?150:s}function Ne(s,t){return(s===108||s===109)&&t===7?321e3:(s===118||s===119)&&t===9?533400:(s===128||s===129)&&t===14?6471400:null}function Se(){return[{value:"none",name:"None",discount:"0%"},{value:"silver",name:"Silver",discount:"3%"},{value:"gold",name:"Gold",discount:"5%"},{value:"diamond",name:"Diamond",discount:"10%"}]}function R(s){return s>=1e9?`${(s/1e9).toFixed(2)}B`:s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(0)}K`:s.toLocaleString()}function Le(){const{isLoggedIn:s}=ce();h.useEffect(()=>{const a=document.body.style.overflowY,n=document.documentElement.style.overflowY;return document.body.style.overflowY="auto",document.documentElement.style.overflowY="auto",()=>{document.body.style.overflowY=a,document.documentElement.style.overflowY=n}},[]);const[t,o]=h.useState("calculator"),[x,i]=h.useState(200),[u,l]=h.useState(0),[r,b]=h.useState(17),[g,m]=h.useState("none"),[C,M]=h.useState("none"),[y,F]=h.useState(!1),[E,L]=h.useState(!1),[k,$]=h.useState(!1),[v,W]=h.useState(null),[Z,U]=h.useState(!1),[K,J]=h.useState(!1),[N,q]=h.useState({eventType:"none",mvpLevel:"none",useStarCatch:!1,useMedianCost:!1}),[T,w]=h.useState({characters:[]}),[D,Y]=h.useState(""),[z,_]=h.useState(new Set);h.useEffect(()=>{try{const a=localStorage.getItem("enhancementPlannerData");if(a){const c=JSON.parse(a);w(c),p.info("Loaded planner data from localStorage")}const n=localStorage.getItem("enhancementCalculator_mode");n&&(o(n),p.info("Loaded mode from localStorage:",n));const d=localStorage.getItem("enhancementCalculator_calculatorSettings");if(d){const c=JSON.parse(d);i(c.equipLevel||200),l(c.currentStar||0),b(c.targetStar||17),m(c.eventType||"none"),M(c.mvpLevel||"none"),F(c.isZeroWeapon||!1),L(c.useSafeguard||!1),$(c.useStarCatch||!1),p.info("Loaded calculator settings from localStorage")}const j=localStorage.getItem("enhancementCalculator_globalSettings");if(j){const c=JSON.parse(j);q({eventType:c.eventType||"none",mvpLevel:c.mvpLevel||"none",useStarCatch:c.useStarCatch||!1,useMedianCost:c.useMedianCost||!1}),p.info("Loaded global settings from localStorage:",c)}}catch(a){p.error("Failed to load saved settings:",a)}},[]),h.useEffect(()=>{T.characters.length>0&&(localStorage.setItem("enhancementPlannerData",JSON.stringify(T)),p.info("Saved planner data to localStorage"))},[T]),h.useEffect(()=>{localStorage.setItem("enhancementCalculator_mode",t),p.info("Saved mode to localStorage:",t)},[t]),h.useEffect(()=>{const a={equipLevel:x,currentStar:u,targetStar:r,eventType:g,mvpLevel:C,isZeroWeapon:y,useSafeguard:E,useStarCatch:k};localStorage.setItem("enhancementCalculator_calculatorSettings",JSON.stringify(a)),p.info("Saved calculator settings to localStorage")},[x,u,r,g,C,y,E,k]),h.useEffect(()=>{localStorage.setItem("enhancementCalculator_globalSettings",JSON.stringify(N)),p.info("Saved global settings to localStorage:",N)},[N]);const H=h.useCallback(()=>{if(!D.trim())return;const a={id:Date.now().toString(),name:D.trim(),items:[]};w(n=>({...n,characters:[...n.characters,a]})),Y(""),_(n=>new Set([...n,a.id])),p.info("Added character:",a.name)},[D]),Q=h.useCallback(a=>{w(n=>({...n,characters:n.characters.filter(d=>d.id!==a)})),_(n=>{const d=new Set(n);return d.delete(a),d}),p.info("Removed character:",a)},[]),X=h.useCallback(a=>{_(n=>{const d=new Set(n);return d.has(a)?d.delete(a):d.add(a),d})},[]),ee=h.useCallback(a=>{const n={id:Date.now().toString(),name:"",equipLevel:200,currentStar:0,targetStar:17,isZeroWeapon:!1,useSafeguard:!1,calculationResult:null};w(d=>({...d,characters:d.characters.map(j=>j.id===a?{...j,items:[...j.items,n]}:j)})),p.info("Added item to character:",a)},[]),se=h.useCallback((a,n)=>{w(d=>({...d,characters:d.characters.map(j=>j.id===a?{...j,items:j.items.filter(c=>c.id!==n)}:j)})),p.info("Removed item:",n,"from character:",a)},[]),ae=h.useCallback((a,n,d)=>{w(j=>({...j,characters:j.characters.map(f=>f.id===a?{...f,items:f.items.map(S=>S.id===n?{...S,...d,...d.calculationResult?{}:d.name!==void 0&&Object.keys(d).length===1?{}:{calculationResult:null}}:S)}:f)}))},[]),O=h.useCallback(()=>{p.info("Starting bulk calculation for all items"),w(a=>{let n={...a};return a.characters.forEach(d=>{d.items.forEach(j=>{if(j.equipLevel&&j.currentStar!==null&&j.targetStar!==null&&j.currentStar<j.targetStar)try{const c=V(j.equipLevel,j.currentStar,j.targetStar,{eventType:N.eventType,mvpLevel:N.mvpLevel,hasPremium:!1,isZeroWeapon:j.isZeroWeapon,useSafeguard:j.useSafeguard,useStarCatch:N.useStarCatch});n={...n,characters:n.characters.map(f=>f.id===d.id?{...f,items:f.items.map(S=>S.id===j.id?{...S,calculationResult:c}:S)}:f)}}catch(c){p.error("Calculation failed for item:",j.name,c),n={...n,characters:n.characters.map(f=>f.id===d.id?{...f,items:f.items.map(S=>S.id===j.id?{...S,calculationResult:{success:!1,error:"Calculation failed. Please try again."}}:S)}:f)}}})}),n})},[N]);h.useEffect(()=>{if(T.characters.length>0){const a=setTimeout(()=>{O()},500);return()=>clearTimeout(a)}},[N,O]);const te=h.useCallback((a,n)=>{p.info("calculateItemCost called with:",{characterId:a,itemId:n}),w(d=>{const j=d.characters.find(f=>f.id===a);if(!j)return p.error("Character not found:",a),d;const c=j.items.find(f=>f.id===n);if(!c)return p.error("Item not found:",n),d;if(p.info("Found item for calculation:",c),!c.equipLevel||c.currentStar===null||c.targetStar===null||c.currentStar>=c.targetStar)return p.error("Invalid item parameters:",{equipLevel:c.equipLevel,currentStar:c.currentStar,targetStar:c.targetStar}),{...d,characters:d.characters.map(f=>f.id===a?{...f,items:f.items.map(S=>S.id===n?{...S,calculationResult:{success:!1,error:"Please enter valid equipment level and star range."}}:S)}:f)};try{p.info("Calculating cost for item:",c.name,"with params:",{equipLevel:c.equipLevel,currentStar:c.currentStar,targetStar:c.targetStar,eventType:N.eventType,mvpLevel:N.mvpLevel,isZeroWeapon:c.isZeroWeapon,useSafeguard:c.useSafeguard,useStarCatch:N.useStarCatch});const f=V(c.equipLevel,c.currentStar,c.targetStar,{eventType:N.eventType,mvpLevel:N.mvpLevel,hasPremium:!1,isZeroWeapon:c.isZeroWeapon,useSafeguard:c.useSafeguard,useStarCatch:N.useStarCatch});return p.info("Calculation result:",f),p.info("Calculation completed for item:",c.name),{...d,characters:d.characters.map(S=>S.id===a?{...S,items:S.items.map(P=>P.id===n?{...P,calculationResult:f}:P)}:S)}}catch(f){return p.error("Calculation failed for item:",c.name,f),{...d,characters:d.characters.map(S=>S.id===a?{...S,items:S.items.map(P=>P.id===n?{...P,calculationResult:{success:!1,error:"Calculation failed. Please try again."}}:P)}:S)}}})},[N]),B=h.useCallback(a=>a.items.reduce((n,d)=>{var j;if((j=d.calculationResult)!=null&&j.success){const c=N.useMedianCost?d.calculationResult.medianCost:d.calculationResult.averageCost;return n+c}return n},0),[N.useMedianCost]),ne=h.useCallback(()=>T.characters.reduce((a,n)=>a+B(n),0),[T.characters,B]),le=h.useCallback(()=>{if(!x||u===null||r===null||u>=r){W({success:!1,error:"Please enter valid equipment level and star range."});return}U(!0),setTimeout(()=>{try{p.info("Starting calculation with params:",{equipLevel:x,currentStar:u,targetStar:r,eventType:g,mvpLevel:C,isZeroWeapon:y,useSafeguard:E,useStarCatch:k});const a=V(x,u,r,{eventType:g,mvpLevel:C,hasPremium:!1,isZeroWeapon:y,useSafeguard:E,useStarCatch:k});p.info("Calculation completed:",a),W(a)}catch(a){p.error("Calculation failed:",a),W({success:!1,error:"Calculation failed. Please try again."})}finally{U(!1)}},100)},[x,u,r,g,C,y,E,k]);if(h.useEffect(()=>{v&&W(null)},[x,u,r,g,C,y,E,k]),!s)return null;const G=Se(),I=g==="51015"||g==="ssf";return h.useEffect(()=>{y&&x>150&&(i(150),p.info("Equipment level capped at 150 due to Zero weapon setting"))},[y,x]),h.useEffect(()=>{try{localStorage.setItem("enhancementCalculator_mode",t),p.info("Saved mode to localStorage:",t)}catch(a){p.error("Failed to save mode to localStorage:",a)}},[t]),e.jsx("div",{className:"enhancement-calculator-page-wrapper",children:e.jsx("div",{className:"enhancement-calculator-page",children:e.jsx(re,{children:e.jsxs("div",{className:"enhancement-calculator-main fade-in",children:[e.jsxs("div",{className:"enhancement-header",children:[e.jsx("h2",{className:"enhancement-title",children:"Enhancement Calculator"}),e.jsx("p",{className:"enhancement-subtitle",children:"Calculate meso costs for starforcing equipment"}),e.jsxs("div",{className:"mode-toggle",children:[e.jsx("button",{className:`mode-button ${t==="calculator"?"active":""}`,onClick:()=>o("calculator"),children:"Single Calculator"}),e.jsx("button",{className:`mode-button ${t==="planner"?"active":""}`,onClick:()=>o("planner"),children:"Multi-Character Planner"})]})]}),e.jsx("button",{className:"formula-floating-button",onClick:()=>J(!0),title:"View Formulas & Math Reference",children:"?"}),t==="calculator"?e.jsxs("div",{className:"enhancement-container",children:[e.jsxs("div",{className:"enhancement-inputs",children:[e.jsxs("div",{className:"enhancement-section",children:[e.jsx("h3",{className:"section-title",children:"Equipment Settings"}),e.jsxs("div",{className:"input-group",children:[e.jsxs("label",{htmlFor:"equip-level",children:["Equipment Level:",y&&e.jsx("span",{className:"level-cap-info",children:" (Max 150 for Zero weapons)"})]}),e.jsx("input",{id:"equip-level",type:"number",min:"1",max:y?"150":"300",value:x,onChange:a=>{const n=parseInt(a.target.value)||1;i(Math.min(n,y?150:300))},className:"level-input"})]}),e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{className:"toggle-label",children:[e.jsx("input",{type:"checkbox",checked:y,onChange:a=>F(a.target.checked),className:"toggle-checkbox"}),e.jsx("span",{className:"toggle-slider"}),e.jsx("span",{className:"toggle-text",children:"Zero Weapon (Capped at Level 150)"})]})})]}),e.jsxs("div",{className:"enhancement-section",children:[e.jsx("h3",{className:"section-title",children:"Star Range"}),e.jsxs("div",{className:"star-range-inputs",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"current-star",children:"Current Stars:"}),e.jsx("select",{id:"current-star",value:u,onChange:a=>l(parseInt(a.target.value)),className:"star-select",children:Array.from({length:25},(a,n)=>e.jsxs("option",{value:n,children:[n,"★"]},n))})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"target-star",children:"Target Stars:"}),e.jsx("select",{id:"target-star",value:r,onChange:a=>b(parseInt(a.target.value)),className:"star-select",children:Array.from({length:25},(a,n)=>n+1).map(a=>e.jsxs("option",{value:a,disabled:a<=u,children:[a,"★"]},a))})]})]})]}),e.jsxs("div",{className:"enhancement-section",children:[e.jsx("h3",{className:"section-title",children:"Discounts & Events"}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"mvp-level",children:"MVP Level:"}),e.jsx("select",{id:"mvp-level",value:C,onChange:a=>M(a.target.value),className:"mvp-select",children:G.map(a=>e.jsxs("option",{value:a.value,children:[a.name," (",a.discount,")"]},a.value))})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"event-type",children:"Active Event:"}),e.jsxs("select",{id:"event-type",value:g,onChange:a=>m(a.target.value),className:"event-select",children:[e.jsx("option",{value:"none",children:"No Event"}),e.jsx("option",{value:"30off",children:"30% Cost Reduction"}),e.jsx("option",{value:"51015",children:"5/10/15 Guaranteed Success"}),e.jsx("option",{value:"ssf",children:"Shiny Star Force (30% + 5/10/15)"})]})]}),g!=="none"&&e.jsxs("div",{className:"event-info",children:[g==="30off"&&e.jsxs("p",{className:"info-text",children:[e.jsx("span",{className:"event-badge",children:"30% Off"}),"All starforce costs reduced by 30%"]}),g==="51015"&&e.jsxs("p",{className:"info-text",children:[e.jsx("span",{className:"event-badge guaranteed",children:"5/10/15"}),"Guaranteed success for 5★→6★, 10★→11★, and 15★→16★ upgrades"]}),g==="ssf"&&e.jsxs("p",{className:"info-text",children:[e.jsx("span",{className:"event-badge",children:"SSF"}),"30% cost reduction + guaranteed success for 5★→6★, 10★→11★, and 15★→16★"]})]})]}),e.jsxs("div",{className:"enhancement-section",children:[e.jsx("h3",{className:"section-title",children:"Star Catch Minigame"}),e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{className:"toggle-label",children:[e.jsx("input",{type:"checkbox",checked:k,onChange:a=>$(a.target.checked),className:"toggle-checkbox"}),e.jsx("span",{className:"toggle-slider"}),e.jsx("span",{className:"toggle-text",children:"Use Star Catch (+5% Success Rate)"})]})}),k&&e.jsx("div",{className:"starcatch-info",children:e.jsx("p",{className:"info-text",children:"Star Catch minigame increases success rate by 5% multiplicatively when successful. Does not appear during guaranteed upgrades (5/10/15 events, Chance Time)."})})]}),e.jsxs("div",{className:"enhancement-section",children:[e.jsx("h3",{className:"section-title",children:"Safeguard Options"}),e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{className:"toggle-label",children:[e.jsx("input",{type:"checkbox",checked:E,onChange:a=>L(a.target.checked),className:"toggle-checkbox"}),e.jsx("span",{className:"toggle-slider"}),e.jsxs("span",{className:"toggle-text",children:[I?"Safeguard 16★ → 17★":"Safeguard 15★ → 16★ & 16★ → 17★",I&&e.jsx("span",{className:"event-clarification",children:" (15★→16★ guaranteed by event)"})]})]})}),E&&e.jsx("div",{className:"safeguard-info",children:e.jsx("p",{className:"info-text",children:I?"Safeguard doubles the cost but prevents equipment destruction for 16★→17★. The 15★→16★ upgrade is guaranteed by the event and doesn't need safeguarding.":"Safeguard doubles the cost but prevents equipment destruction for both 15★→16★ and 16★→17★."})})]}),e.jsx("div",{className:"enhancement-section",children:e.jsxs("div",{className:"calculate-section",children:[e.jsx("button",{onClick:le,disabled:Z||!x||u>=r,className:`calculate-button ${Z?"calculating":""}`,children:Z?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"button-spinner"}),e.jsx("span",{children:"Running Simulation..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"🎲"}),e.jsx("span",{children:"Calculate Starforce Cost"})]})}),e.jsx("div",{className:"calculate-info",children:e.jsx("p",{className:"info-text",children:"Runs 10,000 simulations to provide realistic cost estimates and risk analysis."})})]})})]}),e.jsx("div",{className:"enhancement-results",children:Z?e.jsxs("div",{className:"calculating-indicator",children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:"Calculating..."})]}):v?v.success?e.jsxs("div",{className:"results-content",children:[e.jsxs("div",{className:"simulation-header",children:[e.jsx("h3",{className:"results-title",children:"Simulation Results"}),e.jsxs("div",{className:"simulation-info",children:[e.jsxs("span",{className:"simulation-count",children:[v.simulationCount.toLocaleString()," simulations"]}),e.jsxs("span",{className:"simulation-time",children:["(",v.duration.toFixed(0),"ms)"]})]})]}),e.jsxs("div",{className:"statistics-grid",children:[e.jsxs("div",{className:"stat-card primary",children:[e.jsx("h4",{children:"Average Cost"}),e.jsxs("div",{className:"stat-value-container",children:[e.jsx("div",{className:"stat-value",children:R(v.averageCost)}),e.jsxs("div",{className:"stat-tooltip",children:[v.averageCost.toLocaleString()," mesos"]})]}),e.jsx("div",{className:"stat-unit",children:"mesos"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("h4",{children:"Median Cost"}),e.jsxs("div",{className:"stat-value-container",children:[e.jsx("div",{className:"stat-value",children:R(v.medianCost)}),e.jsxs("div",{className:"stat-tooltip",children:[v.medianCost.toLocaleString()," mesos"]})]}),e.jsx("div",{className:"stat-unit",children:"mesos"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("h4",{children:"Average Booms"}),e.jsx("div",{className:"stat-value",children:v.averageBooms.toFixed(2)}),e.jsx("div",{className:"stat-unit",children:"booms"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("h4",{children:"90th Percentile"}),e.jsxs("div",{className:"stat-value-container",children:[e.jsx("div",{className:"stat-value",children:R(v.percentile90Cost)}),e.jsxs("div",{className:"stat-tooltip",children:[v.percentile90Cost.toLocaleString()," mesos"]})]}),e.jsx("div",{className:"stat-unit",children:"mesos"})]})]}),e.jsxs("div",{className:"risk-analysis",children:[e.jsx("h4",{children:"Cost Range Analysis"}),e.jsxs("div",{className:"range-stats",children:[e.jsxs("div",{className:"range-item",children:[e.jsx("span",{className:"range-label",children:"Best Case:"}),e.jsx("span",{className:"range-value",children:R(v.minCost)})]}),e.jsxs("div",{className:"range-item",children:[e.jsx("span",{className:"range-label",children:"25th Percentile:"}),e.jsx("span",{className:"range-value",children:R(v.percentile25Cost)})]}),e.jsxs("div",{className:"range-item",children:[e.jsx("span",{className:"range-label",children:"75th Percentile:"}),e.jsx("span",{className:"range-value",children:R(v.percentile75Cost)})]}),e.jsxs("div",{className:"range-item",children:[e.jsx("span",{className:"range-label",children:"99th Percentile:"}),e.jsx("span",{className:"range-value",children:R(v.percentile99Cost)})]}),e.jsxs("div",{className:"range-item worst-case",children:[e.jsx("span",{className:"range-label",children:"Worst Case:"}),e.jsx("span",{className:"range-value",children:R(v.maxCost)})]})]})]}),e.jsxs("div",{className:"outcome-analysis",children:[e.jsx("h4",{children:"Enhancement Outcomes"}),e.jsxs("div",{className:"outcome-stats",children:[e.jsxs("div",{className:"outcome-item success",children:[e.jsx("span",{className:"outcome-label",children:"Avg Successes:"}),e.jsx("span",{className:"outcome-value",children:v.averageSuccesses})]}),e.jsxs("div",{className:"outcome-item decrease",children:[e.jsx("span",{className:"outcome-label",children:"Avg Decreases:"}),e.jsx("span",{className:"outcome-value",children:v.averageDecreases})]}),e.jsxs("div",{className:"outcome-item boom",children:[e.jsx("span",{className:"outcome-label",children:"Avg Booms:"}),e.jsx("span",{className:"outcome-value",children:v.averageBooms})]}),e.jsxs("div",{className:"outcome-item chance-time",children:[e.jsx("span",{className:"outcome-label",children:"Chance Time Usage:"}),e.jsxs("span",{className:"outcome-value",children:[v.chanceTimeUsageRate,"%"]})]})]})]}),e.jsxs("div",{className:"simulation-summary",children:[e.jsx("h4",{children:"Simulation Parameters"}),e.jsxs("div",{className:"summary-grid",children:[e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Equipment Level:"}),e.jsx("span",{className:"summary-value",children:v.equipLevel})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Star Range:"}),e.jsxs("span",{className:"summary-value",children:[v.currentStar,"★ → ",v.targetStar,"★"]})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Event:"}),e.jsxs("span",{className:"summary-value",children:[v.options.eventType==="none"&&"None",v.options.eventType==="30off"&&"30% Cost Reduction",v.options.eventType==="51015"&&"5/10/15 Guaranteed",v.options.eventType==="ssf"&&"Shiny Star Force"]})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"MVP Level:"}),e.jsx("span",{className:"summary-value",children:v.options.mvpLevel==="none"?"None":v.options.mvpLevel.toUpperCase()})]}),v.options.useStarCatch&&e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Star Catch:"}),e.jsx("span",{className:"summary-value",children:"Enabled (+5% Success)"})]}),v.options.useSafeguard&&e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Safeguard:"}),e.jsx("span",{className:"summary-value",children:"15★→16★ & 16★→17★"})]}),v.options.isZeroWeapon&&e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Zero Weapon:"}),e.jsx("span",{className:"summary-value",children:"Yes (Capped at 150)"})]})]})]})]}):e.jsxs("div",{className:"error-message",children:[e.jsx("span",{className:"error-icon",children:"⚠️"}),e.jsx("span",{children:v.error})]}):e.jsx("div",{className:"no-results",children:e.jsx("span",{children:'Click the "Calculate Starforce Cost" button to run simulation'})})})]}):e.jsxs("div",{className:"planner-container",children:[e.jsxs("div",{className:"global-settings-panel",children:[e.jsx("h3",{className:"section-title",children:"Global Settings"}),e.jsxs("div",{className:"global-settings-grid",children:[e.jsxs("div",{className:"setting-group",children:[e.jsx("label",{children:"Event Type:"}),e.jsxs("select",{value:N.eventType,onChange:a=>q(n=>({...n,eventType:a.target.value})),className:"setting-select",children:[e.jsx("option",{value:"none",children:"No Event"}),e.jsx("option",{value:"30off",children:"30% Cost Reduction"}),e.jsx("option",{value:"51015",children:"5/10/15 Guaranteed Success"}),e.jsx("option",{value:"ssf",children:"Shiny Star Force (30% + 5/10/15)"})]})]}),e.jsxs("div",{className:"setting-group",children:[e.jsx("label",{children:"MVP Level:"}),e.jsx("select",{value:N.mvpLevel,onChange:a=>q(n=>({...n,mvpLevel:a.target.value})),className:"setting-select",children:G.map(a=>e.jsxs("option",{value:a.value,children:[a.name," (",a.discount,")"]},a.value))})]}),e.jsx("div",{className:"setting-group",children:e.jsxs("button",{type:"button",className:`toggle-button ${N.useStarCatch?"active":""}`,onClick:()=>q(a=>({...a,useStarCatch:!a.useStarCatch})),children:[e.jsx("span",{className:"toggle-icon",children:"⭐"}),e.jsx("span",{className:"toggle-text",children:"Star Catch (+5%)"})]})}),e.jsx("div",{className:"setting-group",children:e.jsxs("button",{type:"button",className:`toggle-button ${N.useMedianCost?"active":""}`,onClick:()=>q(a=>({...a,useMedianCost:!a.useMedianCost})),title:N.useMedianCost?"Using median cost (50th percentile)":"Using average cost (mean)",children:[e.jsx("span",{className:"toggle-icon",children:"📊"}),e.jsx("span",{className:"toggle-text",children:N.useMedianCost?"Median Cost":"Average Cost"})]})}),e.jsx("div",{className:"setting-group",children:e.jsxs("button",{onClick:O,className:"calculate-all-button",disabled:T.characters.length===0,children:[e.jsx("span",{children:"🎲"}),e.jsx("span",{children:"Re-run All Simulations"})]})})]})]}),e.jsxs("div",{className:"planner-header",children:[e.jsxs("div",{className:"add-character-section",children:[e.jsx("h3",{className:"section-title",children:"Add Character"}),e.jsxs("div",{className:"add-character-form",children:[e.jsx("input",{type:"text",value:D,onChange:a=>Y(a.target.value),placeholder:"Enter character name...",className:"character-name-input",onKeyPress:a=>a.key==="Enter"&&H()}),e.jsx("button",{onClick:H,disabled:!D.trim(),className:"add-character-button",children:"Add Character"})]})]}),e.jsxs("div",{className:"overall-total",children:[e.jsxs("h3",{className:"section-title",children:["Total Costs",e.jsx("span",{className:"cost-type-indicator",children:N.useMedianCost?"Median":"Average"})]}),e.jsx("div",{className:"total-cost-display",children:T.characters.length>0?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"total-amount",children:R(ne())}),e.jsx("span",{className:"total-unit",children:"mesos"})]}):e.jsx("span",{className:"total-amount",children:"0 mesos"})})]})]}),e.jsx("div",{className:"characters-list",children:T.characters.length===0?e.jsx("div",{className:"no-characters",children:e.jsx("span",{children:"No characters added yet. Add a character to start planning!"})}):T.characters.map(a=>e.jsxs("div",{className:"character-card",children:[e.jsxs("div",{className:"character-header",children:[e.jsxs("div",{className:"character-info",children:[e.jsx("div",{className:"character-name-row",children:e.jsx("h4",{className:"character-name",children:a.name})}),e.jsxs("div",{className:"character-stats",children:[e.jsxs("span",{className:"item-count",children:[a.items.length," items"]}),e.jsxs("span",{className:"calculated-items",children:[a.items.filter(n=>{var d;return(d=n.calculationResult)==null?void 0:d.success}).length," calculated"]})]})]}),e.jsx("span",{className:"character-total-badge",children:R(B(a))}),e.jsxs("div",{className:"character-actions",children:[e.jsx("button",{onClick:()=>X(a.id),className:"expand-button",children:z.has(a.id)?"▲":"▼"}),e.jsx("button",{onClick:()=>Q(a.id),className:"remove-character-button",children:"✕"})]})]}),z.has(a.id)&&e.jsx("div",{className:"character-content",children:e.jsxs("div",{className:"items-section",children:[e.jsxs("div",{className:"items-header",children:[e.jsx("h5",{children:"Items"}),e.jsx("button",{onClick:()=>ee(a.id),className:"add-item-button",children:"+ Add Item"})]}),a.items.length===0?e.jsx("div",{className:"no-items",children:e.jsx("span",{children:"No items added yet."})}):e.jsx("div",{className:"items-list",children:a.items.map(n=>e.jsx(Ce,{item:n,characterId:a.id,onUpdateItem:ae,onRemoveItem:se,onCalculate:te,mvpOptions:G,globalSettings:N},n.id))})]})})]},a.id))})]}),K&&e.jsx(be,{onClose:()=>J(!1)})]})})})})}function Ce({item:s,characterId:t,onUpdateItem:o,onRemoveItem:x,onCalculate:i,mvpOptions:u,globalSettings:l}){var g;const r=(m,C)=>{if(m==="equipLevel"){const M=s.isZeroWeapon?150:300,y=Math.min(C,M);o(t,s.id,{[m]:y})}else if(m==="isZeroWeapon"){const M={[m]:C};C&&s.equipLevel>150&&(M.equipLevel=150),o(t,s.id,M)}else o(t,s.id,{[m]:C})};h.useEffect(()=>{if(s.equipLevel&&s.currentStar!==null&&s.targetStar!==null&&s.currentStar<s.targetStar){const m=setTimeout(()=>{i(t,s.id)},300);return()=>clearTimeout(m)}},[s.equipLevel,s.currentStar,s.targetStar,s.isZeroWeapon,s.useSafeguard,t,s.id,i]),l.eventType==="51015"||l.eventType;const b=()=>l.eventType==="51015"||l.eventType==="ssf"?"Safeguard 16★→17★ (15★→16★ guaranteed by event)":"Safeguard 15★→16★ & 16★→17★ (prevents equipment destruction)";return e.jsxs("div",{className:"item-card",children:[e.jsxs("div",{className:"item-header",children:[e.jsx("div",{className:"item-info",children:e.jsxs("div",{className:"item-header-row-inline",children:[e.jsx("div",{className:"item-name-input-container",children:e.jsx("input",{type:"text",value:s.name||"",onChange:m=>r("name",m.target.value),className:"item-name-input",placeholder:"Equipment name...",maxLength:"20"})}),e.jsxs("div",{className:"summary-control-inline",children:[e.jsxs("label",{children:["Lv.",s.isZeroWeapon&&e.jsx("span",{className:"level-cap-hint",title:"Zero weapons capped at 150",children:"(≤150)"})]}),e.jsx("input",{type:"number",min:"1",max:s.isZeroWeapon?"150":"300",value:s.equipLevel,onChange:m=>r("equipLevel",parseInt(m.target.value)||1),className:"level-input-inline"})]}),e.jsxs("div",{className:"star-range-inline",children:[e.jsx("select",{value:s.currentStar,onChange:m=>r("currentStar",parseInt(m.target.value)),className:"star-select-inline",children:Array.from({length:25},(m,C)=>e.jsxs("option",{value:C,children:[C,"★"]},C))}),e.jsx("span",{className:"star-arrow",children:"→"}),e.jsx("select",{value:s.targetStar,onChange:m=>r("targetStar",parseInt(m.target.value)),className:"star-select-inline",children:Array.from({length:25},(m,C)=>C+1).map(m=>e.jsxs("option",{value:m,disabled:m<=s.currentStar,children:[m,"★"]},m))})]}),e.jsxs("div",{className:"toggle-controls-inline",children:[e.jsxs("button",{type:"button",className:`toggle-btn-inline ${s.isZeroWeapon?"active":""}`,onClick:()=>r("isZeroWeapon",!s.isZeroWeapon),title:"Zero Weapon",children:[e.jsx("span",{className:"toggle-icon",children:"⚔️"}),e.jsx("span",{className:"toggle-text",children:"Zero Weapon"})]}),e.jsxs("button",{type:"button",className:`toggle-btn-inline ${s.useSafeguard?"active":""}`,onClick:()=>r("useSafeguard",!s.useSafeguard),title:b(),children:[e.jsx("span",{className:"toggle-icon",children:"🛡️"}),e.jsx("span",{className:"toggle-text",children:"Safeguard"})]})]}),(g=s.calculationResult)!=null&&g.success?e.jsxs("div",{className:"item-cost-badge",children:[e.jsxs("div",{className:"meso-part",children:["💰 ",R(l.useMedianCost?s.calculationResult.medianCost:s.calculationResult.averageCost),e.jsxs("div",{className:"cost-tooltip meso-tooltip",children:[l.useMedianCost?"Median":"Average"," Cost: ",(l.useMedianCost?s.calculationResult.medianCost:s.calculationResult.averageCost).toLocaleString()," mesos"]})]}),e.jsxs("div",{className:"boom-part",children:["💥",s.calculationResult.averageBooms.toFixed(1),e.jsxs("div",{className:"cost-tooltip boom-tooltip",children:["Expected Booms: ",s.calculationResult.averageBooms.toFixed(2)]})]})]}):e.jsx("div",{className:"item-cost-pending-badge",children:s.equipLevel&&s.currentStar<s.targetStar?"Calculating...":"Not calculated"})]})}),e.jsx("div",{className:"item-actions",children:e.jsx("button",{onClick:()=>x(t,s.id),className:"remove-item-button",children:"✕"})})]}),s.calculationResult&&!s.calculationResult.success&&e.jsxs("div",{className:"item-error-inline",children:["⚠️ ",s.calculationResult.error]})]})}function be({onClose:s}){return e.jsx("div",{className:"modal-overlay",onClick:s,children:e.jsxs("div",{className:"formula-modal",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"formula-modal-header",children:[e.jsx("h2",{children:"Starforce Enhancement Formulas & Math Reference"}),e.jsx("button",{className:"close-button",onClick:s,children:"×"})]}),e.jsxs("div",{className:"formula-modal-content",children:[e.jsxs("div",{className:"formula-section",children:[e.jsx("h3",{children:"🧮 Base Cost Formula"}),e.jsxs("div",{className:"formula-box",children:[e.jsx("div",{className:"formula-title",children:"Meso Cost Calculation"}),e.jsx("div",{className:"formula-math",children:"Cost = 100 × round(extraMult × itemLevel³ × (currentStar + 1)^starExp / divisor + 10)"}),e.jsxs("div",{className:"formula-details",children:[e.jsx("p",{children:e.jsx("strong",{children:"Where:"})}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("code",{children:"extraMult"}),": 1.0 (multiplier constant)"]}),e.jsxs("li",{children:[e.jsx("code",{children:"itemLevel"}),": Equipment level (1-300, capped at 150 for Zero weapons)"]}),e.jsxs("li",{children:[e.jsx("code",{children:"currentStar"}),": Current star level (0-24)"]}),e.jsxs("li",{children:[e.jsx("code",{children:"starExp"}),": Star exponent (varies by star level)"]}),e.jsxs("li",{children:[e.jsx("code",{children:"divisor"}),": Divisor constant (varies by star level)"]})]})]})]}),e.jsxs("div",{className:"formula-table",children:[e.jsx("h4",{children:"Star-Specific Parameters:"}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Star Level"}),e.jsx("th",{children:"Star Exponent"}),e.jsx("th",{children:"Divisor"}),e.jsx("th",{children:"Notes"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"0★ - 9★"}),e.jsx("td",{children:"1.0"}),e.jsx("td",{children:"2,500"}),e.jsx("td",{children:"Linear scaling"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"10★"}),e.jsx("td",{children:"2.7"}),e.jsx("td",{children:"40,000"}),e.jsx("td",{children:"Exponential scaling begins"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"11★"}),e.jsx("td",{children:"2.7"}),e.jsx("td",{children:"22,000"}),e.jsx("td",{children:"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"12★"}),e.jsx("td",{children:"2.7"}),e.jsx("td",{children:"15,000"}),e.jsx("td",{children:"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"13★"}),e.jsx("td",{children:"2.7"}),e.jsx("td",{children:"11,000"}),e.jsx("td",{children:"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"14★"}),e.jsx("td",{children:"2.7"}),e.jsx("td",{children:"7,500"}),e.jsx("td",{children:"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"15★ - 24★"}),e.jsx("td",{children:"2.7"}),e.jsx("td",{children:"20,000"}),e.jsx("td",{children:"High star scaling"})]})]})]})]})]}),e.jsxs("div",{className:"formula-section",children:[e.jsx("h3",{children:"🎯 Success Rates"}),e.jsxs("div",{className:"formula-box",children:[e.jsx("div",{className:"formula-title",children:"Base Success Rates (GMS Savior)"}),e.jsx("div",{className:"formula-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Star Level"}),e.jsx("th",{children:"Success %"}),e.jsx("th",{children:"Maintain %"}),e.jsx("th",{children:"Decrease %"}),e.jsx("th",{children:"Destroy %"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"0★ - 4★"}),e.jsx("td",{children:"95% - 80%"}),e.jsx("td",{children:"5% - 20%"}),e.jsx("td",{children:"0%"}),e.jsx("td",{children:"0%"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"5★ - 10★"}),e.jsx("td",{children:"75% - 50%"}),e.jsx("td",{children:"25% - 50%"}),e.jsx("td",{children:"0%"}),e.jsx("td",{children:"0%"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"11★ - 14★"}),e.jsx("td",{children:"45% - 30%"}),e.jsx("td",{children:"55% - 70%"}),e.jsx("td",{children:"0%"}),e.jsx("td",{children:"0%"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"15★"}),e.jsx("td",{children:"30%"}),e.jsx("td",{children:"67.9%"}),e.jsx("td",{children:"0%"}),e.jsx("td",{children:"2.1%"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"16★ - 17★"}),e.jsx("td",{children:"30%"}),e.jsx("td",{children:"0%"}),e.jsx("td",{children:"67.9%"}),e.jsx("td",{children:"2.1%"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"18★ - 19★"}),e.jsx("td",{children:"30%"}),e.jsx("td",{children:"0%"}),e.jsx("td",{children:"67.2%"}),e.jsx("td",{children:"2.8%"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"20★"}),e.jsx("td",{children:"30%"}),e.jsx("td",{children:"63%"}),e.jsx("td",{children:"0%"}),e.jsx("td",{children:"7%"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"21★"}),e.jsx("td",{children:"30%"}),e.jsx("td",{children:"0%"}),e.jsx("td",{children:"63%"}),e.jsx("td",{children:"7%"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"22★"}),e.jsx("td",{children:"3%"}),e.jsx("td",{children:"0%"}),e.jsx("td",{children:"77.6%"}),e.jsx("td",{children:"19.4%"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"23★"}),e.jsx("td",{children:"2%"}),e.jsx("td",{children:"0%"}),e.jsx("td",{children:"68.6%"}),e.jsx("td",{children:"29.4%"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"24★"}),e.jsx("td",{children:"1%"}),e.jsx("td",{children:"0%"}),e.jsx("td",{children:"59.4%"}),e.jsx("td",{children:"39.6%"})]})]})]})})]})]}),e.jsxs("div",{className:"formula-section",children:[e.jsx("h3",{children:"⭐ Star Catch Minigame"}),e.jsxs("div",{className:"formula-box",children:[e.jsx("div",{className:"formula-title",children:"Success Rate Modification"}),e.jsx("div",{className:"formula-math",children:"ModifiedSuccessRate = BaseSuccessRate × 1.05"}),e.jsxs("div",{className:"formula-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Effect:"})," +5% multiplicative increase to success rate"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Redistribution:"})," Remaining probability is redistributed proportionally between other outcomes"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," Does not appear during guaranteed upgrades (5/10/15 events, Chance Time)"]})]})]})]}),e.jsxs("div",{className:"formula-section",children:[e.jsx("h3",{children:"🛡️ Safeguard Mechanics"}),e.jsxs("div",{className:"formula-box",children:[e.jsx("div",{className:"formula-title",children:"Safeguard Cost & Effect"}),e.jsx("div",{className:"formula-math",children:"SafeguardCost = BaseCost × 2"}),e.jsxs("div",{className:"formula-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Protection:"})," Prevents equipment destruction (boom) for 15★→16★ and 16★→17★"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Effect:"})," Boom chance becomes decrease chance (or maintain if no decrease)"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Cost:"})," Doubles the enhancement cost"]}),e.jsx("p",{children:e.jsx("strong",{children:"Special Cases:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"No safeguard cost during Chance Time"}),e.jsx("li",{children:"No safeguard needed for 15★→16★ during 5/10/15 events (guaranteed)"})]})]})]})]}),e.jsxs("div",{className:"formula-section",children:[e.jsx("h3",{children:"💰 Discount Application Order"}),e.jsxs("div",{className:"formula-box",children:[e.jsx("div",{className:"formula-title",children:"Final Cost Calculation"}),e.jsxs("div",{className:"formula-math",children:["Multiplier = 1.0 - MVPDiscount - EventDiscount + SafeguardMultiplier",e.jsx("br",{}),"FinalCost = round(BaseCost × Multiplier)"]}),e.jsxs("div",{className:"formula-details",children:[e.jsx("p",{children:e.jsx("strong",{children:"MVP Discounts (applies to 0★-16★ only):"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"Silver MVP: -3% (0.03)"}),e.jsx("li",{children:"Gold MVP: -5% (0.05)"}),e.jsx("li",{children:"Diamond MVP: -10% (0.10)"})]}),e.jsx("p",{children:e.jsx("strong",{children:"Event Discounts:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"30% Off Event: -30% (0.30)"}),e.jsx("li",{children:"Shiny Star Force: -30% (0.30)"})]}),e.jsx("p",{children:e.jsx("strong",{children:"Safeguard Multiplier:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"When safeguard is used: +1.0 (additive)"}),e.jsx("li",{children:"Example: 30% off + safeguard = 0.7 × 2 = 1.4× cost"})]})]})]})]}),e.jsxs("div",{className:"formula-section",children:[e.jsx("h3",{children:"🎉 Special Event Mechanics"}),e.jsxs("div",{className:"formula-box",children:[e.jsx("div",{className:"formula-title",children:"5/10/15 Guaranteed Events"}),e.jsxs("div",{className:"formula-details",children:[e.jsx("p",{children:e.jsx("strong",{children:"Guaranteed Successes:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"5★ → 6★: 100% success rate"}),e.jsx("li",{children:"10★ → 11★: 100% success rate"}),e.jsx("li",{children:"15★ → 16★: 100% success rate"})]}),e.jsx("p",{children:e.jsx("strong",{children:"Shiny Star Force (SSF):"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"Combines 30% cost reduction with 5/10/15 guaranteed"}),e.jsx("li",{children:"Both effects apply simultaneously"})]})]})]})]}),e.jsxs("div",{className:"formula-section",children:[e.jsx("h3",{children:"⏰ Chance Time Mechanics"}),e.jsxs("div",{className:"formula-box",children:[e.jsx("div",{className:"formula-title",children:"Chance Time Activation"}),e.jsx("div",{className:"formula-math",children:"ChanceTime = (ConsecutiveDecreases == 2)"}),e.jsxs("div",{className:"formula-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Activation:"})," After 2 consecutive star decreases"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Effect:"})," Next enhancement attempt has 100% success rate"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Cost:"})," No safeguard cost during Chance Time"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Reset:"})," Counter resets after success or equipment destruction"]})]})]})]}),e.jsxs("div",{className:"formula-section",children:[e.jsx("h3",{children:"🎲 Simulation Methodology"}),e.jsxs("div",{className:"formula-box",children:[e.jsx("div",{className:"formula-title",children:"Monte Carlo Simulation"}),e.jsxs("div",{className:"formula-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Method:"})," 10,000 independent simulations"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Random Number Generation:"})," JavaScript Math.random()"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Outcome Determination:"})," Probability thresholds"]}),e.jsx("p",{children:e.jsx("strong",{children:"Statistics Calculated:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"Average (mean) cost and attempts"}),e.jsx("li",{children:"Median (50th percentile)"}),e.jsx("li",{children:"Percentiles: 25th, 75th, 90th, 99th"}),e.jsx("li",{children:"Min/Max values"}),e.jsx("li",{children:"Average booms, decreases, successes"}),e.jsx("li",{children:"Chance Time usage rate"})]})]})]})]}),e.jsxs("div",{className:"formula-section",children:[e.jsx("h3",{children:"📊 Data Sources & Accuracy"}),e.jsx("div",{className:"formula-box",children:e.jsxs("div",{className:"formula-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Formula Source:"})," MathBro's Starforce Calculator"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Success Rates:"})," GMS Savior update rates"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Validation:"})," Extensively tested against known results"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Accuracy:"})," Results match official MapleStory enhancement costs"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," Formulas are based on Global MapleStory (GMS) mechanics"]})]})})]})]})]})})}export{Le as default};
