const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DataBackup-B9OwR3F0.js","assets/vendor-ui-aK89YfOw.js","assets/vendor-router-Cg8TMqY4.js","assets/vendor-react-eWEExxYH.js","assets/utilityService-OetPi0cW.js","assets/vendor-supabase-B7S7y5aO.js","assets/index-ChAGxcO2.js","assets/index-cPECv1Lb.css"])))=>i.map(i=>d[i]);
import{_ as X}from"./vendor-supabase-B7S7y5aO.js";import{j as e}from"./vendor-ui-aK89YfOw.js";import{r as P}from"./vendor-router-Cg8TMqY4.js";import{l as T,L as te,a as oe,u as de,b as he,N as me,V as ue}from"./index-ChAGxcO2.js";import{getBossPrice as G}from"./bossRegistryService-B-8C88KZ.js";import{C as pe}from"./CustomCheckbox-C2-rm8qf.js";import"./vendor-react-eWEExxYH.js";function xe(){const[t,r]=P.useState({}),[d,b]=P.useState({}),[y,n]=P.useState("");return{quickSelectBosses:t,setQuickSelectBosses:r,lastQuickSelectBosses:d,quickSelectError:y,setQuickSelectError:n,handleQuickSelectBoss:(l,v,x=1)=>{const f=Object.keys(t).length;if(t[l])if(t[l].difficulty===v){const m={...t};delete m[l],r(m)}else r({...t,[l]:{difficulty:v,partySize:t[l].partySize||x}});else{if(f>=14){n("Maximum 14 bosses can be selected"),setTimeout(()=>n(""),3e3);return}r({...t,[l]:{difficulty:v,partySize:x}})}n("")},updateQuickSelectPartySize:(l,v)=>{t[l]&&r({...t,[l]:{...t[l],partySize:v}})},reuseLastQuickSelect:()=>{if(Object.keys(d).length===0){n("No previous quick select settings to reuse"),setTimeout(()=>n(""),3e3);return}T.info("QuickSelect: Reusing last quick select settings",{bossCount:Object.keys(d).length,bosses:Object.keys(d)}),r({...d}),n("")},applyQuickSelection:(l,v,x)=>{if(l===null||!v[l]){n("Please select a character first"),setTimeout(()=>n(""),3e3);return}Object.keys(t).length>0&&(b({...t}),T.info("QuickSelect: Storing selection for reuse",{bossCount:Object.keys(t).length}));let f=Object.entries(t).map(([c,o])=>({name:c,difficulty:o.difficulty,partySize:o.partySize||1}));const i=180-v.reduce((c,o,w)=>w===l?c:c+(o.bosses?o.bosses.length:0),0);if(f.length>i){try{const c=require("../data/bossData"),o=c.bossData;f=f.map(w=>({...w,price:c.getBossPrice(o.find(D=>D.name===w.name),w.difficulty)||0})),f.sort((w,D)=>(D.price||0)-(w.price||0))}catch(c){T.error("Error loading boss data for price sorting:",c)}f=f.slice(0,i),n(`Selection trimmed to stay within 180 crystal limit. Added ${i} ${i===1?"boss":"bosses"}.`),setTimeout(()=>n(""),5e3)}x(l,f),r({}),f.length||n("")},resetQuickSelection:()=>{r({}),n("")}}}function fe({show:t,onClose:r,quickSelectBosses:d,quickSelectError:b,getSortedBossesByPrice:y,getBossDifficulties:n,formatPrice:p,handleQuickSelectBoss:q,updateQuickSelectPartySize:k,applyQuickSelection:z,resetQuickSelection:M,reuseLastQuickSelect:l,lastQuickSelectBosses:v,selectedCharIdx:x,characterBossSelections:f}){var L;const[m,i]=P.useState({show:!1,boss:null,difficulty:null});if(!t)return null;const c=Object.keys(d).length,o=c===14,w=()=>{z()},D=()=>{},a=(s,S)=>{q(s,S)},j=(s,S)=>{i({show:!0,boss:s,difficulty:S})},h=s=>{const{boss:S}=m;k(S.name,s)},g=()=>{i({show:!1,boss:null,difficulty:null})},C=()=>{i({show:!1,boss:null,difficulty:null})},R=s=>[1,2,3,4,5,6],Q=s=>{var S;return((S=d[s])==null?void 0:S.partySize)||1},A=s=>{var S;return(S=d[s])==null?void 0:S.difficulty};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"quick-select-overlay",onClick:r,children:e.jsxs("div",{className:"quick-select-modal",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{onClick:r,className:"quick-select-close-btn",title:"Close",children:"Ã—"}),e.jsxs("div",{className:"quick-select-header",children:[e.jsx("h1",{className:"quick-select-title",children:"Quick Boss Selection"}),e.jsx("p",{className:"quick-select-subtitle",children:"Select up to 14 bosses â€¢ Click party size indicator to adjust"})]}),e.jsxs("div",{className:"quick-select-progress",style:{"--progress-width":`${c/14*100}%`},children:[e.jsx("div",{className:"quick-select-progress-bar"}),e.jsxs("div",{className:"quick-select-progress-content",children:[e.jsx("div",{className:`quick-select-count ${c===14?"complete":"partial"}`,children:c}),e.jsx("div",{className:"quick-select-total",children:"/ 14"})]}),e.jsx("div",{className:"quick-select-label",children:"Bosses Selected"})]}),b&&e.jsx("div",{className:"quick-select-error",children:b}),e.jsx("div",{className:"quick-select-grid",children:y().map((s,S)=>{const V=!!d[s.name],F=A(s.name),K=n(s),H=Q(s.name),I=K.sort((E,O)=>{const U=G(s,E);return G(s,O)-U});return e.jsxs("div",{className:`quick-select-boss-card ${V?"selected":"unselected"}`,children:[V&&e.jsx("div",{className:"quick-select-party-indicator",onClick:()=>j(s,F),title:`Party Size: ${H}`,children:H}),e.jsxs("div",{className:"quick-select-boss-info",children:[s.image&&e.jsx("div",{className:"quick-select-boss-image",children:e.jsx("img",{src:s.image,alt:s.name})}),e.jsxs("div",{className:"quick-select-boss-details",children:[e.jsx("div",{className:"quick-select-boss-name",children:s.name}),e.jsxs("div",{className:"quick-select-boss-price",children:["Max: ",p(s.maxPrice)]})]})]}),e.jsxs("div",{className:"quick-select-difficulties",children:[e.jsx("div",{className:"quick-select-difficulty-label",children:"Choose Difficulty"}),e.jsx("div",{className:"quick-select-difficulty-inline",children:I.map((E,O)=>{const U=F===E;G(s,E);const Y=O===0;return e.jsx("button",{onClick:()=>a(s.name,E),className:`quick-select-difficulty-option ${U?"selected":""} ${Y?"most-expensive":""}`,children:e.jsx("span",{className:"difficulty-text",children:E})},E)})})]})]},s.name)})}),e.jsxs("div",{className:"quick-select-actions",children:[e.jsx("button",{onClick:M,className:"quick-select-action-btn quick-select-clear-btn",children:"Clear All"}),e.jsxs("button",{onClick:l,disabled:Object.keys(v).length===0,className:`quick-select-action-btn quick-select-reuse-btn ${Object.keys(v).length===0?"disabled":"enabled"}`,title:"Reuse last quick select settings",children:[e.jsxs("svg",{className:"quick-select-reuse-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 12a9 9 0 11-6.219-8.56"}),e.jsx("path",{d:"M15 4.5l.5-.5L16 3h-4v4l1-1"}),e.jsx("path",{d:"M12 8v4l3 3"})]}),"Reuse Last"]}),e.jsxs("button",{onClick:z,disabled:c===0||x===null,className:`quick-select-action-btn quick-select-apply-btn ${c===0||x===null?"disabled":"enabled"}`,children:["Apply to ",x!==null&&f[x]?f[x].name:"Character"]})]}),x===null&&e.jsx("div",{className:"quick-select-helper",children:"Please select a character first to apply the boss selection"}),o&&x!==null&&e.jsxs("div",{className:`quick-select-instant-apply ${o?"show":""}`,children:[e.jsx("div",{className:"quick-select-instant-apply-icon",children:"ðŸŽ‰"}),e.jsx("div",{className:"quick-select-instant-apply-title",children:"Perfect Selection!"}),e.jsx("div",{className:"quick-select-instant-apply-subtitle",children:"You've selected 14 bosses - ready to apply?"}),e.jsxs("div",{className:"quick-select-instant-apply-actions",children:[e.jsx("button",{onClick:w,className:"quick-select-instant-apply-btn primary",children:"Apply Now"}),e.jsx("button",{onClick:D,className:"quick-select-instant-apply-btn secondary",children:"Keep Selecting"})]})]})]})}),m.show&&e.jsx("div",{className:"party-size-modal-overlay",onClick:C,children:e.jsxs("div",{className:"party-size-modal",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"party-size-modal-title",children:"Party Size"}),e.jsxs("div",{className:"party-size-modal-subtitle",children:["Select party size for ",(L=m.boss)==null?void 0:L.name]}),e.jsx("div",{className:"party-size-options",children:R(m.boss).map(s=>{var S;return e.jsx("button",{onClick:()=>h(s),className:`party-size-option ${Q((S=m.boss)==null?void 0:S.name)===s?"selected":""}`,children:s},s)})}),e.jsxs("div",{className:"party-size-modal-actions",children:[e.jsx("button",{onClick:g,className:"party-size-modal-btn primary",children:"Confirm"}),e.jsx("button",{onClick:C,className:"party-size-modal-btn secondary",children:"Cancel"})]})]})})]})}function je(){return e.jsx("div",{className:"page-loader",children:e.jsx("div",{className:"loading-spinner"})})}function ge({characterBossSelections:t,selectedCharIdx:r,onCharacterChange:d,onRemoveCharacter:b,onCopyCharacter:y}){const[n,p]=P.useState(!1),[q,k]=P.useState(!1),z=P.useRef(null);P.useEffect(()=>{const i=c=>{z.current&&!z.current.contains(c.target)&&p(!1)};if(n)return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[n]),P.useEffect(()=>{const i=c=>{c.key==="Escape"&&p(!1)};if(n)return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}},[n]);const M=i=>{d({target:{value:i}}),p(!1)},l=(i,c)=>{var o;i.stopPropagation(),T.info("Deleting character:",(o=t[c])==null?void 0:o.name),b(c)},v=async()=>{if(!(q||!t[r])){k(!0);try{const i=t[r].name,c=t.map(a=>a.name);let o=1,w=`${i}-${o}`;for(;c.includes(w);)o++,w=`${i}-${o}`;const D=await y(r,w);D.success||T.error("Failed to copy character:",D.error)}catch(i){T.error("Error copying character:",i)}finally{k(!1)}}},x=t[r],f=x?x.name:"Select Character...",m=x&&!q;return e.jsxs("div",{className:"character-dropdown-with-copy",children:[e.jsx("div",{className:"character-dropdown-container",children:e.jsxs("button",{type:"button",className:"character-dropdown-trigger",onClick:()=>p(!0),"aria-expanded":n,"aria-haspopup":"dialog",children:[e.jsx("span",{className:"character-dropdown-text",children:f}),e.jsx("svg",{className:"character-dropdown-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})}),n&&e.jsx("div",{className:"character-modal-backdrop",children:e.jsxs("div",{className:"character-modal-content",ref:z,children:[e.jsxs("div",{className:"character-modal-header",children:[e.jsx("h3",{children:"Select Character"}),e.jsx("button",{type:"button",className:"character-modal-close",onClick:()=>p(!1),"aria-label":"Close",children:"Ã—"})]}),e.jsxs("div",{className:"character-modal-body",children:[e.jsx("div",{className:"character-modal-option placeholder",onClick:()=>M(""),children:e.jsx("span",{className:"character-modal-name",children:"Select Character..."})}),t.map((i,c)=>{var o;return e.jsxs("div",{className:`character-modal-option ${r===c?"selected":""}`,onClick:()=>M(c),children:[e.jsxs("div",{className:"character-modal-info",children:[e.jsx("span",{className:"character-modal-name",children:i.name}),e.jsxs("span",{className:"character-modal-bosses",children:[((o=i.bosses)==null?void 0:o.length)||0," bosses configured"]})]}),e.jsx("div",{className:"character-modal-actions",children:e.jsx("button",{type:"button",className:"character-modal-btn delete",onClick:w=>l(w,c),title:"Delete character",children:"ðŸ—‘ï¸"})})]},i.name+c)}),t.length===0&&e.jsxs("div",{className:"character-modal-empty",children:[e.jsx("p",{children:"No characters created yet."}),e.jsx("p",{children:"Use the character creator to add your first character!"})]})]})]})}),e.jsx("button",{type:"button",className:`character-copy-btn ${m?"enabled":"disabled"}`,onClick:v,disabled:!m,title:m?`Copy ${x.name}`:"Select a character to copy",children:q?e.jsx("div",{className:"character-copy-spinner",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"40",strokeDashoffset:"20",className:"copy-spinner-circle"})})}):e.jsx("svg",{className:"character-copy-icon",width:"16",height:"16",viewBox:"0 0 352.804 352.804",fill:"currentColor",children:e.jsx("path",{d:`M318.54,57.282h-47.652V15c0-8.284-6.716-15-15-15H34.264c-8.284,0-15,6.716-15,15v265.522c0,8.284,6.716,15,15,15h47.651
            v42.281c0,8.284,6.716,15,15,15H318.54c8.284,0,15-6.716,15-15V72.282C333.54,63.998,326.824,57.282,318.54,57.282z
             M49.264,265.522V30h191.623v27.282H96.916c-8.284,0-15,6.716-15,15v193.24H49.264z M303.54,322.804H111.916V87.282H303.54V322.804
            z`})})})]})}function ye({newCharName:t,setNewCharName:r,onAddCharacter:d,characterBossSelections:b,showCrystalCapError:y,cloneError:n}){const p=b.length>=te.CHARACTER_CAP,q=k=>{k.preventDefault(),t.trim()&&!p&&d()};return e.jsx("div",{className:"character-creator",children:e.jsxs("form",{className:"character-creator-form",onSubmit:q,children:[e.jsxs("div",{className:"character-creator-input-group",children:[e.jsx("input",{type:"text",value:t,onChange:k=>r(k.target.value),placeholder:"New character name...",className:"character-creator-input",disabled:p}),e.jsx("button",{type:"submit",disabled:!t.trim()||p,className:"character-creator-button",children:"Add Character"})]}),p&&e.jsxs("div",{className:"character-creator-warning",children:["Maximum ",te.CHARACTER_CAP," characters allowed"]}),n&&e.jsx("div",{className:"character-creator-error",children:n}),y&&e.jsx("div",{className:"character-creator-error",children:"Crystal cap exceeded! Cannot add more bosses."})]})})}function ke({characterBossSelections:t}){const r=(t==null?void 0:t.reduce((y,n)=>{var p;return y+(((p=n.bosses)==null?void 0:p.length)||0)},0))||0,d=180,b=Math.min(r/d*100,100);return e.jsx("div",{className:"crystal-tracker",style:{"--progress-width":`${b}%`},children:e.jsxs("div",{className:"crystal-tracker-content",children:[e.jsxs("div",{className:"crystal-tracker-numbers",children:[e.jsx("span",{className:"crystal-current",children:r}),e.jsx("span",{className:"crystal-separator",children:"/"}),e.jsx("span",{className:"crystal-max",children:d})]}),e.jsx("div",{className:"crystal-tracker-label",children:"Crystals"}),e.jsx("div",{className:"crystal-progress-indicator",children:e.jsx("div",{className:"crystal-progress-fill",style:{height:`${b}%`}})})]})})}function ve({onClick:t,title:r="Quick Select Bosses"}){return e.jsxs("button",{className:"quick-select-btn",onClick:t,title:r,children:[e.jsxs("svg",{className:"quick-select-icon",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M9 12l2 2 4-4"})]}),"Quick Select"]})}function Ne({characterBossSelections:t=[],selectedCharIdx:r=0,sortedBossData:d=[],toggleBoss:b=()=>{},updatePartySize:y=()=>{},onQuickSelectClick:n=()=>{},getBossDifficulties:p=()=>[],getAvailablePartySizes:q=()=>[1,2,3,4,5,6],formatPrice:k=z=>z.toLocaleString()}){const[z,M]=P.useState({}),l=t[r],v=(l==null?void 0:l.bosses)||[],x=a=>v.some(j=>j.name===a),f=a=>v.find(j=>j.name===a),m=async(a,j)=>{if(j){const h=d.find(g=>g.name===a);if(h&&h.difficulties.length>0){const C=p(h).sort((R,Q)=>{const A=h.difficulties.find(s=>s.difficulty===R),L=h.difficulties.find(s=>s.difficulty===Q);return((L==null?void 0:L.price)||0)-((A==null?void 0:A.price)||0)})[0];await b(r,a,C)}}else await b(r,a,null)},i=async(a,j)=>{await b(r,a,j)},c=async(a,j)=>{const h=f(a),g=h==null?void 0:h.difficulty;g&&await y(r,a,g,parseInt(j))},o=a=>{M(j=>({...j,[a]:!j[a]}))},w=(a,j)=>{const h=d.find(C=>C.name===a);if(!h)return 0;const g=h.difficulties.find(C=>C.difficulty===j);return(g==null?void 0:g.price)||0},D=(a,j,h=1)=>{const g=w(a,j),C=Math.ceil(g/h);return k(C)};return l?e.jsx("div",{className:"boss-config-table-container",children:e.jsxs("div",{className:"boss-config-table-grid",children:[e.jsxs("div",{className:"boss-config-header",children:[e.jsx("div",{className:"header-boss",children:"Boss"}),e.jsx("div",{className:"header-difficulty",children:"Difficulty"}),e.jsx("div",{className:"header-mesos",children:"Mesos"}),e.jsx("div",{className:"header-config",children:e.jsx(ve,{onClick:n,selectedCharacter:l})})]}),d.map((a,j)=>{const h=x(a.name),g=f(a.name),C=(g==null?void 0:g.difficulty)||"",R=(g==null?void 0:g.partySize)||1,Q=z[a.name],A=p(a),L=q(a.name,C);return e.jsxs("div",{className:`boss-config-row ${j%2===0?"even":"odd"} ${h?"selected":""}`,onClick:()=>m(a.name,!h),style:{cursor:"pointer"},children:[e.jsxs("div",{className:"cell-boss",children:[e.jsxs("div",{className:"boss-info-section",children:[a.image&&e.jsx("img",{alt:a.name,className:"boss-image",src:a.image}),e.jsx("div",{className:"boss-details",children:e.jsx("span",{className:"boss-name",children:a.name})})]}),e.jsx("button",{className:"boss-config-expand-btn mobile-only",onClick:s=>{s.stopPropagation(),o(a.name)},"aria-label":Q?"Collapse row":"Expand row",children:e.jsx("svg",{className:`expand-arrow ${Q?"expanded":""}`,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:`cell-difficulty ${Q?"expanded":""}`,children:h?e.jsx("select",{value:C,onChange:s=>i(a.name,s.target.value),onClick:s=>s.stopPropagation(),className:"difficulty-dropdown",disabled:!h,children:A.map(s=>e.jsx("option",{value:s,children:s},s))}):e.jsx("span",{className:"difficulty-placeholder",children:"-"})}),e.jsx("div",{className:`cell-mesos ${Q?"expanded":""}`,children:h&&C?e.jsx("span",{className:"mesos-amount",children:D(a.name,C,R)}):e.jsx("span",{className:"mesos-placeholder",children:"-"})}),e.jsx("div",{className:`cell-config ${Q?"expanded":""}`,onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"config-controls",children:[e.jsx(pe,{checked:h,onChange:s=>m(a.name,s.target.checked)}),h&&e.jsx("select",{value:R,onChange:s=>c(a.name,s.target.value),onClick:s=>s.stopPropagation(),className:"party-size-dropdown",title:`Party Size: ${R}`,children:L.map(s=>e.jsx("option",{value:s,children:s},s))})]})})]},a.name)})]})}):e.jsx("div",{className:"boss-config-table-container",children:e.jsx("div",{className:"boss-config-empty",children:e.jsx("p",{children:"Please select a character to configure bosses."})})})}function be({characterBossSelections:t=[],selectedCharIdx:r=0,newCharName:d="",handleCharacterChange:b=()=>{},addCharacter:y=()=>{},removeCharacter:n=()=>{},setNewCharName:p=()=>{},sortedBossData:q=[],toggleBoss:k=()=>{},updatePartySize:z=()=>{},onQuickSelectClick:M=()=>{},getBossDifficulties:l=()=>[],getAvailablePartySizes:v=()=>[1,2,3,4,5,6],formatPrice:x=o=>o.toLocaleString(),totalBossCount:f=0,cloneError:m="",showCrystalCapError:i=!1,onCopyCharacter:c=()=>{}}){const o=t[r];return e.jsxs("div",{className:"character-management-container",children:[e.jsxs("div",{className:"integrated-boss-config-container",children:[e.jsxs("div",{className:"character-controls-header",children:[e.jsxs("div",{className:"character-controls-section",children:[e.jsxs("div",{className:"character-selector-group",children:[e.jsx("div",{className:"character-dropdown-wrapper",children:e.jsx(ge,{characterBossSelections:t,selectedCharIdx:r,onCharacterChange:b,onRemoveCharacter:n,onCopyCharacter:c})}),e.jsx("div",{className:"character-creator-wrapper",children:e.jsx(ye,{newCharName:d,setNewCharName:p,onAddCharacter:y,characterBossSelections:t})})]}),e.jsx("div",{className:"crystal-tracker-wrapper",children:e.jsx(ke,{characterBossSelections:t})})]}),m&&e.jsx("div",{className:"character-management-error",children:m})]}),t.length===0?e.jsxs("div",{className:"no-characters-message",children:[e.jsx("div",{className:"no-characters-icon",children:e.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M16 7C16 9.20914 14.2091 11 12 11C9.79086 11 8 9.20914 8 7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7Z",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M12 14C8.13401 14 5 17.134 5 21H19C19 17.134 15.866 14 12 14Z",stroke:"currentColor",strokeWidth:"2"})]})}),e.jsx("h3",{children:"No Characters Yet"}),e.jsx("p",{children:"Create your first character to start configuring bosses and tracking your weekly progress."})]}):r===""||!o?e.jsxs("div",{className:"select-character-message",children:[e.jsx("div",{className:"select-character-icon",children:e.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("h3",{children:"Select a Character"}),e.jsx("p",{children:"Choose a character from the dropdown above to configure their boss selection."})]}):e.jsx(Ne,{characterBossSelections:t,selectedCharIdx:r,sortedBossData:q,toggleBoss:k,updatePartySize:z,onQuickSelectClick:M,getBossDifficulties:l,getAvailablePartySizes:v,formatPrice:x})]}),i&&e.jsx("div",{className:"crystal-cap-error-overlay",children:e.jsx("div",{className:"crystal-cap-error-message",children:"Crystal limit reached! Maximum 180 crystals allowed."})})]})}P.lazy(()=>X(()=>import("./DataBackup-B9OwR3F0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])));function Qe(){const{navigate:t}=oe(),{userCode:r,isLoggedIn:d,handleDeleteAccount:b}=de(),{characterBossSelections:y,setCharacterBossSelections:n,newCharName:p,setNewCharName:q,selectedCharIdx:k,cloneError:z,setCloneError:M,showUndo:l,undoData:v,fileInputRef:x,importError:f,setImportError:m,importSuccess:i,setImportSuccess:c,sortedBossData:o,getAvailablePartySizes:w,getBossDifficulties:D,handleCharacterChange:a,addCharacter:j,removeCharacter:h,handleUndo:g,toggleBoss:C,updateCharacterName:R,updatePartySize:Q,batchSetBosses:A,showCrystalCapError:L,isLoading:s,copyCharacter:S}=he(),[V,F]=P.useState(!1),[K,H]=P.useState(!1),[I,E]=P.useState(""),[O,U]=P.useState(!1),[Y,J]=P.useState(!1),$=xe();P.useEffect(()=>{d||t("/login",{replace:!0})},[d,t]);const ae=async()=>{try{const{exportUserData:u}=await X(async()=>{const{exportUserData:B}=await import("./utilityService-OetPi0cW.js");return{exportUserData:B}},__vite__mapDeps([4,5,3,6,1,2,7])),N=await u(r);if(N.success){const B=JSON.stringify(N.data,null,2),Z=new Blob([B],{type:"application/json"}),_=URL.createObjectURL(Z),W=document.createElement("a");W.href=_,W.download=`maplestory-boss-calc-backup-${new Date().toISOString().split("T")[0]}.json`,W.click(),URL.revokeObjectURL(_),c(!0),setTimeout(()=>c(!1),3e3)}else throw new Error(N.error)}catch(u){T.error("Export error:",u),m("Failed to export data. Please try again."),setTimeout(()=>m(""),5e3)}},ce=async u=>{const N=u.target.files[0];if(!N)return;const B=new FileReader;B.onload=async Z=>{try{const _=JSON.parse(Z.target.result),{importUserData:W}=await X(async()=>{const{importUserData:le}=await import("./utilityService-OetPi0cW.js");return{importUserData:le}},__vite__mapDeps([4,5,3,6,1,2,7])),se=await W(r,_);if(!se.success)throw new Error(se.error);c(!0),setTimeout(()=>{c(!1),window.location.reload()},2e3)}catch(_){T.error("Import error:",_),m(_.message||"Invalid data file. Please check the format and try again."),setTimeout(()=>m(""),5e3)}},B.readAsText(N)},re=async()=>{U(!0),E("");try{const u=await b();u.success?(H(!1),t("/login",{replace:!0})):E(u.error)}catch(u){E("Failed to delete account. Try again."),T.error("Delete error:",u)}finally{U(!1)}},ie=()=>o||[],ee=u=>{if(u>=1e9){const N=u/1e9;return N>=10?`${Math.round(N)}B`:`${N.toFixed(1)}B`}else if(u>=1e6){const N=u/1e6;return N>=10?`${Math.round(N)}M`:`${N.toFixed(1)}M`}else if(u>=1e3){const N=u/1e3;return N>=10?`${Math.round(N)}K`:`${N.toFixed(1)}K`}else return u.toString()},ne=()=>{J(!1),$.setQuickSelectBosses({}),$.setQuickSelectError("")};return e.jsxs("div",{className:"page-container",children:[e.jsx(me,{currentPage:"calculator",onExport:ae,onImport:ce,fileInputRef:x}),e.jsxs("div",{className:"page-header-container fade-in",children:[e.jsx("h1",{className:"page-title-main",children:"Character and Boss Configuration"}),k!==""&&y[k]&&e.jsx("div",{className:"boss-config-description",children:e.jsxs("p",{children:["Configure bosses, difficulties, and party sizes for ",e.jsx("strong",{children:y[k].name})]})})]}),f&&e.jsx("div",{className:"error-message-container",children:f}),i&&e.jsx("div",{className:"success-message-container",children:"Data backup operation successful!"}),e.jsx(ue,{children:s?e.jsx(je,{}):e.jsx(be,{characterBossSelections:y,selectedCharIdx:k,newCharName:p,handleCharacterChange:a,addCharacter:j,removeCharacter:h,setNewCharName:q,sortedBossData:o,toggleBoss:C,updatePartySize:Q,onQuickSelectClick:()=>J(!0),getBossDifficulties:D,getAvailablePartySizes:w,formatPrice:ee,totalBossCount:y.reduce((u,N)=>{var B;return u+(((B=N.bosses)==null?void 0:B.length)||0)},0),cloneError:z,showCrystalCapError:L,onCopyCharacter:S})}),l&&v&&e.jsxs("div",{className:"undo-snackbar",children:["Character deleted.",e.jsx("button",{onClick:g,className:"undo-btn",children:"Undo"})]}),V&&e.jsx("div",{className:"modal-backdrop",onClick:()=>F(!1),children:e.jsxs("div",{className:"modal-fade modal-content",onClick:u=>u.stopPropagation(),children:[e.jsx("button",{onClick:()=>F(!1),className:"modal-close-btn",title:"Close",children:"Ã—"}),e.jsx("h2",{className:"modal-title",children:"Help & FAQ"}),e.jsxs("div",{className:"modal-section-content",style:{marginBottom:24},children:[e.jsx("h3",{className:"modal-section-title",children:"Getting Started"}),e.jsx("p",{children:"1. Create an account or log in with your existing code"}),e.jsx("p",{children:"2. Add characters using the input field at the top"}),e.jsx("p",{children:"3. Select a character and choose their bosses & difficulties"}),e.jsx("p",{children:"4. Head to Weekly Tracker to mark completions and track pitched items!"})]}),e.jsxs("div",{className:"modal-section-content",style:{marginBottom:24},children:[e.jsx("h3",{className:"modal-section-title",children:"Boss Selection"}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"Quick Select:"})," Use Quick Select for easy boss setup"]}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"Party sizes:"})," Adjust party size for each boss to calculate split mesos"]}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"Clone characters:"})," Copy a character's entire boss setup instantly"]}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"Difficulty matters:"})," Higher difficulties = more mesos and pitched items"]})]}),e.jsxs("div",{className:"modal-section-content",style:{marginBottom:24},children:[e.jsx("h3",{className:"modal-section-title",children:"Data Management"}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"Auto-save:"})," All changes are automatically saved to the cloud"]}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"Export/Import:"})," Backup your data or transfer between devices"]}),e.jsxs("p",{children:["â€¢ ",e.jsx("strong",{children:"Smart cleanup:"})," Changing boss selections automatically cleans up old tracking data"]})]}),e.jsxs("div",{className:"modal-section-content",children:[e.jsx("h3",{className:"modal-section-title",children:"Quick Tips"}),e.jsx("p",{children:"â€¢ Click anywhere on a boss row to toggle selection"}),e.jsx("p",{children:"â€¢ Use Quick Select to efficiently set up your boss lists"}),e.jsx("p",{children:"â€¢ Your account code is your login - keep it safe!"}),e.jsx("p",{children:"â€¢ Check out the Boss Table page to see which bosses give the most mesos"})]})]})}),K&&e.jsx("div",{className:"modal-backdrop modal-backdrop-critical",onClick:()=>H(!1),children:e.jsxs("div",{className:"modal-fade modal-content-critical",onClick:u=>u.stopPropagation(),children:[e.jsx("div",{className:"critical-modal-icon",children:e.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z",stroke:"#fff",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("h2",{className:"critical-modal-title",children:"Delete Account"}),e.jsx("div",{className:"critical-modal-warning",children:e.jsxs("p",{children:[e.jsx("strong",{children:"This will permanently delete your account and all associated data."}),e.jsx("br",{}),"This action cannot be undone."]})}),e.jsxs("div",{className:"modal-button-container",children:[e.jsx("button",{onClick:()=>H(!1),disabled:O,className:"modal-btn-cancel",children:"Cancel"}),e.jsxs("button",{onClick:re,disabled:O,className:"modal-btn-critical",children:[O&&e.jsx("div",{className:"loading-spinner"}),O?"Deleting...":"Delete Forever"]})]}),I&&e.jsx("div",{className:"modal-error-message",children:I})]})}),e.jsx(fe,{show:Y,onClose:ne,quickSelectBosses:$.quickSelectBosses,quickSelectError:$.quickSelectError,getSortedBossesByPrice:ie,getBossDifficulties:D,formatPrice:ee,handleQuickSelectBoss:$.handleQuickSelectBoss,updateQuickSelectPartySize:$.updateQuickSelectPartySize,applyQuickSelection:()=>{$.applyQuickSelection(k,y,A),J(!1)},resetQuickSelection:$.resetQuickSelection,reuseLastQuickSelect:$.reuseLastQuickSelect,lastQuickSelectBosses:$.lastQuickSelectBosses,selectedCharIdx:k,characterBossSelections:y}),e.jsx("style",{children:`
        @keyframes modalFadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        @keyframes modalSlideIn {
          from {
            opacity: 0;
            transform: scale(0.8) translateY(20px);
          }
          to {
            opacity: 1;
            transform: scale(1) translateY(0);
          }
        }

        .crystal-cap-error-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100vw;
          height: 100vh;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 3000;
          pointer-events: none;
          padding: 1rem;
          box-sizing: border-box;
        }
        
        .crystal-cap-error-message {
          background: rgba(40, 32, 74, 0.97);
          color: #fff;
          font-size: 1.25rem;
          font-weight: 600;
          border-radius: 16px;
          box-shadow: 0 4px 32px rgba(128,90,213,0.18);
          padding: 1.5rem 2.5rem;
          border: 1.5px solid #a259f7;
          text-align: center;
          animation: modalFadeIn 0.3s cubic-bezier(.4,2,.6,1);
          letter-spacing: 0.5px;
          max-width: 90vw;
          width: auto;
          min-width: 300px;
        }

        /* Responsive design for crystal cap error */
        @media (min-width: 2560px) {
          .crystal-cap-error-message {
            font-size: 1.5rem;
            padding: 2rem 3rem;
            border-radius: 20px;
            min-width: 400px;
          }
        }

        @media (min-width: 1920px) and (max-width: 2559px) {
          .crystal-cap-error-message {
            font-size: 1.35rem;
            padding: 1.75rem 2.75rem;
            border-radius: 18px;
            min-width: 350px;
          }
        }

        @media (max-width: 1365px) and (min-width: 769px) {
          .crystal-cap-error-message {
            font-size: 1.1rem;
            padding: 1.25rem 2rem;
            min-width: 280px;
          }
        }

        @media (max-width: 768px) {
          .crystal-cap-error-overlay {
            padding: 0.5rem;
          }
          
          .crystal-cap-error-message {
            font-size: 1rem;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            min-width: 260px;
            max-width: 95vw;
            line-height: 1.4;
          }
        }

        @media (max-width: 480px) {
          .crystal-cap-error-overlay {
            padding: 0.25rem;
          }
          
          .crystal-cap-error-message {
            font-size: 0.9rem;
            padding: 0.75rem 1.25rem;
            border-radius: 10px;
            min-width: 240px;
            max-width: 98vw;
            line-height: 1.3;
          }
        }
      `})]})}export{Qe as default};
