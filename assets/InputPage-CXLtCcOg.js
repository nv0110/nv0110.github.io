const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DataBackup-C9IyGvrW.js","assets/vendor-ui-Dn8u3Dbm.js","assets/vendor-router-CSXoLnNI.js","assets/vendor-react-D5d5vywP.js","assets/pitched-data-service-DmmTGQCG.js","assets/vendor-supabase-_v2quReu.js","assets/weekUtils-BAOLi04i.js","assets/index-ChaJcBVv.js","assets/index-BwTbnssP.css","assets/supabaseClient-DawR2l69.js"])))=>i.map(i=>d[i]);
import{_ as B}from"./vendor-supabase-_v2quReu.js";import{j as e}from"./vendor-ui-Dn8u3Dbm.js";import{r as y}from"./vendor-router-CSXoLnNI.js";import{L as V,g as $,u as he,a as me,V as xe,b as fe}from"./index-ChaJcBVv.js";import{T as z,u as be,N as ye}from"./Navbar-DvaP8SwN.js";import{C as je}from"./CustomCheckbox-DjnElLTC.js";import"./vendor-react-D5d5vywP.js";import"./weekUtils-BAOLi04i.js";function ke(){const[s,d]=y.useState({}),[g,n]=y.useState("");return{quickSelectBosses:s,setQuickSelectBosses:d,quickSelectError:g,setQuickSelectError:n,handleQuickSelectBoss:(p,a)=>{const v=Object.keys(s).length;if(s[p])if(s[p]===a){const l={...s};delete l[p],d(l)}else d({...s,[p]:a});else{if(v>=14){n("Maximum 14 bosses can be selected"),setTimeout(()=>n(""),3e3);return}d({...s,[p]:a})}n("")},applyQuickSelection:(p,a,v)=>{if(p===null||!a[p]){n("Please select a character first"),setTimeout(()=>n(""),3e3);return}let l=Object.entries(s).map(([i,x])=>({name:i,difficulty:x,partySize:1}));const r=180-a.reduce((i,x,f)=>f===p?i:i+(x.bosses?x.bosses.length:0),0);if(l.length>r){try{const i=require("../data/bossData"),x=i.bossData;l=l.map(f=>({...f,price:i.getBossPrice(x.find(w=>w.name===f.name),f.difficulty)||0})),l.sort((f,w)=>(w.price||0)-(f.price||0))}catch(i){console.error("Error loading boss data for price sorting:",i)}l=l.slice(0,r),n(`Selection trimmed to stay within 180 crystal limit. Added ${r} ${r===1?"boss":"bosses"}.`),setTimeout(()=>n(""),5e3)}v(p,l),d({}),l.length||n("")},resetQuickSelection:()=>{d({}),n("")}}}function ve({onExport:s,onImport:d,onShowQuickSelect:g,fileInputRef:n}){return e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"10px",marginBottom:"0.5rem",flexWrap:"wrap"},children:[e.jsx(z,{text:"Export all character data as a backup file",children:e.jsxs("button",{onClick:s,style:{background:"#805ad5",color:"#fff",border:"none",borderRadius:"6px",padding:"0.5rem 1.2rem",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",transform:"translateY(0)"},onMouseOver:t=>{t.currentTarget.style.background="#9f7aea",t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 16px rgba(128, 90, 213, 0.4)"},onMouseOut:t=>{t.currentTarget.style.background="#805ad5",t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="none"},children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"Backup Data"]})}),e.jsx(z,{text:"Import character data from a backup file",children:e.jsxs("button",{onClick:()=>{var t;return(t=n.current)==null?void 0:t.click()},style:{background:"#a259f7",color:"#fff",border:"none",borderRadius:"6px",padding:"0.5rem 1.2rem",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",transform:"translateY(0)"},onMouseOver:t=>{t.currentTarget.style.background="#b470ff",t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 16px rgba(162, 89, 247, 0.4)"},onMouseOut:t=>{t.currentTarget.style.background="#a259f7",t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="none"},children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),"Restore Backup"]})}),e.jsx(z,{text:"Quick select up to 14 bosses sorted by highest price",children:e.jsxs("button",{onClick:g,style:{background:"#f56565",color:"#fff",border:"none",borderRadius:"6px",padding:"0.5rem 1.2rem",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",transform:"translateY(0)"},onMouseOver:t=>{t.currentTarget.style.background="#fc8181",t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 16px rgba(245, 101, 101, 0.4)"},onMouseOut:t=>{t.currentTarget.style.background="#f56565",t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="none"},children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M9 11H1l6-6 6 6"}),e.jsx("path",{d:"M9 17l3-3 3 3"}),e.jsx("path",{d:"M22 18.5V2l-5 5-5-5v16.5"})]}),"Quick Select"]})}),e.jsx("input",{type:"file",ref:n,onChange:d,accept:".json",style:{display:"none"}})]})}function we({name:s,onSave:d}){const[g,n]=y.useState(!1),[t,h]=y.useState(s),[m,p]=y.useState(!1);return g?e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",marginLeft:0,marginRight:4},children:[e.jsx("input",{value:t,onChange:a=>h(a.target.value),style:{fontSize:"0.95em",borderRadius:8,border:m?"1px solid #a259f7":"1px solid #4a4370",padding:"4px 8px",marginRight:4,minWidth:80,maxWidth:120,background:"#3a335a",color:"#e6e0ff",boxShadow:m?"0 0 0 2px rgba(162, 89, 247, 0.3), 0 0 10px rgba(255, 255, 255, 0.15)":"none",transition:"all 0.25s ease",outline:"none"},autoFocus:!0,onFocus:()=>p(!0),onBlur:()=>p(!1),onKeyDown:a=>{a.key==="Enter"&&(d(t),n(!1)),a.key==="Escape"&&(n(!1),h(s))}}),e.jsx("button",{style:{background:"#a259f7",color:"#fff",border:"none",borderRadius:8,padding:"4px 8px",marginRight:4,cursor:"pointer",fontSize:"0.95em",boxShadow:"0 2px 6px rgba(162, 89, 247, 0.3)",transition:"all 0.2s ease"},onClick:()=>{d(t),n(!1)},title:"Save",onMouseOver:a=>{a.currentTarget.style.background="#b47aff",a.currentTarget.style.transform="translateY(-1px)"},onMouseOut:a=>{a.currentTarget.style.background="#a259f7",a.currentTarget.style.transform="translateY(0)"},children:"✔"}),e.jsx("button",{style:{background:"transparent",color:"#a259f7",border:"1px solid #a259f7",borderRadius:8,padding:"4px 8px",cursor:"pointer",fontSize:"0.95em",transition:"all 0.2s ease"},onClick:()=>{n(!1),h(s)},title:"Cancel",onMouseOver:a=>{a.currentTarget.style.background="rgba(162, 89, 247, 0.1)"},onMouseOut:a=>{a.currentTarget.style.background="transparent"},children:"✖"})]}):e.jsx("button",{className:"character-name-edit-btn",title:"Edit character name",onClick:()=>n(!0),style:{background:"transparent",border:"none",color:"rgb(167 142 196)",cursor:"pointer",padding:"4px",borderRadius:4},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32px",height:"32px",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M20.548 3.452a1.542 1.542 0 0 1 0 2.182l-7.636 7.636-3.273 1.091 1.091-3.273 7.636-7.636a1.542 1.542 0 0 1 2.182 0zM4 21h15a1 1 0 0 0 1-1v-8a1 1 0 0 0-2 0v7H5V6h7a1 1 0 0 0 0-2H4a1 1 0 0 0-1 1v15a1 1 0 0 0 1 1z"})})})}function Se({characterBossSelections:s,newCharName:d,setNewCharName:g,selectedCharIdx:n,cloneError:t,onCharacterChange:h,onAddCharacter:m,onUpdateCharacterName:p,onCloneCharacter:a,onRemoveCharacter:v,showCrystalCapError:l}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"character-creation-container",children:[e.jsx("input",{type:"text",value:d,onChange:o=>g(o.target.value),placeholder:"Character name",className:"character-name-input",onKeyDown:o=>o.key==="Enter"&&m()}),e.jsx("button",{onClick:m,disabled:!d.trim()||s.length>=V.CHARACTER_CAP,className:"add-character-button",children:"Add Character"})]}),s.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"character-management-row",children:[t&&e.jsx("div",{className:"clone-error-message",children:t}),n!==null&&s[n]&&e.jsx(we,{name:s[n].name,onSave:o=>p(n,o)}),e.jsxs("select",{value:n??"",onChange:h,className:"character-select-dropdown",children:[e.jsx("option",{value:"",children:"Select a Character"}),s.map((o,r)=>e.jsx("option",{value:r,children:o.name},r))]}),n!==null&&e.jsxs(e.Fragment,{children:[e.jsx(z,{text:"Clone this character (max 180 crystals)",children:e.jsx("button",{className:"boton-elegante clone",onClick:()=>a(n),children:"Clone"})}),e.jsx(z,{text:"Delete this character",children:e.jsx("button",{className:"boton-elegante delete",onClick:()=>v(n),children:"Delete"})})]})]}),n!==null&&s[n]&&e.jsx("div",{className:"crystals-counter-container",children:l?e.jsx("div",{className:"crystals-cap-error-text",children:"Cannot exceed 180 crystal limit"}):(()=>{const o=s.reduce((r,i)=>r+(i.bosses?i.bosses.length:0),0);return o===180?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"crystals-counter-main crystals-counter-max",children:e.jsx("span",{className:"crystals-counter-number-max",children:"180"})}),e.jsx("div",{className:"crystals-counter-label",children:"Total Crystals"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"crystals-counter-main",children:[e.jsx("span",{className:"crystals-counter-number",children:o}),e.jsx("span",{className:"crystals-counter-total",children:" / 180"})]}),e.jsx("div",{className:"crystals-counter-label",children:"Total Crystals"})]})})()})]})]})}function Ce({selectedCharIdx:s,characterBossSelections:d,sortedBossData:g,getBossDifficulties:n,getAvailablePartySizes:t,onToggleBoss:h,onUpdatePartySize:m}){var p;return s===null||!d[s]?e.jsx("div",{className:"input-boss-empty-state",children:"Select a character to manage their bosses."}):e.jsx("div",{className:"input-boss-container",children:e.jsxs("div",{className:"input-boss-wrapper",children:[e.jsx("div",{className:"input-boss-header-container",children:e.jsx("table",{className:"input-boss-table input-boss-header",children:e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"input-boss-col-boss",children:"Boss"}),e.jsx("th",{className:"input-boss-col-difficulty",children:"Difficulty"}),e.jsx("th",{className:"input-boss-col-mesos",children:"Mesos"}),e.jsx("th",{className:"input-boss-col-controls",children:((p=d[s])==null?void 0:p.name)||"Selected Character"})]})})})}),e.jsx("div",{className:"input-boss-body-container",children:e.jsx("table",{className:"input-boss-table input-boss-body",children:e.jsx("tbody",{children:g.map((a,v)=>{var r;const l=n(a),o=(r=d[s])==null?void 0:r.bosses.find(i=>i.name===a.name);return e.jsxs("tr",{className:"input-boss-row",onClick:i=>{!i.target.closest("select")&&!i.target.closest(".checkbox-wrapper")&&!i.target.closest("input")&&(o?h(s,a.name,""):h(s,a.name,l[0]))},children:[e.jsxs("td",{className:"input-boss-cell-boss",children:[a.image&&e.jsx("img",{src:a.image,alt:a.name,loading:"lazy",className:"input-boss-img"}),e.jsx("span",{className:"input-boss-name",children:a.name})]}),e.jsx("td",{className:"input-boss-cell-difficulty",children:e.jsx("span",{className:"input-boss-difficulty-text",children:o?o.difficulty:""})}),e.jsx("td",{className:"input-boss-cell-mesos",children:e.jsx("span",{className:"input-boss-mesos-amount",children:o?Math.floor($(a,o.difficulty)/(o.partySize||1)).toLocaleString():""})}),e.jsx("td",{className:"input-boss-cell-controls",children:e.jsxs("div",{className:"input-boss-controls",children:[e.jsx(je,{checked:!!o,onChange:()=>{o?h(s,a.name,""):h(s,a.name,l[0])}}),o&&e.jsxs(e.Fragment,{children:[e.jsx("select",{className:"input-boss-difficulty-select",value:o.difficulty,onChange:i=>{h(s,a.name,i.target.value)},children:l.map(i=>e.jsx("option",{value:i,children:i},i))}),e.jsx("select",{className:"input-boss-party-select",value:o.partySize||1,onChange:i=>{m(s,a.name,o.difficulty,parseInt(i.target.value))},children:t(a.name,o.difficulty).map(i=>e.jsx("option",{value:i,children:i},i))})]})]})})]},v)})})})})]})})}function Te({show:s,onClose:d,quickSelectBosses:g,quickSelectError:n,getSortedBossesByPrice:t,getBossDifficulties:h,formatPrice:m,handleQuickSelectBoss:p,applyQuickSelection:a,resetQuickSelection:v,selectedCharIdx:l,characterBossSelections:o}){return s?e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(40,32,74,0.95)",zIndex:4e3,display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(8px)"},onClick:d,children:e.jsxs("div",{className:"modal-fade",style:{background:"linear-gradient(145deg, #1a1730, #2d2540)",borderRadius:16,padding:"2rem",maxWidth:600,width:"90%",maxHeight:"90vh",overflowY:"auto",color:"#e6e0ff",boxShadow:"0 20px 60px rgba(0,0,0,0.4), 0 8px 32px rgba(162, 89, 247, 0.15)",position:"relative",border:"1px solid rgba(162, 89, 247, 0.2)"},onClick:r=>r.stopPropagation(),children:[e.jsx("button",{onClick:d,style:{position:"absolute",top:16,right:16,background:"transparent",color:"#fff",border:"none",fontSize:"1.5rem",cursor:"pointer",outline:"none",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",borderRadius:8},title:"Close",onMouseOver:r=>{r.currentTarget.style.background="rgba(255, 255, 255, 0.1)",r.currentTarget.style.color="#ff6b6b"},onMouseOut:r=>{r.currentTarget.style.background="transparent",r.currentTarget.style.color="#fff"},children:"×"}),e.jsx("div",{style:{width:80,height:80,background:"linear-gradient(135deg, #00d4aa, #01b4cc)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 24px",boxShadow:"0 8px 32px rgba(0, 212, 170, 0.3)"},children:e.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 12l2 2 4-4M21 12a9 9 0 11-18 0 9 9 0 0118 0z",stroke:"#fff",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("h2",{style:{color:"#00d4aa",fontWeight:700,marginBottom:8,fontSize:"1.8rem",textAlign:"center"},children:"Quick Boss Selection"}),e.jsx("p",{style:{textAlign:"center",marginBottom:24,color:"#b39ddb",fontSize:"1rem"},children:"Select up to 14 bosses sorted by highest price"}),e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(0, 212, 170, 0.15), rgba(1, 180, 204, 0.1))",border:"2px solid rgba(0, 212, 170, 0.3)",borderRadius:12,padding:"16px",marginBottom:24,textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"2rem",fontWeight:700,color:"#00d4aa",marginBottom:4},children:[Object.keys(g).length," / 14"]}),e.jsx("div",{style:{fontSize:"0.9rem",color:"#c4b5d4"},children:"Bosses Selected"})]}),n&&e.jsx("div",{style:{color:"#ff6b6b",fontSize:"0.9rem",background:"rgba(255, 107, 107, 0.1)",border:"1px solid rgba(255, 107, 107, 0.3)",borderRadius:6,padding:"8px 12px",marginBottom:16,textAlign:"center"},children:n}),e.jsx("div",{style:{marginBottom:24},children:e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:16,maxHeight:"400px",overflowY:"auto",padding:"8px"},children:t().map((r,i)=>{const x=!!g[r.name],f=g[r.name],w=h(r);return e.jsxs("div",{style:{background:x?"linear-gradient(135deg, rgba(0, 212, 170, 0.15), rgba(1, 180, 204, 0.1))":"linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02))",borderRadius:12,padding:"16px",border:x?"2px solid rgba(0, 212, 170, 0.4)":"1px solid rgba(255, 255, 255, 0.1)",transition:"all 0.2s ease",boxShadow:x?"0 4px 16px rgba(0, 212, 170, 0.2)":"0 2px 8px rgba(0, 0, 0, 0.1)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:12,marginBottom:16},children:[e.jsxs("div",{style:{fontSize:"0.9rem",fontWeight:700,color:"#00d4aa",minWidth:"28px",textAlign:"center"},children:["#",i+1]}),r.image&&e.jsx("img",{src:r.image,alt:r.name,style:{width:40,height:40,objectFit:"contain",borderRadius:6,background:"#fff1"}}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontWeight:600,fontSize:"1.1rem",color:"#e6e0ff"},children:r.name}),e.jsxs("div",{style:{fontSize:"0.85rem",color:"#b39ddb"},children:["Max: ",m(r.maxPrice)]})]})]}),e.jsx("div",{style:{display:"flex",gap:8,justifyContent:"center",flexWrap:"wrap"},children:w.map(T=>{const j=f===T,W=$(r,T);return e.jsxs("button",{onClick:()=>p(r.name,T),style:{background:j?"linear-gradient(135deg, #00d4aa, #01b4cc)":"linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.05))",color:j?"#fff":"#e6e0ff",border:j?"2px solid #00d4aa":"2px solid rgba(255, 255, 255, 0.15)",borderRadius:8,padding:"12px 20px",cursor:"pointer",fontSize:"0.95rem",fontWeight:600,transition:"all 0.2s ease",minWidth:"120px",minHeight:"50px",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"4px",boxShadow:j?"0 4px 16px rgba(0, 212, 170, 0.3)":"0 2px 8px rgba(0, 0, 0, 0.1)"},onMouseOver:k=>{j||(k.currentTarget.style.background="linear-gradient(135deg, rgba(0, 212, 170, 0.15), rgba(1, 180, 204, 0.1))",k.currentTarget.style.borderColor="rgba(0, 212, 170, 0.4)",k.currentTarget.style.transform="translateY(-1px)",k.currentTarget.style.boxShadow="0 4px 16px rgba(0, 212, 170, 0.2)")},onMouseOut:k=>{j||(k.currentTarget.style.background="linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.05))",k.currentTarget.style.borderColor="rgba(255, 255, 255, 0.15)",k.currentTarget.style.transform="translateY(0)",k.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.1)")},children:[e.jsx("div",{style:{fontSize:"1rem",fontWeight:700},children:T}),e.jsx("div",{style:{fontSize:"0.8rem",opacity:.9},children:m(W)})]},T)})})]},r.name)})})}),e.jsxs("div",{style:{display:"flex",gap:16,justifyContent:"center"},children:[e.jsx("button",{onClick:v,style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05))",color:"#e6e0ff",border:"2px solid rgba(255, 255, 255, 0.2)",borderRadius:12,padding:"0.8rem 2rem",fontWeight:700,fontSize:"1.1rem",cursor:"pointer",transition:"all 0.2s ease",minWidth:140},onMouseOver:r=>{r.currentTarget.style.background="linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.08))",r.currentTarget.style.borderColor="rgba(255, 255, 255, 0.3)",r.currentTarget.style.transform="translateY(-1px)"},onMouseOut:r=>{r.currentTarget.style.background="linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05))",r.currentTarget.style.borderColor="rgba(255, 255, 255, 0.2)",r.currentTarget.style.transform="translateY(0)"},children:"Clear All"}),e.jsxs("button",{onClick:a,disabled:Object.keys(g).length===0||l===null,style:{background:Object.keys(g).length===0||l===null?"linear-gradient(135deg, #555, #444)":"linear-gradient(135deg, #00d4aa, #01b4cc)",color:"#fff",border:"none",borderRadius:12,padding:"0.8rem 2rem",fontWeight:700,fontSize:"1.1rem",cursor:Object.keys(g).length===0||l===null?"not-allowed":"pointer",opacity:Object.keys(g).length===0||l===null?.5:1,minWidth:140,transition:"all 0.2s ease",boxShadow:Object.keys(g).length>0&&l!==null?"0 4px 16px rgba(0, 212, 170, 0.3)":"none"},onMouseOver:r=>{Object.keys(g).length>0&&l!==null&&(r.currentTarget.style.background="linear-gradient(135deg, #00e6c0, #01c8de)",r.currentTarget.style.transform="translateY(-1px)",r.currentTarget.style.boxShadow="0 6px 20px rgba(0, 212, 170, 0.4)")},onMouseOut:r=>{Object.keys(g).length>0&&l!==null&&(r.currentTarget.style.background="linear-gradient(135deg, #00d4aa, #01b4cc)",r.currentTarget.style.transform="translateY(0)",r.currentTarget.style.boxShadow="0 4px 16px rgba(0, 212, 170, 0.3)")},children:["Apply to ",l!==null&&o[l]?o[l].name:"Character"]})]}),l===null&&e.jsx("div",{style:{textAlign:"center",marginTop:12,fontSize:"0.85rem",color:"#9d8bbc"},children:"Please select a character first to apply the boss selection"})]})}):null}y.lazy(()=>B(()=>import("./DataBackup-C9IyGvrW.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])));function We(){const{navigate:s}=be(),{userCode:d,isLoggedIn:g,handleDeleteAccount:n}=he(),{characterBossSelections:t,setCharacterBossSelections:h,newCharName:m,setNewCharName:p,selectedCharIdx:a,error:v,cloneError:l,setCloneError:o,showUndo:r,undoData:i,fileInputRef:x,importError:f,setImportError:w,importSuccess:T,setImportSuccess:j,sortedBossData:W,getAvailablePartySizes:k,getBossDifficulties:F,handleCharacterChange:I,addCharacter:K,removeCharacter:J,handleUndo:G,toggleBoss:q,updateCharacterName:X,updatePartySize:Z,batchSetBosses:ee,showCrystalCapError:te}=me(),[re,P]=y.useState(!1),[ae,R]=y.useState(!1),[Y,Q]=y.useState(""),[A,H]=y.useState(!1),[se,L]=y.useState(!1),N=ke();y.useEffect(()=>{g||s("/login",{replace:!0})},[g,s]);const ne=async()=>{try{const{exportUserData:u}=await B(async()=>{const{exportUserData:b}=await import("./pitched-data-service-DmmTGQCG.js");return{exportUserData:b}},__vite__mapDeps([4,5,3,6,7,1,2,8])),c=await u(d);if(c.success){const b=JSON.stringify(c.data,null,2),M=new Blob([b],{type:"application/json"}),C=URL.createObjectURL(M),D=document.createElement("a");D.href=C,D.download=`maplestory-boss-calc-backup-${new Date().toISOString().split("T")[0]}.json`,D.click(),URL.revokeObjectURL(C),j(!0),setTimeout(()=>j(!1),3e3)}else throw new Error(c.error)}catch(u){console.error("Export error:",u),w("Failed to export data. Please try again."),setTimeout(()=>w(""),5e3)}},oe=async u=>{const c=u.target.files[0];if(!c)return;const b=new FileReader;b.onload=async M=>{try{const C=JSON.parse(M.target.result),{importUserData:D}=await B(async()=>{const{importUserData:S}=await import("./pitched-data-service-DmmTGQCG.js");return{importUserData:S}},__vite__mapDeps([4,5,3,6,7,1,2,8])),O=await D(d,C);if(!O.success)throw new Error(O.error);j(!0),setTimeout(()=>{j(!1),window.location.reload()},2e3)}catch(C){console.error("Import error:",C),w(C.message||"Invalid data file. Please check the format and try again."),setTimeout(()=>w(""),5e3)}},b.readAsText(c)},ie=async u=>{if(t.length>=V.CHARACTER_CAP){o("Cannot clone: Maximum character limit reached"),setTimeout(()=>o(""),3e3);return}const c=t[u];if(!c){console.error("🔄 CLONE: Character to clone not found at index:",u);return}const b=t.reduce((S,E)=>S+(E.bosses?E.bosses.length:0),0),M=c.bosses?c.bosses.length:0;if(b+M>180){o("Cannot clone: Would exceed 180 crystal limit"),setTimeout(()=>o(""),3e3);return}const C=t.length>0?Math.max(...t.map(S=>S.index||0))+1:0,D={...c,name:`${c.name} (Copy)`,index:C,bosses:[...c.bosses||[]]},O=[...t,D];h(O);try{const{supabase:S}=await B(async()=>{const{supabase:pe}=await import("./supabaseClient-DawR2l69.js");return{supabase:pe}},__vite__mapDeps([9,5,3])),{data:E,error:_}=await S.from("user_data").select("data").eq("id",d).single();if(_&&_.code!=="PGRST116")throw _;const ge={...(E==null?void 0:E.data)||{},characterBossSelections:O,lastUpdated:new Date().toISOString()},{error:U}=await S.from("user_data").update({data:ge}).eq("id",d);if(U)throw U;console.log("✅ CLONE: Character successfully cloned and saved to database")}catch(S){console.error("❌ CLONE: Error saving cloned character to database:",S),o("Failed to save cloned character to database"),setTimeout(()=>o(""),3e3),h(t)}},le=async()=>{H(!0),Q("");try{const u=await n();u.success?(R(!1),s("/login",{replace:!0})):Q(u.error)}catch(u){Q("Failed to delete account. Try again."),console.error("Delete error:",u)}finally{H(!1)}},ce=()=>fe.map(c=>{const b=Math.max(...c.difficulties.map(M=>M.price));return{...c,maxPrice:b}}).sort((c,b)=>b.maxPrice-c.maxPrice),de=u=>{if(u>=1e9){const c=u/1e9;return c>=10?`${Math.round(c)}B`:`${c.toFixed(1)}B`}else if(u>=1e6){const c=u/1e6;return c>=10?`${Math.round(c)}M`:`${c.toFixed(1)}M`}else if(u>=1e3){const c=u/1e3;return c>=10?`${Math.round(c)}K`:`${c.toFixed(1)}K`}else return u.toString()},ue=()=>{L(!1),N.setQuickSelectBosses({}),N.setQuickSelectError("")};return e.jsxs("div",{className:"page-container",children:[e.jsx(ye,{currentPage:"calculator",onShowHelp:()=>P(!0),onShowDeleteConfirm:()=>R(!0)}),e.jsxs("div",{className:"page-header-container fade-in",children:[e.jsx("h1",{className:"page-title-main",children:"Character and Boss Configuration"}),e.jsx("p",{className:"page-description",children:"Create characters, configure boss difficulties and party sizes for your weekly runs"}),e.jsx(ve,{onExport:ne,onImport:oe,onShowPresets:void 0,onShowQuickSelect:()=>L(!0),fileInputRef:x})]}),f&&e.jsx("div",{className:"error-message-container",children:f}),T&&e.jsx("div",{className:"success-message-container",children:"Data backup operation successful!"}),e.jsx(xe,{children:e.jsxs("div",{className:"table-container premium-content-container input-page-container fade-in",children:[e.jsx(Se,{characterBossSelections:t,newCharName:m,setNewCharName:p,selectedCharIdx:a,cloneError:l,onCharacterChange:I,onAddCharacter:K,onUpdateCharacterName:X,onCloneCharacter:ie,onRemoveCharacter:J,showCrystalCapError:te}),t.length===0?e.jsxs("div",{className:"empty-state-message",children:[e.jsx("span",{role:"img","aria-label":"sparkles",children:"✨"})," Welcome! Add your first character to get started."]}):e.jsx(Ce,{selectedCharIdx:a,characterBossSelections:t,sortedBossData:W,getBossDifficulties:F,getAvailablePartySizes:k,onToggleBoss:q,onUpdatePartySize:Z})]})}),r&&i&&e.jsxs("div",{className:"undo-snackbar",children:["Character deleted.",e.jsx("button",{onClick:G,className:"undo-btn",children:"Undo"})]}),re&&e.jsx("div",{className:"modal-backdrop",onClick:()=>P(!1),children:e.jsxs("div",{className:"modal-fade modal-content",onClick:u=>u.stopPropagation(),children:[e.jsx("button",{onClick:()=>P(!1),className:"modal-close-btn",title:"Close",children:"×"}),e.jsx("h2",{className:"modal-title",children:"Help & FAQ"}),e.jsxs("div",{className:"modal-section-content",style:{marginBottom:24},children:[e.jsx("h3",{className:"modal-section-title",children:"Getting Started"}),e.jsx("p",{children:"1. Create an account or log in with your existing code"}),e.jsx("p",{children:"2. Add characters using the input field at the top"}),e.jsx("p",{children:"3. Select a character and choose their bosses & difficulties"}),e.jsx("p",{children:"4. Head to Weekly Tracker to mark completions and track pitched items!"})]}),e.jsxs("div",{className:"modal-section-content",style:{marginBottom:24},children:[e.jsx("h3",{className:"modal-section-title",children:"Boss Selection"}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Quick Select:"})," Use Quick Select for easy boss setup"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Party sizes:"})," Adjust party size for each boss to calculate split mesos"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Clone characters:"})," Copy a character's entire boss setup instantly"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Difficulty matters:"})," Higher difficulties = more mesos and pitched items"]})]}),e.jsxs("div",{className:"modal-section-content",style:{marginBottom:24},children:[e.jsx("h3",{className:"modal-section-title",children:"Data Management"}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Auto-save:"})," All changes are automatically saved to the cloud"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Export/Import:"})," Backup your data or transfer between devices"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Smart cleanup:"})," Changing boss selections automatically cleans up old tracking data"]})]}),e.jsxs("div",{className:"modal-section-content",children:[e.jsx("h3",{className:"modal-section-title",children:"Quick Tips"}),e.jsx("p",{children:"• Click anywhere on a boss row to toggle selection"}),e.jsx("p",{children:"• Use Quick Select to efficiently set up your boss lists"}),e.jsx("p",{children:"• Your account code is your login - keep it safe!"}),e.jsx("p",{children:"• Check out the Boss Table page to see which bosses give the most mesos"})]})]})}),ae&&e.jsx("div",{className:"modal-backdrop modal-backdrop-critical",onClick:()=>R(!1),children:e.jsxs("div",{className:"modal-fade modal-content-critical",onClick:u=>u.stopPropagation(),children:[e.jsx("div",{className:"critical-modal-icon",children:e.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z",stroke:"#fff",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("h2",{className:"critical-modal-title",children:"Delete Account"}),e.jsx("div",{className:"critical-modal-warning",children:e.jsxs("p",{children:[e.jsx("strong",{children:"This will permanently delete your account and all associated data."}),e.jsx("br",{}),"This action cannot be undone."]})}),e.jsxs("div",{className:"modal-button-container",children:[e.jsx("button",{onClick:()=>R(!1),disabled:A,className:"modal-btn-cancel",children:"Cancel"}),e.jsxs("button",{onClick:le,disabled:A,className:"modal-btn-critical",children:[A&&e.jsx("div",{className:"loading-spinner"}),A?"Deleting...":"Delete Forever"]})]}),Y&&e.jsx("div",{className:"modal-error-message",children:Y})]})}),e.jsx(Te,{show:se,onClose:ue,quickSelectBosses:N.quickSelectBosses,quickSelectError:N.quickSelectError,getSortedBossesByPrice:ce,getBossDifficulties:F,formatPrice:de,handleQuickSelectBoss:N.handleQuickSelectBoss,applyQuickSelection:()=>{N.applyQuickSelection(a,t,ee),L(!1)},resetQuickSelection:N.resetQuickSelection,selectedCharIdx:a,characterBossSelections:t}),e.jsx("style",{children:`
        @keyframes modalFadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        @keyframes modalSlideIn {
          from {
            opacity: 0;
            transform: scale(0.8) translateY(20px);
          }
          to {
            opacity: 1;
            transform: scale(1) translateY(0);
          }
        }

        .crystal-cap-error-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100vw;
          height: 100vh;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 3000;
          pointer-events: none;
        }
        .crystal-cap-error-message {
          background: rgba(40, 32, 74, 0.97);
          color: #fff;
          font-size: 1.25rem;
          font-weight: 600;
          border-radius: 16px;
          box-shadow: 0 4px 32px rgba(128,90,213,0.18);
          padding: 1.5rem 2.5rem;
          border: 1.5px solid #a259f7;
          text-align: center;
          animation: modalFadeIn 0.3s cubic-bezier(.4,2,.6,1);
          letter-spacing: 0.5px;
        }
      `})]})}export{We as default};
