const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DataBackup-EsfoEf1a.js","assets/vendor-ui-aK89YfOw.js","assets/vendor-router-Cg8TMqY4.js","assets/vendor-react-eWEExxYH.js","assets/utilityService-DPFdy0eV.js","assets/vendor-supabase-B7S7y5aO.js","assets/index-C6aA6tse.js","assets/index-RHCjBdfQ.css"])))=>i.map(i=>d[i]);
import{_ as ce}from"./vendor-supabase-B7S7y5aO.js";import{j as e}from"./vendor-ui-aK89YfOw.js";import{r as N}from"./vendor-router-Cg8TMqY4.js";import{l as U,L as I,a as ne,u as le,b as oe,N as de,V as he}from"./index-C6aA6tse.js";import{getBossPrice as ee}from"./bossRegistryService-9PyXGuqB.js";import{C as me}from"./CustomCheckbox-C2-rm8qf.js";import"./vendor-react-eWEExxYH.js";function ue(){const[t,c]=N.useState({}),[o,S]=N.useState({}),[D,n]=N.useState("");return{quickSelectBosses:t,setQuickSelectBosses:c,lastQuickSelectBosses:o,quickSelectError:D,setQuickSelectError:n,handleQuickSelectBoss:(m,k,d=1)=>{const j=Object.keys(t).length;if(t[m])if(t[m].difficulty===k){const p={...t};delete p[m],c(p)}else c({...t,[m]:{difficulty:k,partySize:t[m].partySize||d}});else{if(j>=14){n("Maximum 14 bosses can be selected"),setTimeout(()=>n(""),3e3);return}c({...t,[m]:{difficulty:k,partySize:d}})}n("")},updateQuickSelectPartySize:(m,k)=>{t[m]&&c({...t,[m]:{...t[m],partySize:k}})},reuseLastQuickSelect:()=>{if(Object.keys(o).length===0){n("No previous quick select settings to reuse"),setTimeout(()=>n(""),3e3);return}U.info("QuickSelect: Reusing last quick select settings",{bossCount:Object.keys(o).length,bosses:Object.keys(o)}),c({...o}),n("")},applyQuickSelection:(m,k,d)=>{if(m===null||!k[m]){n("Please select a character first"),setTimeout(()=>n(""),3e3);return}Object.keys(t).length>0&&(S({...t}),U.info("QuickSelect: Storing selection for reuse",{bossCount:Object.keys(t).length}));let j=Object.entries(t).map(([l,i])=>({name:l,difficulty:i.difficulty,partySize:i.partySize||1}));const r=180-k.reduce((l,i,v)=>v===m?l:l+(i.bosses?i.bosses.length:0),0);if(j.length>r){try{const l=require("../data/bossData"),i=l.bossData;j=j.map(v=>({...v,price:l.getBossPrice(i.find(M=>M.name===v.name),v.difficulty)||0})),j.sort((v,M)=>(M.price||0)-(v.price||0))}catch(l){U.error("Error loading boss data for price sorting:",l)}j=j.slice(0,r),n(`Selection trimmed to stay within 180 crystal limit. Added ${r} ${r===1?"boss":"bosses"}.`),setTimeout(()=>n(""),5e3)}d(m,j),c({}),j.length||n("")},resetQuickSelection:()=>{c({}),n("")}}}function pe({show:t,onClose:c,quickSelectBosses:o,quickSelectError:S,getSortedBossesByPrice:D,getBossDifficulties:n,formatPrice:h,handleQuickSelectBoss:b,updateQuickSelectPartySize:L,applyQuickSelection:A,resetQuickSelection:B,reuseLastQuickSelect:m,lastQuickSelectBosses:k,selectedCharIdx:d,characterBossSelections:j}){var R;const[p,r]=N.useState({show:!1,boss:null,difficulty:null}),[l,i]=N.useState(!1),[v,M]=N.useState(0),P=Object.keys(o).length;if(N.useEffect(()=>{P===14&&v<14?i(!0):P<14&&i(!1),M(P)},[P,v]),N.useEffect(()=>{t?(i(P===14),M(P)):i(!1)},[t,P]),!t)return null;const J=()=>{A(),i(!1)},Z=()=>{i(!1)},se=s=>{s.target.classList.contains("quick-select-instant-apply")&&i(!1)},a=(s,x)=>{$(s)===x?b(s,null):b(s,x)},g=(s,x)=>{if(x.target.closest(".quick-select-difficulty-option")||x.target.closest(".quick-select-party-indicator"))return;const Q=s.name,F=$(Q),w=n(s).sort((O,z)=>{const W=ee(s,O);return ee(s,z)-W});if(!F)b(Q,w[0]);else{const O=w.indexOf(F);O===-1?b(Q,w[0]):O===w.length-1?b(Q,null):b(Q,w[O+1])}},u=(s,x)=>{r({show:!0,boss:s,difficulty:x})},y=s=>{const{boss:x}=p;L(x.name,s)},q=()=>{r({show:!1,boss:null,difficulty:null})},_=()=>{r({show:!1,boss:null,difficulty:null})},T=s=>[1,2,3,4,5,6],E=s=>{var x;return((x=o[s])==null?void 0:x.partySize)||1},$=s=>{var x;return(x=o[s])==null?void 0:x.difficulty};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"quick-select-overlay",onClick:c,children:e.jsxs("div",{className:"quick-select-modal",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{onClick:c,className:"quick-select-close-btn",title:"Close",children:"×"}),e.jsxs("div",{className:"quick-select-header",children:[e.jsx("h1",{className:"quick-select-title",children:"Quick Boss Selection"}),e.jsx("p",{className:"quick-select-subtitle",children:"Select up to 14 bosses • Click cards to cycle difficulties • Click party size to adjust"})]}),e.jsxs("div",{className:"quick-select-progress",style:{"--progress-width":`${P/14*100}%`},children:[e.jsx("div",{className:"quick-select-progress-bar"}),e.jsxs("div",{className:"quick-select-progress-content",children:[e.jsx("div",{className:`quick-select-count ${P===14?"complete":"partial"}`,children:P}),e.jsx("div",{className:"quick-select-total",children:"/ 14"})]}),e.jsx("div",{className:"quick-select-label",children:"Bosses Selected"})]}),S&&e.jsx("div",{className:"quick-select-error",children:S}),e.jsx("div",{className:"quick-select-grid",children:D().map((s,x)=>{const Q=!!o[s.name],F=$(s.name),Y=n(s),w=E(s.name),O=Y.sort((z,W)=>{const K=ee(s,z);return ee(s,W)-K});return e.jsxs("div",{className:`quick-select-boss-card ${Q?"selected":"unselected"}`,onClick:z=>g(s,z),style:{cursor:"pointer"},title:Q?"Click to cycle through difficulties or unselect":"Click to select with highest difficulty",children:[Q&&e.jsx("div",{className:"quick-select-party-indicator",onClick:z=>{z.stopPropagation(),u(s,F)},title:`Party Size: ${w}`,children:w}),e.jsxs("div",{className:"quick-select-boss-info",children:[s.image&&e.jsx("div",{className:"quick-select-boss-image",children:e.jsx("img",{src:s.image,alt:s.name})}),e.jsxs("div",{className:"quick-select-boss-details",children:[e.jsx("div",{className:"quick-select-boss-name",children:s.name}),e.jsxs("div",{className:"quick-select-boss-price",children:["Max: ",h(s.maxPrice)]})]})]}),e.jsxs("div",{className:"quick-select-difficulties",children:[e.jsx("div",{className:"quick-select-difficulty-label",children:"Choose Difficulty"}),e.jsx("div",{className:"quick-select-difficulty-inline",children:O.map((z,W)=>{const K=F===z;ee(s,z);const G=W===0;return e.jsx("button",{onClick:te=>{te.stopPropagation(),a(s.name,z)},className:`quick-select-difficulty-option ${K?"selected":""} ${G?"most-expensive":""}`,children:e.jsx("span",{className:"difficulty-text",children:z})},z)})})]})]},s.name)})}),e.jsxs("div",{className:"quick-select-actions",children:[e.jsx("button",{onClick:B,className:"quick-select-action-btn quick-select-clear-btn",children:"Clear All"}),e.jsxs("button",{onClick:m,disabled:Object.keys(k).length===0,className:`quick-select-action-btn quick-select-reuse-btn ${Object.keys(k).length===0?"disabled":"enabled"}`,title:"Reuse last quick select settings",children:[e.jsxs("svg",{className:"quick-select-reuse-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 12a9 9 0 11-6.219-8.56"}),e.jsx("path",{d:"M15 4.5l.5-.5L16 3h-4v4l1-1"}),e.jsx("path",{d:"M12 8v4l3 3"})]}),"Reuse Last"]}),e.jsxs("button",{onClick:A,disabled:P===0||d===null,className:`quick-select-action-btn quick-select-apply-btn ${P===0||d===null?"disabled":"enabled"}`,children:["Apply to ",d!==null&&j[d]?j[d].name:"Character"]})]}),d===null&&e.jsx("div",{className:"quick-select-helper",children:"Please select a character first to apply the boss selection"}),l&&d!==null&&e.jsx("div",{className:`quick-select-instant-apply ${l?"show":""}`,onClick:se,children:e.jsxs("div",{className:"quick-select-instant-apply-content",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"quick-select-instant-apply-icon",children:"🎉"}),e.jsx("div",{className:"quick-select-instant-apply-title",children:"Perfect Selection!"}),e.jsx("div",{className:"quick-select-instant-apply-subtitle",children:"You've selected 14 bosses - ready to apply?"}),e.jsxs("div",{className:"quick-select-instant-apply-actions",children:[e.jsx("button",{onClick:J,className:"quick-select-instant-apply-btn primary",children:"Apply Now"}),e.jsx("button",{onClick:Z,className:"quick-select-instant-apply-btn secondary",children:"Keep Selecting"})]})]})})]})}),p.show&&e.jsx("div",{className:"party-size-modal-overlay",onClick:_,children:e.jsxs("div",{className:"party-size-modal",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"party-size-modal-title",children:"Party Size"}),e.jsxs("div",{className:"party-size-modal-subtitle",children:["Select party size for ",(R=p.boss)==null?void 0:R.name]}),e.jsx("div",{className:"party-size-options",children:T(p.boss).map(s=>{var x;return e.jsx("button",{onClick:()=>y(s),className:`party-size-option ${E((x=p.boss)==null?void 0:x.name)===s?"selected":""}`,children:s},s)})}),e.jsxs("div",{className:"party-size-modal-actions",children:[e.jsx("button",{onClick:q,className:"party-size-modal-btn primary",children:"Confirm"}),e.jsx("button",{onClick:_,className:"party-size-modal-btn secondary",children:"Cancel"})]})]})})]})}function xe(){return e.jsx("div",{className:"page-loader",children:e.jsx("div",{className:"loading-spinner"})})}function fe({characterBossSelections:t,selectedCharIdx:c,onCharacterChange:o,onRemoveCharacter:S,onCopyCharacter:D}){const[n,h]=N.useState(!1),[b,L]=N.useState(!1),A=N.useRef(null);N.useEffect(()=>{const r=l=>{A.current&&!A.current.contains(l.target)&&h(!1)};if(n)return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[n]),N.useEffect(()=>{const r=l=>{l.key==="Escape"&&h(!1)};if(n)return document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r)}},[n]);const B=r=>{o({target:{value:r}}),h(!1)},m=(r,l)=>{var i;r.stopPropagation(),U.info("Deleting character:",(i=t[l])==null?void 0:i.name),S(l)},k=async()=>{if(!(b||!t[c])){L(!0);try{const r=t[c].name,l=t.map(P=>P.name);let i=1,v=`${r}-${i}`;for(;l.includes(v);)i++,v=`${r}-${i}`;const M=await D(c,v);M.success||U.error("Failed to copy character:",M.error)}catch(r){U.error("Error copying character:",r)}finally{L(!1)}}},d=t[c],j=d?d.name:"Select Character...",p=d&&!b;return e.jsxs("div",{className:"character-dropdown-with-copy",children:[e.jsx("div",{className:"character-dropdown-container",children:e.jsxs("button",{type:"button",className:"character-dropdown-trigger",onClick:()=>h(!0),"aria-expanded":n,"aria-haspopup":"dialog",children:[e.jsx("span",{className:"character-dropdown-text",children:j}),e.jsx("svg",{className:"character-dropdown-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})}),n&&e.jsx("div",{className:"character-modal-backdrop",children:e.jsxs("div",{className:"character-modal-content",ref:A,children:[e.jsxs("div",{className:"character-modal-header",children:[e.jsx("h3",{children:"Select Character"}),e.jsx("button",{type:"button",className:"character-modal-close",onClick:()=>h(!1),"aria-label":"Close",children:"×"})]}),e.jsxs("div",{className:"character-modal-body",children:[e.jsx("div",{className:"character-modal-option placeholder",onClick:()=>B(""),children:e.jsx("span",{className:"character-modal-name",children:"Select Character..."})}),t.map((r,l)=>{var i;return e.jsxs("div",{className:`character-modal-option ${c===l?"selected":""}`,onClick:()=>B(l),children:[e.jsxs("div",{className:"character-modal-info",children:[e.jsx("span",{className:"character-modal-name",children:r.name}),e.jsxs("span",{className:"character-modal-bosses",children:[((i=r.bosses)==null?void 0:i.length)||0," bosses configured"]})]}),e.jsx("div",{className:"character-modal-actions",children:e.jsx("button",{type:"button",className:"character-modal-btn delete",onClick:v=>m(v,l),title:"Delete character",children:"🗑️"})})]},r.name+l)}),t.length===0&&e.jsxs("div",{className:"character-modal-empty",children:[e.jsx("p",{children:"No characters created yet."}),e.jsx("p",{children:"Use the character creator to add your first character!"})]})]})]})}),e.jsx("button",{type:"button",className:`character-copy-btn ${p?"enabled":"disabled"}`,onClick:k,disabled:!p,title:p?`Copy ${d.name}`:"Select a character to copy",children:b?e.jsx("div",{className:"character-copy-spinner",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"40",strokeDashoffset:"20",className:"copy-spinner-circle"})})}):e.jsx("svg",{className:"character-copy-icon",width:"16",height:"16",viewBox:"0 0 352.804 352.804",fill:"currentColor",children:e.jsx("path",{d:`M318.54,57.282h-47.652V15c0-8.284-6.716-15-15-15H34.264c-8.284,0-15,6.716-15,15v265.522c0,8.284,6.716,15,15,15h47.651
            v42.281c0,8.284,6.716,15,15,15H318.54c8.284,0,15-6.716,15-15V72.282C333.54,63.998,326.824,57.282,318.54,57.282z
             M49.264,265.522V30h191.623v27.282H96.916c-8.284,0-15,6.716-15,15v193.24H49.264z M303.54,322.804H111.916V87.282H303.54V322.804
            z`})})})]})}function je({newCharName:t,setNewCharName:c,onAddCharacter:o,characterBossSelections:S,showCrystalCapError:D,cloneError:n}){const h=S.length>=I.CHARACTER_CAP,b=L=>{L.preventDefault(),t.trim()&&!h&&o()};return e.jsx("div",{className:"character-creator",children:e.jsxs("form",{className:"character-creator-form",onSubmit:b,children:[e.jsxs("div",{className:"character-creator-input-group",children:[e.jsx("input",{type:"text",value:t,onChange:L=>c(L.target.value),placeholder:"New character name...",className:"character-creator-input",disabled:h}),e.jsx("button",{type:"submit",disabled:!t.trim()||h,className:"character-creator-button",children:"Add Character"})]}),h&&e.jsxs("div",{className:"character-creator-warning",children:["Maximum ",I.CHARACTER_CAP," characters allowed"]}),n&&e.jsx("div",{className:"character-creator-error",children:n}),D&&e.jsx("div",{className:"character-creator-error",children:"Crystal cap exceeded! Cannot add more bosses."})]})})}function ge({characterBossSelections:t}){const c=(t==null?void 0:t.reduce((D,n)=>{var h;return D+(((h=n.bosses)==null?void 0:h.length)||0)},0))||0,o=180,S=Math.min(c/o*100,100);return e.jsx("div",{className:"crystal-tracker",style:{"--progress-width":`${S}%`},children:e.jsxs("div",{className:"crystal-tracker-content",children:[e.jsxs("div",{className:"crystal-tracker-numbers",children:[e.jsx("span",{className:"crystal-current",children:c}),e.jsx("span",{className:"crystal-separator",children:"/"}),e.jsx("span",{className:"crystal-max",children:o})]}),e.jsx("div",{className:"crystal-tracker-label",children:"Crystals"}),e.jsx("div",{className:"crystal-progress-indicator",children:e.jsx("div",{className:"crystal-progress-fill",style:{height:`${S}%`}})})]})})}function ye({onClick:t,title:c="Quick Select Bosses"}){return e.jsxs("button",{className:"quick-select-btn",onClick:t,title:c,children:[e.jsxs("svg",{className:"quick-select-icon",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M9 12l2 2 4-4"})]}),"Quick Select"]})}function ke({characterBossSelections:t=[],selectedCharIdx:c=0,sortedBossData:o=[],toggleBoss:S=()=>{},updatePartySize:D=()=>{},onQuickSelectClick:n=()=>{},getBossDifficulties:h=()=>[],getAvailablePartySizes:b=()=>[1,2,3,4,5,6],formatPrice:L=A=>A.toLocaleString()}){const[A,B]=N.useState({}),[m,k]=N.useState(""),d=t[c],j=(d==null?void 0:d.bosses)||[],p=j.length,r=p>=I.CHARACTER_BOSS_CAP,l=a=>j.some(g=>g.name===a),i=a=>j.find(g=>g.name===a),v=async(a,g)=>{if(g){if(p>=I.CHARACTER_BOSS_CAP){k(`Character can only have ${I.CHARACTER_BOSS_CAP} bosses maximum`),setTimeout(()=>k(""),3e3);return}const u=o.find(y=>y.name===a);if(u&&u.difficulties.length>0){const q=h(u).sort((_,T)=>{const E=u.difficulties.find(R=>R.difficulty===_),$=u.difficulties.find(R=>R.difficulty===T);return(($==null?void 0:$.price)||0)-((E==null?void 0:E.price)||0)})[0];await S(c,a,q)}}else await S(c,a,null)},M=async(a,g)=>{await S(c,a,g)},P=async(a,g)=>{const u=i(a),y=u==null?void 0:u.difficulty;y&&await D(c,a,y,parseInt(g))},J=a=>{B(g=>({...g,[a]:!g[a]}))},Z=(a,g)=>{const u=o.find(q=>q.name===a);if(!u)return 0;const y=u.difficulties.find(q=>q.difficulty===g);return(y==null?void 0:y.price)||0},se=(a,g,u=1)=>{const y=Z(a,g),q=Math.ceil(y/u);return L(q)};return d?e.jsxs("div",{className:"boss-config-table-container",children:[e.jsxs("div",{className:"character-boss-count",children:[e.jsxs("span",{className:`boss-count ${r?"at-limit":""}`,children:[p,"/",I.CHARACTER_BOSS_CAP," bosses"]}),r&&e.jsx("span",{className:"limit-warning",children:"Character boss limit reached"})]}),m&&e.jsx("div",{className:"character-cap-error",children:m}),e.jsxs("div",{className:"boss-config-table-grid",children:[e.jsxs("div",{className:"boss-config-header",children:[e.jsx("div",{className:"header-boss",children:"Boss"}),e.jsx("div",{className:"header-difficulty",children:"Difficulty"}),e.jsx("div",{className:"header-mesos",children:"Mesos"}),e.jsx("div",{className:"header-config",children:e.jsx(ye,{onClick:n,selectedCharacter:d})})]}),o.map((a,g)=>{const u=l(a.name),y=i(a.name),q=(y==null?void 0:y.difficulty)||"",_=(y==null?void 0:y.partySize)||1,T=A[a.name],E=!u&&r,$=h(a),R=b(a.name,q);return e.jsxs("div",{className:`boss-config-row ${g%2===0?"even":"odd"} ${u?"selected":""} ${E?"disabled-due-to-limit":""}`,onClick:()=>!E&&v(a.name,!u),style:{cursor:E?"not-allowed":"pointer"},title:E?`Character boss limit reached (${I.CHARACTER_BOSS_CAP} max)`:"",children:[e.jsxs("div",{className:"boss-config-cell-boss",children:[e.jsxs("div",{className:"boss-config-info-section",children:[a.image&&e.jsx("img",{alt:a.name,className:"boss-config-image",src:a.image}),e.jsx("div",{className:"boss-config-details",children:e.jsx("span",{className:"boss-config-name",children:a.name})})]}),e.jsx("button",{className:"boss-config-expand-btn mobile-only",onClick:s=>{s.stopPropagation(),J(a.name)},"aria-label":T?"Collapse row":"Expand row",children:e.jsx("svg",{className:`expand-arrow ${T?"expanded":""}`,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsx("div",{className:`boss-config-cell-difficulty ${T?"expanded":""}`,children:u?e.jsx("select",{value:q,onChange:s=>M(a.name,s.target.value),onClick:s=>s.stopPropagation(),className:"difficulty-dropdown",disabled:!u,children:$.map(s=>e.jsx("option",{value:s,children:s},s))}):e.jsx("span",{className:"difficulty-placeholder",children:"-"})}),e.jsx("div",{className:`boss-config-cell-mesos ${T?"expanded":""}`,children:u&&q?e.jsx("span",{className:"mesos-amount",children:se(a.name,q,_)}):e.jsx("span",{className:"mesos-placeholder",children:"-"})}),e.jsx("div",{className:`boss-config-cell-config ${T?"expanded":""}`,onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"config-controls",children:[e.jsx(me,{checked:u,onChange:s=>!E&&v(a.name,s.target.checked),disabled:E}),u&&e.jsx("select",{value:_,onChange:s=>P(a.name,s.target.value),onClick:s=>s.stopPropagation(),className:"party-size-dropdown",title:`Party Size: ${_}`,children:R.map(s=>e.jsx("option",{value:s,children:s},s))})]})})]},a.name)})]})]}):e.jsx("div",{className:"boss-config-table-container",children:e.jsx("div",{className:"boss-config-empty",children:e.jsx("p",{children:"Please select a character to configure bosses."})})})}function ve({characterBossSelections:t=[],selectedCharIdx:c=0,newCharName:o="",handleCharacterChange:S=()=>{},addCharacter:D=()=>{},removeCharacter:n=()=>{},setNewCharName:h=()=>{},sortedBossData:b=[],toggleBoss:L=()=>{},updatePartySize:A=()=>{},onQuickSelectClick:B=()=>{},getBossDifficulties:m=()=>[],getAvailablePartySizes:k=()=>[1,2,3,4,5,6],formatPrice:d=i=>i.toLocaleString(),totalBossCount:j=0,cloneError:p="",showCrystalCapError:r=!1,onCopyCharacter:l=()=>{}}){const i=t[c];return e.jsxs("div",{className:"character-management-container",children:[e.jsxs("div",{className:"integrated-boss-config-container",children:[e.jsxs("div",{className:"character-controls-header",children:[e.jsxs("div",{className:"character-controls-section",children:[e.jsxs("div",{className:"character-selector-group",children:[e.jsx("div",{className:"character-dropdown-wrapper",children:e.jsx(fe,{characterBossSelections:t,selectedCharIdx:c,onCharacterChange:S,onRemoveCharacter:n,onCopyCharacter:l})}),e.jsx("div",{className:"character-creator-wrapper",children:e.jsx(je,{newCharName:o,setNewCharName:h,onAddCharacter:D,characterBossSelections:t})})]}),e.jsx("div",{className:"crystal-tracker-wrapper",children:e.jsx(ge,{characterBossSelections:t})})]}),p&&e.jsx("div",{className:"character-management-error",children:p})]}),t.length===0?e.jsxs("div",{className:"no-characters-message",children:[e.jsx("div",{className:"no-characters-icon",children:e.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M16 7C16 9.20914 14.2091 11 12 11C9.79086 11 8 9.20914 8 7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7Z",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M12 14C8.13401 14 5 17.134 5 21H19C19 17.134 15.866 14 12 14Z",stroke:"currentColor",strokeWidth:"2"})]})}),e.jsx("h3",{children:"No Characters Yet"}),e.jsx("p",{children:"Create your first character to start configuring bosses and tracking your weekly progress."})]}):c===""||!i?e.jsxs("div",{className:"select-character-message",children:[e.jsx("div",{className:"select-character-icon",children:e.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("h3",{children:"Select a Character"}),e.jsx("p",{children:"Choose a character from the dropdown above to configure their boss selection."})]}):e.jsx(ke,{characterBossSelections:t,selectedCharIdx:c,sortedBossData:b,toggleBoss:L,updatePartySize:A,onQuickSelectClick:B,getBossDifficulties:m,getAvailablePartySizes:k,formatPrice:d})]}),r&&e.jsx("div",{className:"crystal-cap-error-overlay",children:e.jsx("div",{className:"crystal-cap-error-message",children:"Crystal limit reached! Maximum 180 crystals allowed."})})]})}N.lazy(()=>ce(()=>import("./DataBackup-EsfoEf1a.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])));function ze(){ne();const{userCode:t,handleDeleteAccount:c}=le(),{characterBossSelections:o,setCharacterBossSelections:S,newCharName:D,setNewCharName:n,selectedCharIdx:h,cloneError:b,setCloneError:L,showUndo:A,undoData:B,fileInputRef:m,importError:k,setImportError:d,importSuccess:j,setImportSuccess:p,sortedBossData:r,getAvailablePartySizes:l,getBossDifficulties:i,handleCharacterChange:v,addCharacter:M,removeCharacter:P,handleUndo:J,toggleBoss:Z,updateCharacterName:se,updatePartySize:a,batchSetBosses:g,showCrystalCapError:u,isLoading:y,copyCharacter:q}=oe(),[_,T]=N.useState(!1),[E,$]=N.useState(!1),[R,s]=N.useState(""),[x,Q]=N.useState(!1),[F,Y]=N.useState(!1),w=ue(),O=async()=>{try{const{exportUserData:f}=await ce(async()=>{const{exportUserData:H}=await import("./utilityService-DPFdy0eV.js");return{exportUserData:H}},__vite__mapDeps([4,5,3,6,1,2,7])),C=await f(t);if(C.success){const H=JSON.stringify(C.data,null,2),ae=new Blob([H],{type:"application/json"}),V=URL.createObjectURL(ae),X=document.createElement("a");X.href=V,X.download=`maplestory-boss-calc-backup-${new Date().toISOString().split("T")[0]}.json`,X.click(),URL.revokeObjectURL(V),p(!0),setTimeout(()=>p(!1),3e3)}else throw new Error(C.error)}catch(f){U.error("Export error:",f),d("Failed to export data. Please try again."),setTimeout(()=>d(""),5e3)}},z=async f=>{const C=f.target.files[0];if(!C)return;const H=new FileReader;H.onload=async ae=>{try{const V=JSON.parse(ae.target.result),{importUserData:X}=await ce(async()=>{const{importUserData:ie}=await import("./utilityService-DPFdy0eV.js");return{importUserData:ie}},__vite__mapDeps([4,5,3,6,1,2,7])),re=await X(t,V);if(!re.success)throw new Error(re.error);p(!0),setTimeout(()=>{p(!1),window.location.reload()},2e3)}catch(V){U.error("Import error:",V),d(V.message||"Invalid data file. Please check the format and try again."),setTimeout(()=>d(""),5e3)}},H.readAsText(C)},W=async()=>{Q(!0),s("");try{const f=await c();f.success?$(!1):s(f.error)}catch(f){s("Failed to delete account. Try again."),U.error("Delete error:",f)}finally{Q(!1)}},K=()=>r||[],G=f=>{if(f>=1e9){const C=f/1e9;return C>=10?`${Math.round(C)}B`:`${C.toFixed(1)}B`}else if(f>=1e6){const C=f/1e6;return C>=10?`${Math.round(C)}M`:`${C.toFixed(1)}M`}else if(f>=1e3){const C=f/1e3;return C>=10?`${Math.round(C)}K`:`${C.toFixed(1)}K`}else return f.toString()},te=()=>{Y(!1),w.setQuickSelectBosses({}),w.setQuickSelectError("")};return e.jsxs("div",{className:"page-container",children:[e.jsx(de,{currentPage:"calculator",onExport:O,onImport:z,fileInputRef:m}),e.jsxs("div",{className:"page-header-container fade-in",children:[e.jsx("h1",{className:"page-title-main",children:"Character and Boss Configuration"}),h!==""&&o[h]&&e.jsx("div",{className:"boss-config-description",children:e.jsxs("p",{children:["Configure bosses, difficulties, and party sizes for ",e.jsx("strong",{children:o[h].name})]})})]}),k&&e.jsx("div",{className:"error-message-container",children:k}),j&&e.jsx("div",{className:"success-message-container",children:"Data backup operation successful!"}),e.jsx(he,{children:y?e.jsx(xe,{}):e.jsx(ve,{characterBossSelections:o,selectedCharIdx:h,newCharName:D,handleCharacterChange:v,addCharacter:M,removeCharacter:P,setNewCharName:n,sortedBossData:r,toggleBoss:Z,updatePartySize:a,onQuickSelectClick:()=>Y(!0),getBossDifficulties:i,getAvailablePartySizes:l,formatPrice:G,totalBossCount:o.reduce((f,C)=>{var H;return f+(((H=C.bosses)==null?void 0:H.length)||0)},0),cloneError:b,showCrystalCapError:u,onCopyCharacter:q})}),A&&B&&e.jsxs("div",{className:"undo-snackbar",children:["Character deleted.",e.jsx("button",{onClick:J,className:"undo-btn",children:"Undo"})]}),_&&e.jsx("div",{className:"modal-backdrop",onClick:()=>T(!1),children:e.jsxs("div",{className:"modal-fade modal-content",onClick:f=>f.stopPropagation(),children:[e.jsx("button",{onClick:()=>T(!1),className:"modal-close-btn",title:"Close",children:"×"}),e.jsx("h2",{className:"modal-title",children:"Help & FAQ"}),e.jsxs("div",{className:"modal-section-content",style:{marginBottom:24},children:[e.jsx("h3",{className:"modal-section-title",children:"Getting Started"}),e.jsx("p",{children:"1. Create an account or log in with your existing code"}),e.jsx("p",{children:"2. Add characters using the input field at the top"}),e.jsx("p",{children:"3. Select a character and choose their bosses & difficulties"}),e.jsx("p",{children:"4. Head to Weekly Tracker to mark completions and track pitched items!"})]}),e.jsxs("div",{className:"modal-section-content",style:{marginBottom:24},children:[e.jsx("h3",{className:"modal-section-title",children:"Boss Selection"}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Quick Select:"})," Use Quick Select for easy boss setup"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Party sizes:"})," Adjust party size for each boss to calculate split mesos"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Clone characters:"})," Copy a character's entire boss setup instantly"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Difficulty matters:"})," Higher difficulties = more mesos and pitched items"]})]}),e.jsxs("div",{className:"modal-section-content",style:{marginBottom:24},children:[e.jsx("h3",{className:"modal-section-title",children:"Data Management"}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Auto-save:"})," All changes are automatically saved to the cloud"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Export/Import:"})," Backup your data or transfer between devices"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Smart cleanup:"})," Changing boss selections automatically cleans up old tracking data"]})]}),e.jsxs("div",{className:"modal-section-content",children:[e.jsx("h3",{className:"modal-section-title",children:"Quick Tips"}),e.jsx("p",{children:"• Click anywhere on a boss row to toggle selection"}),e.jsx("p",{children:"• Use Quick Select to efficiently set up your boss lists"}),e.jsx("p",{children:"• Your account code is your login - keep it safe!"}),e.jsx("p",{children:"• Check out the Boss Table page to see which bosses give the most mesos"})]})]})}),E&&e.jsx("div",{className:"modal-backdrop modal-backdrop-critical",onClick:()=>$(!1),children:e.jsxs("div",{className:"modal-fade modal-content-critical",onClick:f=>f.stopPropagation(),children:[e.jsx("div",{className:"critical-modal-icon",children:e.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z",stroke:"#fff",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("h2",{className:"critical-modal-title",children:"Delete Account"}),e.jsx("div",{className:"critical-modal-warning",children:e.jsxs("p",{children:[e.jsx("strong",{children:"This will permanently delete your account and all associated data."}),e.jsx("br",{}),"This action cannot be undone."]})}),e.jsxs("div",{className:"modal-button-container",children:[e.jsx("button",{onClick:()=>$(!1),disabled:x,className:"modal-btn-cancel",children:"Cancel"}),e.jsxs("button",{onClick:W,disabled:x,className:"modal-btn-critical",children:[x&&e.jsx("div",{className:"loading-spinner"}),x?"Deleting...":"Delete Forever"]})]}),R&&e.jsx("div",{className:"modal-error-message",children:R})]})}),e.jsx(pe,{show:F,onClose:te,quickSelectBosses:w.quickSelectBosses,quickSelectError:w.quickSelectError,getSortedBossesByPrice:K,getBossDifficulties:i,formatPrice:G,handleQuickSelectBoss:w.handleQuickSelectBoss,updateQuickSelectPartySize:w.updateQuickSelectPartySize,applyQuickSelection:()=>{w.applyQuickSelection(h,o,g),Y(!1)},resetQuickSelection:w.resetQuickSelection,reuseLastQuickSelect:w.reuseLastQuickSelect,lastQuickSelectBosses:w.lastQuickSelectBosses,selectedCharIdx:h,characterBossSelections:o}),e.jsx("input",{ref:m,type:"file",accept:".json",onChange:z,style:{display:"none"}}),e.jsx("style",{children:`
        @keyframes modalFadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        @keyframes modalSlideIn {
          from {
            opacity: 0;
            transform: scale(0.8) translateY(20px);
          }
          to {
            opacity: 1;
            transform: scale(1) translateY(0);
          }
        }

        .crystal-cap-error-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100vw;
          height: 100vh;
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 3000;
          pointer-events: none;
          padding: 1rem;
          box-sizing: border-box;
        }
        
        .crystal-cap-error-message {
          background: rgba(40, 32, 74, 0.97);
          color: #fff;
          font-size: 1.25rem;
          font-weight: 600;
          border-radius: 16px;
          box-shadow: 0 4px 32px rgba(128,90,213,0.18);
          padding: 1.5rem 2.5rem;
          border: 1.5px solid #a259f7;
          text-align: center;
          animation: modalFadeIn 0.3s cubic-bezier(.4,2,.6,1);
          letter-spacing: 0.5px;
          max-width: 90vw;
          width: auto;
          min-width: 300px;
        }

        /* Responsive design for crystal cap error */
        @media (min-width: 2560px) {
          .crystal-cap-error-message {
            font-size: 1.5rem;
            padding: 2rem 3rem;
            border-radius: 20px;
            min-width: 400px;
          }
        }

        @media (min-width: 1920px) and (max-width: 2559px) {
          .crystal-cap-error-message {
            font-size: 1.35rem;
            padding: 1.75rem 2.75rem;
            border-radius: 18px;
            min-width: 350px;
          }
        }

        @media (max-width: 1365px) and (min-width: 769px) {
          .crystal-cap-error-message {
            font-size: 1.1rem;
            padding: 1.25rem 2rem;
            min-width: 280px;
          }
        }

        @media (max-width: 768px) {
          .crystal-cap-error-overlay {
            padding: 0.5rem;
          }
          
          .crystal-cap-error-message {
            font-size: 1rem;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            min-width: 260px;
            max-width: 95vw;
            line-height: 1.4;
          }
        }

        @media (max-width: 480px) {
          .crystal-cap-error-overlay {
            padding: 0.25rem;
          }
          
          .crystal-cap-error-message {
            font-size: 0.9rem;
            padding: 0.75rem 1.25rem;
            border-radius: 10px;
            min-width: 240px;
            max-width: 98vw;
            line-height: 1.3;
          }
        }
      `})]})}export{ze as default};
