import{j as e}from"./vendor-ui-aK89YfOw.js";import{r as v}from"./vendor-router-Cg8TMqY4.js";import{l as f,u as he,V as pe}from"./index-BosJUZA-.js";import"./vendor-react-eWEExxYH.js";import"./vendor-supabase-B7S7y5aO.js";const ve={0:{success:95,maintain:5,decrease:0,destroy:0},1:{success:90,maintain:10,decrease:0,destroy:0},2:{success:85,maintain:15,decrease:0,destroy:0},3:{success:85,maintain:15,decrease:0,destroy:0},4:{success:80,maintain:20,decrease:0,destroy:0},5:{success:75,maintain:25,decrease:0,destroy:0},6:{success:70,maintain:30,decrease:0,destroy:0},7:{success:65,maintain:35,decrease:0,destroy:0},8:{success:60,maintain:40,decrease:0,destroy:0},9:{success:55,maintain:45,decrease:0,destroy:0},10:{success:50,maintain:50,decrease:0,destroy:0},11:{success:45,maintain:55,decrease:0,destroy:0},12:{success:40,maintain:60,decrease:0,destroy:0},13:{success:35,maintain:65,decrease:0,destroy:0},14:{success:30,maintain:70,decrease:0,destroy:0},15:{success:30,maintain:67.9,decrease:0,destroy:2.1},16:{success:30,maintain:0,decrease:67.9,destroy:2.1},17:{success:30,maintain:0,decrease:67.9,destroy:2.1},18:{success:30,maintain:0,decrease:67.2,destroy:2.8},19:{success:30,maintain:0,decrease:67.2,destroy:2.8},20:{success:30,maintain:63,decrease:0,destroy:7},21:{success:30,maintain:0,decrease:63,destroy:7},22:{success:3,maintain:0,decrease:77.6,destroy:19.4},23:{success:2,maintain:0,decrease:68.6,destroy:29.4},24:{success:1,maintain:0,decrease:59.4,destroy:39.6}};function H(s,t,c,i={},m=1e4){try{if(f.info("Starting starforce simulation",{equipLevel:s,currentStar:t,targetStar:c,options:i,simulations:m}),!s||s<1||s>300)return{success:!1,error:"Invalid equipment level. Must be between 1-300."};if(t<0||t>25||c<0||c>25)return{success:!1,error:"Invalid star levels. Must be between 0-25."};if(t>=c)return{success:!1,error:"Target star must be higher than current star."};const{eventType:p="none",mvpLevel:l="none",hasPremium:r=!1,isZeroWeapon:S=!1,safeguard15to16:j=!1,safeguard16to17:T=!1,useStarCatch:w=!1}=i,o=[],x=performance.now();for(let M=0;M<m;M++){const R=ge(s,t,c,{eventType:p,mvpLevel:l,hasPremium:r,isZeroWeapon:S,safeguard15to16:j,safeguard16to17:T,useStarCatch:w});o.push(R)}const b=performance.now(),k=Ne(o);return f.info("Starforce simulation completed",{simulations:m,duration:`${(b-x).toFixed(2)}ms`,averageCost:k.averageCost,averageAttempts:k.averageAttempts}),{success:!0,...k,equipLevel:s,currentStar:t,targetStar:c,options:{eventType:p,mvpLevel:l,hasPremium:r,isZeroWeapon:S,safeguard15to16:j,safeguard16to17:T,useStarCatch:w},simulationCount:m,duration:b-x}}catch(p){return f.error("Error in starforce simulation",p),{success:!1,error:"Failed to simulate starforce enhancement. Please try again."}}}function ge(s,t,c,i){let m=t,p=0,l=0,r=!1,S=0,j=0,T=0,w=0;const o=Ce(s,i.isZeroWeapon);for(;m<c;){l++;const x=je(o,m,i,s);p+=x;const b=r||(i.eventType==="51015"||i.eventType==="ssf")&&(m===5||m===10||m===15),k=xe(m,i,b),M=fe(k);if(M==="success"?(m++,w++,S=0,r=!1):M==="decrease"?m>=12&&(m=Math.max(12,m-1),T++,S++,S>=2&&(r=!0,S=0)):M==="destroy"&&(m===15&&i.safeguard15to16||m===16&&i.safeguard16to17||(m=12,j++,S=0,r=!1)),l>1e4){f.warn("Simulation exceeded 10000 attempts, terminating");break}}return{totalCost:p,attempts:l,successes:w,decreases:T,booms:j,chanceTimeUsed:w>c-t}}function xe(s,t,c){const i=ve[s];if(c)return{success:100,maintain:0,decrease:0,destroy:0};let m=i.success;t.useStarCatch&&!c&&(m*=1.05);const p=i.maintain+i.decrease+i.destroy;m-i.success;const l=p>0?(100-m)/p:0;return{success:m,maintain:i.maintain*l,decrease:i.decrease*l,destroy:i.destroy*l}}function fe(s){const t=Math.random()*100;return t<s.success?"success":t<s.success+s.maintain?"maintain":t<s.success+s.maintain+s.decrease?"decrease":"destroy"}function je(s,t,c,i){const m=be(i,t);if(m!==null)return ee(m,c,t);const p=Math.round(Math.pow(s,3)),l=t+1;let r=0;t>=0&&t<=9?r=100*p*l/2510:t===10?r=100*p*Math.pow(l,2.7)/40010:t===11?r=100*p*Math.pow(l,2.7)/22010:t===12?r=100*p*Math.pow(l,2.7)/15010:t===13?r=100*p*Math.pow(l,2.7)/11010:t===14?r=100*p*Math.pow(l,2.7)/7510:t>=15&&t<=24&&(r=100*p*Math.pow(l,2.7)/20010),r=se(r);let S=ee(r,c,t);return(t===15&&c.safeguard15to16||t===16&&c.safeguard16to17)&&(S*=2),S}function ee(s,t,c){let i=s;if(c<=16){const p=ye(t.mvpLevel,t.hasPremium);i*=p}return(t.eventType==="30off"||t.eventType==="ssf")&&(i*=.7),se(i)}function Ne(s){const t=s.map(l=>l.totalCost).sort((l,r)=>l-r),c=s.map(l=>l.attempts).sort((l,r)=>l-r),i=s.reduce((l,r)=>l+r.successes,0),m=s.reduce((l,r)=>l+r.decreases,0),p=s.reduce((l,r)=>l+r.booms,0);return{averageCost:Math.round(t.reduce((l,r)=>l+r,0)/t.length),medianCost:t[Math.floor(t.length*.5)],percentile25Cost:t[Math.floor(t.length*.25)],percentile75Cost:t[Math.floor(t.length*.75)],percentile90Cost:t[Math.floor(t.length*.9)],percentile99Cost:t[Math.floor(t.length*.99)],minCost:t[0],maxCost:t[t.length-1],averageAttempts:Math.round(c.reduce((l,r)=>l+r,0)/c.length),medianAttempts:c[Math.floor(c.length*.5)],percentile90Attempts:c[Math.floor(c.length*.9)],minAttempts:c[0],maxAttempts:c[c.length-1],averageSuccesses:Math.round(i/s.length),averageDecreases:Math.round(m/s.length),averageBooms:p/s.length,chanceTimeUsageRate:Math.round(s.filter(l=>l.chanceTimeUsed).length/s.length*100),costDistribution:Se(t)}}function Se(s){const c=s[0],m=(s[s.length-1]-c)/20,p=[];for(let l=0;l<20;l++){const r=c+l*m,S=c+(l+1)*m,j=s.filter(T=>T>=r&&T<S).length;p.push({range:`${E(r)} - ${E(S)}`,count:j,percentage:Math.round(j/s.length*100)})}return p}function Ce(s,t=!1){return t&&s>150?150:Math.floor(s/10)*10}function ye(s,t=!1){let c=0;switch(s){case"silver":c+=.03;break;case"gold":c+=.05;break;case"diamond":c+=.1;break}return t&&(c+=.05),1-c}function be(s,t){return(s===108||s===109)&&t===7?321e3:(s===118||s===119)&&t===9?533400:(s===128||s===129)&&t===14?6471400:null}function se(s){return Math.round(s/100)*100}function ke(){return[{value:"none",name:"None",discount:"0%"},{value:"silver",name:"Silver",discount:"3%"},{value:"gold",name:"Gold",discount:"5%"},{value:"diamond",name:"Diamond",discount:"10%"}]}function E(s){return s>=1e9?`${(s/1e9).toFixed(2)}B`:s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(0)}K`:s.toLocaleString()}function We(){const{isLoggedIn:s}=he();v.useEffect(()=>{const a=document.body.style.overflowY,n=document.documentElement.style.overflowY;return document.body.style.overflowY="auto",document.documentElement.style.overflowY="auto",()=>{document.body.style.overflowY=a,document.documentElement.style.overflowY=n}},[]);const[t,c]=v.useState("calculator"),[i,m]=v.useState(200),[p,l]=v.useState(0),[r,S]=v.useState(17),[j,T]=v.useState("none"),[w,o]=v.useState("none"),[x,b]=v.useState(!1),[k,M]=v.useState(!1),[R,ae]=v.useState(!1),[q,te]=v.useState(!1),[d,D]=v.useState(null),[$,z]=v.useState(!1),[L,A]=v.useState({characters:[]}),[F,J]=v.useState(""),[K,G]=v.useState(new Set);v.useEffect(()=>{const a=localStorage.getItem("enhancementPlannerData");if(a)try{const n=JSON.parse(a);A(n),f.info("Loaded planner data from localStorage")}catch(n){f.error("Failed to load planner data:",n)}},[]),v.useEffect(()=>{L.characters.length>0&&(localStorage.setItem("enhancementPlannerData",JSON.stringify(L)),f.info("Saved planner data to localStorage"))},[L]);const Q=v.useCallback(()=>{if(!F.trim())return;const a={id:Date.now().toString(),name:F.trim(),items:[]};A(n=>({...n,characters:[...n.characters,a]})),J(""),G(n=>new Set([...n,a.id])),f.info("Added character:",a.name)},[F]),ne=v.useCallback(a=>{A(n=>({...n,characters:n.characters.filter(u=>u.id!==a)})),G(n=>{const u=new Set(n);return u.delete(a),u}),f.info("Removed character:",a)},[]),le=v.useCallback(a=>{G(n=>{const u=new Set(n);return u.has(a)?u.delete(a):u.add(a),u})},[]),ce=[{value:"hat",name:"Hat",icon:"⛑️"},{value:"face_accessory",name:"Face Accessory",icon:"🎭"},{value:"eye_accessory",name:"Eye Accessory",icon:"🥽"},{value:"earrings",name:"Earrings",icon:"💎"},{value:"pendant",name:"Pendant",icon:"🏺"},{value:"ring",name:"Ring",icon:"💍"},{value:"overall",name:"Overall",icon:"🛡️"},{value:"top",name:"Top",icon:"🎽"},{value:"bottom",name:"Bottom",icon:"👖"},{value:"shoes",name:"Shoes",icon:"🥾"},{value:"gloves",name:"Gloves",icon:"🧤"},{value:"cape",name:"Cape",icon:"🧥"},{value:"belt",name:"Belt",icon:"⚜️"},{value:"shoulder",name:"Shoulder",icon:"🏛️"},{value:"weapon",name:"Weapon",icon:"⚔️"},{value:"shield",name:"Shield",icon:"🛡️"}],[C,Y]=v.useState({eventType:"none",mvpLevel:"none",useStarCatch:!1}),re=v.useCallback(a=>{const n={id:Date.now().toString(),type:"weapon",name:"Weapon",equipLevel:200,currentStar:0,targetStar:17,isZeroWeapon:!1,useSafeguard:!1,calculationResult:null};A(u=>({...u,characters:u.characters.map(h=>h.id===a?{...h,items:[...h.items,n]}:h)})),f.info("Added item to character:",a)},[]),ie=v.useCallback((a,n)=>{A(u=>({...u,characters:u.characters.map(h=>h.id===a?{...h,items:h.items.filter(g=>g.id!==n)}:h)})),f.info("Removed item:",n,"from character:",a)},[]),oe=v.useCallback((a,n,u)=>{A(h=>({...h,characters:h.characters.map(N=>N.id===a?{...N,items:N.items.map(y=>y.id===n?{...y,...u,...u.calculationResult?{}:{calculationResult:null}}:y)}:N)}))},[]),X=v.useCallback(()=>{f.info("Starting bulk calculation for all items"),A(a=>{let n={...a};return a.characters.forEach(u=>{u.items.forEach(h=>{if(h.equipLevel&&h.currentStar!==null&&h.targetStar!==null&&h.currentStar<h.targetStar)try{const g=C.eventType==="51015"||C.eventType==="ssf",N=h.currentStar<=15&&h.targetStar>=16,y=h.currentStar<=16&&h.targetStar>=17,P=h.useSafeguard&&N&&!g,O=h.useSafeguard&&y,B=H(h.equipLevel,h.currentStar,h.targetStar,{eventType:C.eventType,mvpLevel:C.mvpLevel,hasPremium:!1,isZeroWeapon:h.isZeroWeapon,safeguard15to16:P,safeguard16to17:O,useStarCatch:C.useStarCatch});n={...n,characters:n.characters.map(Z=>Z.id===u.id?{...Z,items:Z.items.map(W=>W.id===h.id?{...W,calculationResult:B}:W)}:Z)}}catch(g){f.error("Calculation failed for item:",h.name,g),n={...n,characters:n.characters.map(N=>N.id===u.id?{...N,items:N.items.map(y=>y.id===h.id?{...y,calculationResult:{success:!1,error:"Calculation failed. Please try again."}}:y)}:N)}}})}),n})},[C]);v.useEffect(()=>{if(L.characters.length>0){const a=setTimeout(()=>{X()},500);return()=>clearTimeout(a)}},[C]);const de=v.useCallback((a,n)=>{f.info("calculateItemCost called with:",{characterId:a,itemId:n}),A(u=>{const h=u.characters.find(N=>N.id===a);if(!h)return f.error("Character not found:",a),u;const g=h.items.find(N=>N.id===n);if(!g)return f.error("Item not found:",n),u;if(f.info("Found item for calculation:",g),!g.equipLevel||g.currentStar===null||g.targetStar===null||g.currentStar>=g.targetStar)return f.error("Invalid item parameters:",{equipLevel:g.equipLevel,currentStar:g.currentStar,targetStar:g.targetStar}),{...u,characters:u.characters.map(N=>N.id===a?{...N,items:N.items.map(y=>y.id===n?{...y,calculationResult:{success:!1,error:"Please enter valid equipment level and star range."}}:y)}:N)};try{const N=C.eventType==="51015"||C.eventType==="ssf",y=g.currentStar<=15&&g.targetStar>=16,P=g.currentStar<=16&&g.targetStar>=17,O=g.useSafeguard&&y&&!N,B=g.useSafeguard&&P;f.info("Calculating cost for item:",g.name,"with params:",{equipLevel:g.equipLevel,currentStar:g.currentStar,targetStar:g.targetStar,eventType:C.eventType,mvpLevel:C.mvpLevel,isZeroWeapon:g.isZeroWeapon,safeguard15to16:O,safeguard16to17:B,useStarCatch:C.useStarCatch});const Z=H(g.equipLevel,g.currentStar,g.targetStar,{eventType:C.eventType,mvpLevel:C.mvpLevel,hasPremium:!1,isZeroWeapon:g.isZeroWeapon,safeguard15to16:O,safeguard16to17:B,useStarCatch:C.useStarCatch});return f.info("Calculation result:",Z),f.info("Calculation completed for item:",g.name),{...u,characters:u.characters.map(W=>W.id===a?{...W,items:W.items.map(I=>I.id===n?{...I,calculationResult:Z}:I)}:W)}}catch(N){return f.error("Calculation failed for item:",g.name,N),{...u,characters:u.characters.map(y=>y.id===a?{...y,items:y.items.map(P=>P.id===n?{...P,calculationResult:{success:!1,error:"Calculation failed. Please try again."}}:P)}:y)}}})},[C]),U=v.useCallback(a=>a.items.reduce((n,u)=>{var h;return(h=u.calculationResult)!=null&&h.success?n+u.calculationResult.averageCost:n},0),[]),ue=v.useCallback(()=>L.characters.reduce((a,n)=>a+U(n),0),[L.characters,U]),me=v.useCallback(()=>{if(!i||p===null||r===null||p>=r){D({success:!1,error:"Please enter valid equipment level and star range."});return}z(!0),setTimeout(()=>{try{f.info("Starting calculation with params:",{equipLevel:i,currentStar:p,targetStar:r,eventType:j,mvpLevel:w,isZeroWeapon:x,safeguard15to16:k,safeguard16to17:R,useStarCatch:q});const a=H(i,p,r,{eventType:j,mvpLevel:w,hasPremium:!1,isZeroWeapon:x,safeguard15to16:k,safeguard16to17:R,useStarCatch:q});f.info("Calculation completed:",a),D(a)}catch(a){f.error("Calculation failed:",a),D({success:!1,error:"Calculation failed. Please try again."})}finally{z(!1)}},100)},[i,p,r,j,w,x,k,R,q]);if(v.useEffect(()=>{d&&D(null)},[i,p,r,j,w,x,k,R,q]),!s)return null;const V=ke(),_=j==="51015"||j==="ssf";return v.useEffect(()=>{_&&k&&(M(!1),f.info("Safeguard 15→16 disabled due to 5/10/15 event (guaranteed success)"))},[j,_,k]),v.useEffect(()=>{x&&i>150&&(m(150),f.info("Equipment level capped at 150 due to Zero weapon setting"))},[x,i]),e.jsx("div",{className:"enhancement-calculator-page-wrapper",children:e.jsx("div",{className:"enhancement-calculator-page",children:e.jsx(pe,{children:e.jsxs("div",{className:"enhancement-calculator-main fade-in",children:[e.jsxs("div",{className:"enhancement-header",children:[e.jsx("h2",{className:"enhancement-title",children:"Enhancement Calculator"}),e.jsx("p",{className:"enhancement-subtitle",children:"Calculate meso costs for starforcing equipment"}),e.jsxs("div",{className:"mode-toggle",children:[e.jsx("button",{className:`mode-button ${t==="calculator"?"active":""}`,onClick:()=>c("calculator"),children:"Single Calculator"}),e.jsx("button",{className:`mode-button ${t==="planner"?"active":""}`,onClick:()=>c("planner"),children:"Multi-Character Planner"})]})]}),t==="calculator"?e.jsxs("div",{className:"enhancement-container",children:[e.jsxs("div",{className:"enhancement-inputs",children:[e.jsxs("div",{className:"enhancement-section",children:[e.jsx("h3",{className:"section-title",children:"Equipment Settings"}),e.jsxs("div",{className:"input-group",children:[e.jsxs("label",{htmlFor:"equip-level",children:["Equipment Level:",x&&e.jsx("span",{className:"level-cap-info",children:" (Max 150 for Zero weapons)"})]}),e.jsx("input",{id:"equip-level",type:"number",min:"1",max:x?"150":"300",value:i,onChange:a=>{const n=parseInt(a.target.value)||1;m(Math.min(n,x?150:300))},className:"level-input"})]}),e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{className:"toggle-label",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:a=>b(a.target.checked),className:"toggle-checkbox"}),e.jsx("span",{className:"toggle-slider"}),e.jsx("span",{className:"toggle-text",children:"Zero Weapon (Capped at Level 150)"})]})})]}),e.jsxs("div",{className:"enhancement-section",children:[e.jsx("h3",{className:"section-title",children:"Star Range"}),e.jsxs("div",{className:"star-range-inputs",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"current-star",children:"Current Stars:"}),e.jsx("select",{id:"current-star",value:p,onChange:a=>l(parseInt(a.target.value)),className:"star-select",children:Array.from({length:25},(a,n)=>e.jsxs("option",{value:n,children:[n,"★"]},n))})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"target-star",children:"Target Stars:"}),e.jsx("select",{id:"target-star",value:r,onChange:a=>S(parseInt(a.target.value)),className:"star-select",children:Array.from({length:25},(a,n)=>n+1).map(a=>e.jsxs("option",{value:a,disabled:a<=p,children:[a,"★"]},a))})]})]})]}),e.jsxs("div",{className:"enhancement-section",children:[e.jsx("h3",{className:"section-title",children:"Discounts & Events"}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"mvp-level",children:"MVP Level:"}),e.jsx("select",{id:"mvp-level",value:w,onChange:a=>o(a.target.value),className:"mvp-select",children:V.map(a=>e.jsxs("option",{value:a.value,children:[a.name," (",a.discount,")"]},a.value))})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"event-type",children:"Active Event:"}),e.jsxs("select",{id:"event-type",value:j,onChange:a=>T(a.target.value),className:"event-select",children:[e.jsx("option",{value:"none",children:"No Event"}),e.jsx("option",{value:"30off",children:"30% Cost Reduction"}),e.jsx("option",{value:"51015",children:"5/10/15 Guaranteed Success"}),e.jsx("option",{value:"ssf",children:"Shiny Star Force (30% + 5/10/15)"})]})]}),j!=="none"&&e.jsxs("div",{className:"event-info",children:[j==="30off"&&e.jsxs("p",{className:"info-text",children:[e.jsx("span",{className:"event-badge",children:"30% Off"}),"All starforce costs reduced by 30%"]}),j==="51015"&&e.jsxs("p",{className:"info-text",children:[e.jsx("span",{className:"event-badge guaranteed",children:"5/10/15"}),"Guaranteed success for 5★→6★, 10★→11★, and 15★→16★ upgrades"]}),j==="ssf"&&e.jsxs("p",{className:"info-text",children:[e.jsx("span",{className:"event-badge",children:"SSF"}),"30% cost reduction + guaranteed success for 5★→6★, 10★→11★, and 15★→16★"]})]})]}),e.jsxs("div",{className:"enhancement-section",children:[e.jsx("h3",{className:"section-title",children:"Star Catch Minigame"}),e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{className:"toggle-label",children:[e.jsx("input",{type:"checkbox",checked:q,onChange:a=>te(a.target.checked),className:"toggle-checkbox"}),e.jsx("span",{className:"toggle-slider"}),e.jsx("span",{className:"toggle-text",children:"Use Star Catch (+5% Success Rate)"})]})}),q&&e.jsx("div",{className:"starcatch-info",children:e.jsx("p",{className:"info-text",children:"Star Catch minigame increases success rate by 5% multiplicatively when successful. Does not appear during guaranteed upgrades (5/10/15 events, Chance Time)."})})]}),e.jsxs("div",{className:"enhancement-section",children:[e.jsx("h3",{className:"section-title",children:"Safeguard Options"}),e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{className:`toggle-label ${_?"disabled":""}`,children:[e.jsx("input",{type:"checkbox",checked:k,onChange:a=>M(a.target.checked),className:"toggle-checkbox",disabled:_}),e.jsx("span",{className:"toggle-slider"}),e.jsxs("span",{className:"toggle-text",children:["Safeguard 15★ → 16★",_&&e.jsx("span",{className:"disabled-reason",children:" (Guaranteed by event)"})]})]})}),e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{className:"toggle-label",children:[e.jsx("input",{type:"checkbox",checked:R,onChange:a=>ae(a.target.checked),className:"toggle-checkbox"}),e.jsx("span",{className:"toggle-slider"}),e.jsx("span",{className:"toggle-text",children:"Safeguard 16★ → 17★"})]})}),(k||R)&&e.jsx("div",{className:"safeguard-info",children:e.jsx("p",{className:"info-text",children:"Safeguard doubles the cost but prevents equipment destruction."})})]}),e.jsx("div",{className:"enhancement-section",children:e.jsxs("div",{className:"calculate-section",children:[e.jsx("button",{onClick:me,disabled:$||!i||p>=r,className:`calculate-button ${$?"calculating":""}`,children:$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"button-spinner"}),e.jsx("span",{children:"Running Simulation..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"🎲"}),e.jsx("span",{children:"Calculate Starforce Cost"})]})}),e.jsx("div",{className:"calculate-info",children:e.jsx("p",{className:"info-text",children:"Runs 10,000 simulations to provide realistic cost estimates and risk analysis."})})]})})]}),e.jsx("div",{className:"enhancement-results",children:$?e.jsxs("div",{className:"calculating-indicator",children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:"Calculating..."})]}):d?d.success?e.jsxs("div",{className:"results-content",children:[e.jsxs("div",{className:"simulation-header",children:[e.jsx("h3",{className:"results-title",children:"Simulation Results"}),e.jsxs("div",{className:"simulation-info",children:[e.jsxs("span",{className:"simulation-count",children:[d.simulationCount.toLocaleString()," simulations"]}),e.jsxs("span",{className:"simulation-time",children:["(",d.duration.toFixed(0),"ms)"]})]})]}),e.jsxs("div",{className:"statistics-grid",children:[e.jsxs("div",{className:"stat-card primary",children:[e.jsx("h4",{children:"Average Cost"}),e.jsxs("div",{className:"stat-value-container",children:[e.jsx("div",{className:"stat-value",children:E(d.averageCost)}),e.jsxs("div",{className:"stat-tooltip",children:[d.averageCost.toLocaleString()," mesos"]})]}),e.jsx("div",{className:"stat-unit",children:"mesos"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("h4",{children:"Median Cost"}),e.jsxs("div",{className:"stat-value-container",children:[e.jsx("div",{className:"stat-value",children:E(d.medianCost)}),e.jsxs("div",{className:"stat-tooltip",children:[d.medianCost.toLocaleString()," mesos"]})]}),e.jsx("div",{className:"stat-unit",children:"mesos"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("h4",{children:"Average Booms"}),e.jsx("div",{className:"stat-value",children:d.averageBooms.toFixed(2)}),e.jsx("div",{className:"stat-unit",children:"booms"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("h4",{children:"90th Percentile"}),e.jsxs("div",{className:"stat-value-container",children:[e.jsx("div",{className:"stat-value",children:E(d.percentile90Cost)}),e.jsxs("div",{className:"stat-tooltip",children:[d.percentile90Cost.toLocaleString()," mesos"]})]}),e.jsx("div",{className:"stat-unit",children:"mesos"})]})]}),e.jsxs("div",{className:"risk-analysis",children:[e.jsx("h4",{children:"Cost Range Analysis"}),e.jsxs("div",{className:"range-stats",children:[e.jsxs("div",{className:"range-item",children:[e.jsx("span",{className:"range-label",children:"Best Case:"}),e.jsx("span",{className:"range-value",children:E(d.minCost)})]}),e.jsxs("div",{className:"range-item",children:[e.jsx("span",{className:"range-label",children:"25th Percentile:"}),e.jsx("span",{className:"range-value",children:E(d.percentile25Cost)})]}),e.jsxs("div",{className:"range-item",children:[e.jsx("span",{className:"range-label",children:"75th Percentile:"}),e.jsx("span",{className:"range-value",children:E(d.percentile75Cost)})]}),e.jsxs("div",{className:"range-item",children:[e.jsx("span",{className:"range-label",children:"99th Percentile:"}),e.jsx("span",{className:"range-value",children:E(d.percentile99Cost)})]}),e.jsxs("div",{className:"range-item worst-case",children:[e.jsx("span",{className:"range-label",children:"Worst Case:"}),e.jsx("span",{className:"range-value",children:E(d.maxCost)})]})]})]}),e.jsxs("div",{className:"outcome-analysis",children:[e.jsx("h4",{children:"Enhancement Outcomes"}),e.jsxs("div",{className:"outcome-stats",children:[e.jsxs("div",{className:"outcome-item success",children:[e.jsx("span",{className:"outcome-label",children:"Avg Successes:"}),e.jsx("span",{className:"outcome-value",children:d.averageSuccesses})]}),e.jsxs("div",{className:"outcome-item decrease",children:[e.jsx("span",{className:"outcome-label",children:"Avg Decreases:"}),e.jsx("span",{className:"outcome-value",children:d.averageDecreases})]}),e.jsxs("div",{className:"outcome-item boom",children:[e.jsx("span",{className:"outcome-label",children:"Avg Booms:"}),e.jsx("span",{className:"outcome-value",children:d.averageBooms})]}),e.jsxs("div",{className:"outcome-item chance-time",children:[e.jsx("span",{className:"outcome-label",children:"Chance Time Usage:"}),e.jsxs("span",{className:"outcome-value",children:[d.chanceTimeUsageRate,"%"]})]})]})]}),e.jsxs("div",{className:"simulation-summary",children:[e.jsx("h4",{children:"Simulation Parameters"}),e.jsxs("div",{className:"summary-grid",children:[e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Equipment Level:"}),e.jsx("span",{className:"summary-value",children:d.equipLevel})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Star Range:"}),e.jsxs("span",{className:"summary-value",children:[d.currentStar,"★ → ",d.targetStar,"★"]})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Event:"}),e.jsxs("span",{className:"summary-value",children:[d.options.eventType==="none"&&"None",d.options.eventType==="30off"&&"30% Cost Reduction",d.options.eventType==="51015"&&"5/10/15 Guaranteed",d.options.eventType==="ssf"&&"Shiny Star Force"]})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"MVP Level:"}),e.jsx("span",{className:"summary-value",children:d.options.mvpLevel==="none"?"None":d.options.mvpLevel.toUpperCase()})]}),d.options.useStarCatch&&e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Star Catch:"}),e.jsx("span",{className:"summary-value",children:"Enabled (+5% Success)"})]}),(d.options.safeguard15to16||d.options.safeguard16to17)&&e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Safeguards:"}),e.jsxs("span",{className:"summary-value",children:[d.options.safeguard15to16&&"15★→16★",d.options.safeguard15to16&&d.options.safeguard16to17&&", ",d.options.safeguard16to17&&"16★→17★"]})]}),d.options.isZeroWeapon&&e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Zero Weapon:"}),e.jsx("span",{className:"summary-value",children:"Yes (Capped at 150)"})]})]})]})]}):e.jsxs("div",{className:"error-message",children:[e.jsx("span",{className:"error-icon",children:"⚠️"}),e.jsx("span",{children:d.error})]}):e.jsx("div",{className:"no-results",children:e.jsx("span",{children:'Click the "Calculate Starforce Cost" button to run simulation'})})})]}):e.jsxs("div",{className:"planner-container",children:[e.jsxs("div",{className:"global-settings-panel",children:[e.jsx("h3",{className:"section-title",children:"Global Settings"}),e.jsxs("div",{className:"global-settings-grid",children:[e.jsxs("div",{className:"setting-group",children:[e.jsx("label",{children:"Event Type:"}),e.jsxs("select",{value:C.eventType,onChange:a=>Y(n=>({...n,eventType:a.target.value})),className:"setting-select",children:[e.jsx("option",{value:"none",children:"No Event"}),e.jsx("option",{value:"30off",children:"30% Cost Reduction"}),e.jsx("option",{value:"51015",children:"5/10/15 Guaranteed Success"}),e.jsx("option",{value:"ssf",children:"Shiny Star Force (30% + 5/10/15)"})]})]}),e.jsxs("div",{className:"setting-group",children:[e.jsx("label",{children:"MVP Level:"}),e.jsx("select",{value:C.mvpLevel,onChange:a=>Y(n=>({...n,mvpLevel:a.target.value})),className:"setting-select",children:V.map(a=>e.jsxs("option",{value:a.value,children:[a.name," (",a.discount,")"]},a.value))})]}),e.jsx("div",{className:"setting-group",children:e.jsxs("button",{type:"button",className:`toggle-button ${C.useStarCatch?"active":""}`,onClick:()=>Y(a=>({...a,useStarCatch:!a.useStarCatch})),children:[e.jsx("span",{className:"toggle-icon",children:"⭐"}),e.jsx("span",{className:"toggle-text",children:"Star Catch (+5%)"})]})}),e.jsx("div",{className:"setting-group",children:e.jsxs("button",{onClick:X,className:"calculate-all-button",disabled:L.characters.length===0,children:[e.jsx("span",{children:"🎲"}),e.jsx("span",{children:"Re-run All Simulations"})]})})]})]}),e.jsxs("div",{className:"planner-header",children:[e.jsxs("div",{className:"add-character-section",children:[e.jsx("h3",{className:"section-title",children:"Add Character"}),e.jsxs("div",{className:"add-character-form",children:[e.jsx("input",{type:"text",value:F,onChange:a=>J(a.target.value),placeholder:"Enter character name...",className:"character-name-input",onKeyPress:a=>a.key==="Enter"&&Q()}),e.jsx("button",{onClick:Q,disabled:!F.trim(),className:"add-character-button",children:"Add Character"})]})]}),e.jsxs("div",{className:"overall-total",children:[e.jsx("h3",{className:"section-title",children:"Total Costs"}),e.jsx("div",{className:"total-cost-display",children:L.characters.length>0?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"total-amount",children:E(ue())}),e.jsx("span",{className:"total-unit",children:"mesos"})]}):e.jsx("span",{className:"total-amount",children:"0 mesos"})})]})]}),e.jsx("div",{className:"characters-list",children:L.characters.length===0?e.jsx("div",{className:"no-characters",children:e.jsx("span",{children:"No characters added yet. Add a character to start planning!"})}):L.characters.map(a=>e.jsxs("div",{className:"character-card",children:[e.jsxs("div",{className:"character-header",children:[e.jsxs("div",{className:"character-info",children:[e.jsx("div",{className:"character-name-row",children:e.jsx("h4",{className:"character-name",children:a.name})}),e.jsxs("div",{className:"character-stats",children:[e.jsxs("span",{className:"item-count",children:[a.items.length," items"]}),e.jsxs("span",{className:"calculated-items",children:[a.items.filter(n=>{var u;return(u=n.calculationResult)==null?void 0:u.success}).length," calculated"]})]})]}),e.jsx("span",{className:"character-total-badge",children:E(U(a))}),e.jsxs("div",{className:"character-actions",children:[e.jsx("button",{onClick:()=>le(a.id),className:"expand-button",children:K.has(a.id)?"▲":"▼"}),e.jsx("button",{onClick:()=>ne(a.id),className:"remove-character-button",children:"✕"})]})]}),K.has(a.id)&&e.jsx("div",{className:"character-content",children:e.jsxs("div",{className:"items-section",children:[e.jsxs("div",{className:"items-header",children:[e.jsx("h5",{children:"Items"}),e.jsx("button",{onClick:()=>re(a.id),className:"add-item-button",children:"+ Add Item"})]}),a.items.length===0?e.jsx("div",{className:"no-items",children:e.jsx("span",{children:"No items added yet."})}):e.jsx("div",{className:"items-list",children:a.items.map(n=>e.jsx(we,{item:n,characterId:a.id,onUpdateItem:oe,onRemoveItem:ie,onCalculate:de,mvpOptions:V,equipmentTypes:ce,globalSettings:C},n.id))})]})})]},a.id))})]})]})})})})}function we({item:s,characterId:t,onUpdateItem:c,onRemoveItem:i,onCalculate:m,mvpOptions:p,equipmentTypes:l,globalSettings:r}){var w;const S=(o,x)=>{if(o==="type"){const b=l.find(k=>k.value===x);c(t,s.id,{[o]:x,name:b?b.name:x})}else if(o==="equipLevel"){const b=s.isZeroWeapon?150:300,k=Math.min(x,b);c(t,s.id,{[o]:k})}else if(o==="isZeroWeapon"){const b={[o]:x};x&&s.equipLevel>150&&(b.equipLevel=150),c(t,s.id,b)}else c(t,s.id,{[o]:x})};v.useEffect(()=>{if(s.equipLevel&&s.currentStar!==null&&s.targetStar!==null&&s.currentStar<s.targetStar){const o=setTimeout(()=>{m(t,s.id)},300);return()=>clearTimeout(o)}},[s.equipLevel,s.currentStar,s.targetStar,s.isZeroWeapon,s.useSafeguard,t,s.id,m]);const j=r.eventType==="51015"||r.eventType==="ssf",T=()=>{`${s.currentStar}${s.targetStar}`;const o=s.currentStar<=15&&s.targetStar>=16,x=s.currentStar<=16&&s.targetStar>=17;if(!o&&!x)return"Safeguard (no dangerous upgrades in range)";if(j)return x?"Safeguard 16★→17★ (15★→16★ guaranteed by event)":"Safeguard (15★→16★ guaranteed by event)";{const b=[];return o&&b.push("15★→16★"),x&&b.push("16★→17★"),b.length>0?`Safeguard ${b.join(" & ")}`:"Safeguard"}};return e.jsxs("div",{className:"item-card",children:[e.jsxs("div",{className:"item-header",children:[e.jsx("div",{className:"item-info",children:e.jsxs("div",{className:"item-header-row-inline",children:[e.jsx("div",{className:"item-type-selector",children:e.jsx("select",{value:s.type||"weapon",onChange:o=>S("type",o.target.value),className:"item-type-select",children:l.map(o=>e.jsxs("option",{value:o.value,children:[o.icon," ",o.name]},o.value))})}),e.jsxs("div",{className:"summary-control-inline",children:[e.jsxs("label",{children:["Lv.",s.isZeroWeapon&&e.jsx("span",{className:"level-cap-hint",title:"Zero weapons capped at 150",children:"(≤150)"})]}),e.jsx("input",{type:"number",min:"1",max:s.isZeroWeapon?"150":"300",value:s.equipLevel,onChange:o=>S("equipLevel",parseInt(o.target.value)||1),className:"level-input-inline"})]}),e.jsxs("div",{className:"star-range-inline",children:[e.jsx("select",{value:s.currentStar,onChange:o=>S("currentStar",parseInt(o.target.value)),className:"star-select-inline",children:Array.from({length:25},(o,x)=>e.jsxs("option",{value:x,children:[x,"★"]},x))}),e.jsx("span",{className:"star-arrow",children:"→"}),e.jsx("select",{value:s.targetStar,onChange:o=>S("targetStar",parseInt(o.target.value)),className:"star-select-inline",children:Array.from({length:25},(o,x)=>x+1).map(o=>e.jsxs("option",{value:o,disabled:o<=s.currentStar,children:[o,"★"]},o))})]}),e.jsxs("div",{className:"toggle-controls-inline",children:[e.jsxs("button",{type:"button",className:`toggle-btn-inline ${s.isZeroWeapon?"active":""}`,onClick:()=>S("isZeroWeapon",!s.isZeroWeapon),title:"Zero Weapon",children:[e.jsx("span",{className:"toggle-icon",children:"⚔️"}),e.jsx("span",{className:"toggle-text",children:"Zero Weapon"})]}),e.jsxs("button",{type:"button",className:`toggle-btn-inline ${s.useSafeguard?"active":""}`,onClick:()=>S("useSafeguard",!s.useSafeguard),title:T(),children:[e.jsx("span",{className:"toggle-icon",children:"🛡️"}),e.jsx("span",{className:"toggle-text",children:"Safeguard"})]})]}),(w=s.calculationResult)!=null&&w.success?e.jsxs("div",{className:"item-cost-badge",children:["💰 ",E(s.calculationResult.averageCost)]}):e.jsx("div",{className:"item-cost-pending-badge",children:s.equipLevel&&s.currentStar<s.targetStar?"Calculating...":"Not calculated"})]})}),e.jsx("div",{className:"item-actions",children:e.jsx("button",{onClick:()=>i(t,s.id),className:"remove-item-button",children:"✕"})})]}),s.calculationResult&&!s.calculationResult.success&&e.jsxs("div",{className:"item-error-inline",children:["⚠️ ",s.calculationResult.error]})]})}export{We as default};
